var img$2 = "data:image/png;base64,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";

var img$1 = "data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='80' height='80' xml:space='preserve' id='numberbanksmall'%3e %3c!-- Generated by PaintCode - http://www.paintcodeapp.com --%3e %3cg id='numberbanksmall-group'%3e %3cellipse id='numberbanksmall-oval' stroke='none' fill='rgb(128%2c 128%2c 128)' cx='21.5' cy='72' rx='15.5' ry='16' /%3e %3cellipse id='numberbanksmall-oval2' stroke='none' fill='rgb(128%2c 128%2c 128)' cx='47.25' cy='61.5' rx='26.75' ry='26.5' /%3e %3cellipse id='numberbanksmall-oval3' stroke='none' fill='rgb(128%2c 128%2c 128)' cx='76.25' cy='61.5' rx='21.75' ry='21.5' /%3e %3c/g%3e %3cpath id='numberbanksmall-text' stroke='none' fill='rgb(0%2c 0%2c 0)' d='M 40.27%2c17.7 L 53.48%2c49.8 53.48%2c27.6 C 53.48%2c24.25 52.83%2c22.58 51.52%2c22.58 51.17%2c22.58 50.66%2c22.66 49.99%2c22.84 49.31%2c23.01 48.8%2c23.1 48.45%2c23.1 47.4%2c23.1 46.51%2c22.63 45.79%2c21.68 45.06%2c20.72 44.7%2c19.55 44.7%2c18.15 44.7%2c16.5 45.17%2c15.18 46.12%2c14.18 47.08%2c13.17 48.32%2c12.68 49.88%2c12.68 50.68%2c12.68 52.05%2c12.8 54%2c13.05 55.95%2c13.3 57.67%2c13.43 59.17%2c13.43 60.53%2c13.43 62.1%2c13.33 63.9%2c13.12 66.6%2c12.82 68.27%2c12.68 68.92%2c12.68 70.53%2c12.68 71.82%2c13.17 72.82%2c14.18 73.83%2c15.18 74.33%2c16.5 74.33%2c18.15 74.33%2c19.55 73.93%2c20.72 73.12%2c21.68 72.32%2c22.63 71.35%2c23.1 70.2%2c23.1 69.75%2c23.1 69.15%2c23.01 68.4%2c22.84 67.65%2c22.66 67.08%2c22.58 66.67%2c22.58 65.67%2c22.58 65.03%2c23.2 64.72%2c24.45 64.62%2c24.95 64.58%2c26 64.57%2c27.6 L 64.57%2c58.12 C 64.58%2c61.43 63.23%2c63.07 60.52%2c63.07 60.02%2c63.07 59.26%2c63.04 58.24%2c62.96 57.21%2c62.89 56.45%2c62.85 55.95%2c62.85 55.9%2c62.85 54.68%2c62.9 52.27%2c63 52.27%2c63 51.73%2c63 50.62%2c63 49.17%2c63 48.1%2c62.65 47.4%2c61.95 47%2c61.55 46.43%2c60.48 45.67%2c58.72 L 31.2%2c25.72 31.2%2c48.38 C 31.2%2c51.78 31.85%2c53.47 33.15%2c53.47 33.5%2c53.47 34.04%2c53.39 34.76%2c53.21 35.49%2c53.04 36.02%2c52.95 36.38%2c52.95 37.43%2c52.95 38.31%2c53.42 39.04%2c54.38 39.76%2c55.33 40.12%2c56.5 40.12%2c57.9 40.12%2c61.55 38.38%2c63.38 34.88%2c63.38 33.87%2c63.38 32.23%2c63.23 29.93%2c62.93 28.37%2c62.72 26.83%2c62.62 25.27%2c62.62 23.97%2c62.62 22.23%2c62.75 20.02%2c63 17.82%2c63.25 16.43%2c63.38 15.82%2c63.38 12.17%2c63.38 10.35%2c61.55 10.35%2c57.9 10.35%2c56.5 10.74%2c55.33 11.51%2c54.38 12.29%2c53.42 13.25%2c52.95 14.4%2c52.95 14.85%2c52.95 15.46%2c53.04 16.24%2c53.21 17.01%2c53.39 17.6%2c53.47 18%2c53.47 19.35%2c53.47 20.02%2c51.78 20.02%2c48.38 L 20.02%2c27.6 C 20.02%2c24.25 19.35%2c22.58 18%2c22.58 17.6%2c22.58 17.01%2c22.66 16.24%2c22.84 15.46%2c23.01 14.85%2c23.1 14.4%2c23.1 13.25%2c23.1 12.29%2c22.63 11.51%2c21.68 10.74%2c20.72 10.35%2c19.55 10.35%2c18.15 10.35%2c16.5 10.85%2c15.18 11.85%2c14.18 12.85%2c13.17 14.15%2c12.68 15.75%2c12.68 16.8%2c12.68 18.32%2c12.8 20.32%2c13.05 22.33%2c13.3 23.9%2c13.43 25.05%2c13.43 26%2c13.43 27.62%2c13.33 29.93%2c13.12 30.98%2c13.07 32.17%2c12.98 33.52%2c12.83 34.13%2c12.72 34.77%2c12.68 35.47%2c12.68 36.83%2c12.68 37.87%2c13.2 38.62%2c14.25 38.93%2c14.65 39.47%2c15.8 40.27%2c17.7 Z M 40.27%2c17.7' /%3e%3c/svg%3e";

var en$2 = {
	"numberbank.entry.name": "NumberBank1.0d",
	"numberbank.entry.description": "Store Numbers to Cloud."
};
var ja$2 = {
	"numberbank.entry.name": "NumberBank1.0d",
	"numberbank.entry.description": "数字をクラウドに保存する。"
};
var translations$1 = {
	en: en$2,
	ja: ja$2,
	"ja-Hira": {
	"numberbank.entry.name": "ナンバーバンク1.0d",
	"numberbank.entry.description": "すうじをクラウドにほぞんする。"
}
};

/**
 * This is an extension for Xcratch.
 */
/**
 * Formatter to translate the messages in this extension.
 * This will be replaced which is used in the React component.
 * @param {object} messageData - data for format-message
 * @returns {string} - translated message for the current locale
 */

var formatMessage$1 = function formatMessage(messageData) {
  return messageData.defaultMessage;
};

var entry = {
  get name() {
    return formatMessage$1({
      id: 'numberbank.entry.name',
      default: 'NumberBank1.0d',
      description: 'Store Numbers to Cloud.'
    });
  },

  extensionId: 'numberbank',
  extensionURL: 'https://con3office.github.io/dev-numberbank/dist/numberbank.mjs',
  collaborator: 'con3office',
  iconURL: img$2,
  insetIconURL: img$1,

  get description() {
    return formatMessage$1({
      defaultMessage: 'an extension for Xcratch',
      description: 'Store Numbers to Cloud.',
      id: 'numberbank.entry.description'
    });
  },

  featured: true,
  disabled: false,
  bluetoothRequired: false,
  internetConnectionRequired: true,
  helpLink: 'https://con3.com/numberbank/',
  setFormatMessage: function setFormatMessage(formatter) {
    formatMessage$1 = formatter;
  },
  translationMap: translations$1
};

function _arrayLikeToArray$5(arr, len) {
  if (len == null || len > arr.length) len = arr.length;

  for (var i = 0, arr2 = new Array(len); i < len; i++) {
    arr2[i] = arr[i];
  }

  return arr2;
}

function _arrayWithoutHoles(arr) {
  if (Array.isArray(arr)) return _arrayLikeToArray$5(arr);
}

function _iterableToArray(iter) {
  if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);
}

function _unsupportedIterableToArray$5(o, minLen) {
  if (!o) return;
  if (typeof o === "string") return _arrayLikeToArray$5(o, minLen);
  var n = Object.prototype.toString.call(o).slice(8, -1);
  if (n === "Object" && o.constructor) n = o.constructor.name;
  if (n === "Map" || n === "Set") return Array.from(o);
  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray$5(o, minLen);
}

function _nonIterableSpread() {
  throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}

function _toConsumableArray(arr) {
  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray$5(arr) || _nonIterableSpread();
}

function _classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}

function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor) descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
}

function _createClass(Constructor, protoProps, staticProps) {
  if (protoProps) _defineProperties(Constructor.prototype, protoProps);
  if (staticProps) _defineProperties(Constructor, staticProps);
  Object.defineProperty(Constructor, "prototype", {
    writable: false
  });
  return Constructor;
}

/**
 * Types of block
 * @enum {string}
 */
var BlockType = {
  /**
   * Boolean reporter with hexagonal shape
   */
  BOOLEAN: 'Boolean',

  /**
   * A button (not an actual block) for some special action, like making a variable
   */
  BUTTON: 'button',

  /**
   * Command block
   */
  COMMAND: 'command',

  /**
   * Specialized command block which may or may not run a child branch
   * The thread continues with the next block whether or not a child branch ran.
   */
  CONDITIONAL: 'conditional',

  /**
   * Specialized hat block with no implementation function
   * This stack only runs if the corresponding event is emitted by other code.
   */
  EVENT: 'event',

  /**
   * Hat block which conditionally starts a block stack
   */
  HAT: 'hat',

  /**
   * Specialized command block which may or may not run a child branch
   * If a child branch runs, the thread evaluates the loop block again.
   */
  LOOP: 'loop',

  /**
   * General reporter with numeric or string value
   */
  REPORTER: 'reporter'
};
var blockType = BlockType;

/**
 * Block argument types
 * @enum {string}
 */
var ArgumentType = {
  /**
   * Numeric value with angle picker
   */
  ANGLE: 'angle',

  /**
   * Boolean value with hexagonal placeholder
   */
  BOOLEAN: 'Boolean',

  /**
   * Numeric value with color picker
   */
  COLOR: 'color',

  /**
   * Numeric value with text field
   */
  NUMBER: 'number',

  /**
   * String value with text field
   */
  STRING: 'string',

  /**
   * String value with matrix field
   */
  MATRIX: 'matrix',

  /**
   * MIDI note number with note picker (piano) field
   */
  NOTE: 'note',

  /**
   * Inline image on block (as part of the label)
   */
  IMAGE: 'image'
};
var argumentType = ArgumentType;

var en$1 = {
	"numberbank.NumberBank": "NumberBank"
};
var ja$1 = {
	"numberbank.name": "NumberBank",
	"numberbank.NumberBank": "ナンバーバンク",
	"numberbank.argments.bank": "バンク",
	"numberbank.argments.card": "カード",
	"numberbank.argments.key": "key",
	"numberbank.putNum": "[BANK]の[CARD]の数字を[NUM]にする",
	"numberbank.setNum": "[VAL]を[BANK]の[CARD]の数字にする",
	"numberbank.inoutDone": "読み書き完了",
	"numberbank.getNum": "[BANK]の[CARD]を読む",
	"numberbank.repNum": "クラウド数字",
	"numberbank.repCloudNum": "[BANK]の[CARD]の数字",
	"numberbank.boolAvl": "[BANK]の[CARD]がある",
	"numberbank.setMaster": "マスター[KEY]をセット"
};
var translations = {
	en: en$1,
	ja: ja$1,
	"ja-Hira": {
	"numberbank.name": "なんばーばんく",
	"numberbank.NumberBank": "なんばーばんく",
	"numberbank.argments.bank": "ばんく",
	"numberbank.argments.card": "かーど",
	"numberbank.argments.key": "key",
	"numberbank.putNum": "[BANK]の[CARD]のすうじを[NUM]にする",
	"numberbank.setNum": "[VAL]を[BANK]の[CARD]のすうじにする",
	"numberbank.inoutDone": "よみかきかんりょう",
	"numberbank.getNum": "[BANK]の[CARD]をよむ",
	"numberbank.repNum": "クラウドすうじ",
	"numberbank.repCloudNum": "[BANK]の[CARD]のすうじ",
	"numberbank.boolAvl": "[BANK]の[CARD]がある",
	"numberbank.setMaster": "ますたー[KEY]をセット"
}
};

var img = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAEs2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgZXhpZjpQaXhlbFhEaW1lbnNpb249IjQwIgogICBleGlmOlBpeGVsWURpbWVuc2lvbj0iNDAiCiAgIGV4aWY6Q29sb3JTcGFjZT0iMSIKICAgdGlmZjpJbWFnZVdpZHRoPSI0MCIKICAgdGlmZjpJbWFnZUxlbmd0aD0iNDAiCiAgIHRpZmY6UmVzb2x1dGlvblVuaXQ9IjIiCiAgIHRpZmY6WFJlc29sdXRpb249IjcyLzEiCiAgIHRpZmY6WVJlc29sdXRpb249IjcyLzEiCiAgIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiCiAgIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjItMDUt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";

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {
  try {
    var info = gen[key](arg);
    var value = info.value;
  } catch (error) {
    reject(error);
    return;
  }

  if (info.done) {
    resolve(value);
  } else {
    Promise.resolve(value).then(_next, _throw);
  }
}

function _asyncToGenerator(fn) {
  return function () {
    var self = this,
        args = arguments;
    return new Promise(function (resolve, reject) {
      var gen = fn.apply(self, args);

      function _next(value) {
        asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value);
      }

      function _throw(err) {
        asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err);
      }

      _next(undefined);
    });
  };
}

function _typeof$1(obj) {
  "@babel/helpers - typeof";

  return _typeof$1 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) {
    return typeof obj;
  } : function (obj) {
    return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
  }, _typeof$1(obj);
}

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

var regeneratorRuntime$1 = {exports: {}};

var _typeof = {exports: {}};

(function (module) {
  function _typeof(obj) {
    "@babel/helpers - typeof";

    return (module.exports = _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) {
      return typeof obj;
    } : function (obj) {
      return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    }, module.exports.__esModule = true, module.exports["default"] = module.exports), _typeof(obj);
  }

  module.exports = _typeof, module.exports.__esModule = true, module.exports["default"] = module.exports;
})(_typeof);

(function (module) {
  var _typeof$1 = _typeof.exports["default"];

  function _regeneratorRuntime() {
    /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */

    module.exports = _regeneratorRuntime = function _regeneratorRuntime() {
      return exports;
    }, module.exports.__esModule = true, module.exports["default"] = module.exports;
    var exports = {},
        Op = Object.prototype,
        hasOwn = Op.hasOwnProperty,
        $Symbol = "function" == typeof Symbol ? Symbol : {},
        iteratorSymbol = $Symbol.iterator || "@@iterator",
        asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator",
        toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";

    function define(obj, key, value) {
      return Object.defineProperty(obj, key, {
        value: value,
        enumerable: !0,
        configurable: !0,
        writable: !0
      }), obj[key];
    }

    try {
      define({}, "");
    } catch (err) {
      define = function define(obj, key, value) {
        return obj[key] = value;
      };
    }

    function wrap(innerFn, outerFn, self, tryLocsList) {
      var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,
          generator = Object.create(protoGenerator.prototype),
          context = new Context(tryLocsList || []);
      return generator._invoke = function (innerFn, self, context) {
        var state = "suspendedStart";
        return function (method, arg) {
          if ("executing" === state) throw new Error("Generator is already running");

          if ("completed" === state) {
            if ("throw" === method) throw arg;
            return doneResult();
          }

          for (context.method = method, context.arg = arg;;) {
            var delegate = context.delegate;

            if (delegate) {
              var delegateResult = maybeInvokeDelegate(delegate, context);

              if (delegateResult) {
                if (delegateResult === ContinueSentinel) continue;
                return delegateResult;
              }
            }

            if ("next" === context.method) context.sent = context._sent = context.arg;else if ("throw" === context.method) {
              if ("suspendedStart" === state) throw state = "completed", context.arg;
              context.dispatchException(context.arg);
            } else "return" === context.method && context.abrupt("return", context.arg);
            state = "executing";
            var record = tryCatch(innerFn, self, context);

            if ("normal" === record.type) {
              if (state = context.done ? "completed" : "suspendedYield", record.arg === ContinueSentinel) continue;
              return {
                value: record.arg,
                done: context.done
              };
            }

            "throw" === record.type && (state = "completed", context.method = "throw", context.arg = record.arg);
          }
        };
      }(innerFn, self, context), generator;
    }

    function tryCatch(fn, obj, arg) {
      try {
        return {
          type: "normal",
          arg: fn.call(obj, arg)
        };
      } catch (err) {
        return {
          type: "throw",
          arg: err
        };
      }
    }

    exports.wrap = wrap;
    var ContinueSentinel = {};

    function Generator() {}

    function GeneratorFunction() {}

    function GeneratorFunctionPrototype() {}

    var IteratorPrototype = {};
    define(IteratorPrototype, iteratorSymbol, function () {
      return this;
    });
    var getProto = Object.getPrototypeOf,
        NativeIteratorPrototype = getProto && getProto(getProto(values([])));
    NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);
    var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);

    function defineIteratorMethods(prototype) {
      ["next", "throw", "return"].forEach(function (method) {
        define(prototype, method, function (arg) {
          return this._invoke(method, arg);
        });
      });
    }

    function AsyncIterator(generator, PromiseImpl) {
      function invoke(method, arg, resolve, reject) {
        var record = tryCatch(generator[method], generator, arg);

        if ("throw" !== record.type) {
          var result = record.arg,
              value = result.value;
          return value && "object" == _typeof$1(value) && hasOwn.call(value, "__await") ? PromiseImpl.resolve(value.__await).then(function (value) {
            invoke("next", value, resolve, reject);
          }, function (err) {
            invoke("throw", err, resolve, reject);
          }) : PromiseImpl.resolve(value).then(function (unwrapped) {
            result.value = unwrapped, resolve(result);
          }, function (error) {
            return invoke("throw", error, resolve, reject);
          });
        }

        reject(record.arg);
      }

      var previousPromise;

      this._invoke = function (method, arg) {
        function callInvokeWithMethodAndArg() {
          return new PromiseImpl(function (resolve, reject) {
            invoke(method, arg, resolve, reject);
          });
        }

        return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();
      };
    }

    function maybeInvokeDelegate(delegate, context) {
      var method = delegate.iterator[context.method];

      if (undefined === method) {
        if (context.delegate = null, "throw" === context.method) {
          if (delegate.iterator["return"] && (context.method = "return", context.arg = undefined, maybeInvokeDelegate(delegate, context), "throw" === context.method)) return ContinueSentinel;
          context.method = "throw", context.arg = new TypeError("The iterator does not provide a 'throw' method");
        }

        return ContinueSentinel;
      }

      var record = tryCatch(method, delegate.iterator, context.arg);
      if ("throw" === record.type) return context.method = "throw", context.arg = record.arg, context.delegate = null, ContinueSentinel;
      var info = record.arg;
      return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, "return" !== context.method && (context.method = "next", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = "throw", context.arg = new TypeError("iterator result is not an object"), context.delegate = null, ContinueSentinel);
    }

    function pushTryEntry(locs) {
      var entry = {
        tryLoc: locs[0]
      };
      1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);
    }

    function resetTryEntry(entry) {
      var record = entry.completion || {};
      record.type = "normal", delete record.arg, entry.completion = record;
    }

    function Context(tryLocsList) {
      this.tryEntries = [{
        tryLoc: "root"
      }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);
    }

    function values(iterable) {
      if (iterable) {
        var iteratorMethod = iterable[iteratorSymbol];
        if (iteratorMethod) return iteratorMethod.call(iterable);
        if ("function" == typeof iterable.next) return iterable;

        if (!isNaN(iterable.length)) {
          var i = -1,
              next = function next() {
            for (; ++i < iterable.length;) {
              if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;
            }

            return next.value = undefined, next.done = !0, next;
          };

          return next.next = next;
        }
      }

      return {
        next: doneResult
      };
    }

    function doneResult() {
      return {
        value: undefined,
        done: !0
      };
    }

    return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, "constructor", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, "constructor", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, "GeneratorFunction"), exports.isGeneratorFunction = function (genFun) {
      var ctor = "function" == typeof genFun && genFun.constructor;
      return !!ctor && (ctor === GeneratorFunction || "GeneratorFunction" === (ctor.displayName || ctor.name));
    }, exports.mark = function (genFun) {
      return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, "GeneratorFunction")), genFun.prototype = Object.create(Gp), genFun;
    }, exports.awrap = function (arg) {
      return {
        __await: arg
      };
    }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {
      return this;
    }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {
      void 0 === PromiseImpl && (PromiseImpl = Promise);
      var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);
      return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {
        return result.done ? result.value : iter.next();
      });
    }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, "Generator"), define(Gp, iteratorSymbol, function () {
      return this;
    }), define(Gp, "toString", function () {
      return "[object Generator]";
    }), exports.keys = function (object) {
      var keys = [];

      for (var key in object) {
        keys.push(key);
      }

      return keys.reverse(), function next() {
        for (; keys.length;) {
          var key = keys.pop();
          if (key in object) return next.value = key, next.done = !1, next;
        }

        return next.done = !0, next;
      };
    }, exports.values = values, Context.prototype = {
      constructor: Context,
      reset: function reset(skipTempReset) {
        if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = "next", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) {
          "t" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);
        }
      },
      stop: function stop() {
        this.done = !0;
        var rootRecord = this.tryEntries[0].completion;
        if ("throw" === rootRecord.type) throw rootRecord.arg;
        return this.rval;
      },
      dispatchException: function dispatchException(exception) {
        if (this.done) throw exception;
        var context = this;

        function handle(loc, caught) {
          return record.type = "throw", record.arg = exception, context.next = loc, caught && (context.method = "next", context.arg = undefined), !!caught;
        }

        for (var i = this.tryEntries.length - 1; i >= 0; --i) {
          var entry = this.tryEntries[i],
              record = entry.completion;
          if ("root" === entry.tryLoc) return handle("end");

          if (entry.tryLoc <= this.prev) {
            var hasCatch = hasOwn.call(entry, "catchLoc"),
                hasFinally = hasOwn.call(entry, "finallyLoc");

            if (hasCatch && hasFinally) {
              if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);
              if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);
            } else if (hasCatch) {
              if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);
            } else {
              if (!hasFinally) throw new Error("try statement without catch or finally");
              if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);
            }
          }
        }
      },
      abrupt: function abrupt(type, arg) {
        for (var i = this.tryEntries.length - 1; i >= 0; --i) {
          var entry = this.tryEntries[i];

          if (entry.tryLoc <= this.prev && hasOwn.call(entry, "finallyLoc") && this.prev < entry.finallyLoc) {
            var finallyEntry = entry;
            break;
          }
        }

        finallyEntry && ("break" === type || "continue" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);
        var record = finallyEntry ? finallyEntry.completion : {};
        return record.type = type, record.arg = arg, finallyEntry ? (this.method = "next", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);
      },
      complete: function complete(record, afterLoc) {
        if ("throw" === record.type) throw record.arg;
        return "break" === record.type || "continue" === record.type ? this.next = record.arg : "return" === record.type ? (this.rval = this.arg = record.arg, this.method = "return", this.next = "end") : "normal" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;
      },
      finish: function finish(finallyLoc) {
        for (var i = this.tryEntries.length - 1; i >= 0; --i) {
          var entry = this.tryEntries[i];
          if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;
        }
      },
      "catch": function _catch(tryLoc) {
        for (var i = this.tryEntries.length - 1; i >= 0; --i) {
          var entry = this.tryEntries[i];

          if (entry.tryLoc === tryLoc) {
            var record = entry.completion;

            if ("throw" === record.type) {
              var thrown = record.arg;
              resetTryEntry(entry);
            }

            return thrown;
          }
        }

        throw new Error("illegal catch attempt");
      },
      delegateYield: function delegateYield(iterable, resultName, nextLoc) {
        return this.delegate = {
          iterator: values(iterable),
          resultName: resultName,
          nextLoc: nextLoc
        }, "next" === this.method && (this.arg = undefined), ContinueSentinel;
      }
    }, exports;
  }

  module.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports["default"] = module.exports;
})(regeneratorRuntime$1);

var runtime = regeneratorRuntime$1.exports();
var regenerator = runtime; // Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=

try {
  regeneratorRuntime = runtime;
} catch (accidentalStrictMode) {
  if ((typeof globalThis === "undefined" ? "undefined" : _typeof$1(globalThis)) === "object") {
    globalThis.regeneratorRuntime = runtime;
  } else {
    Function("r", "regeneratorRuntime = r")(runtime);
  }
}

function _arrayWithHoles(arr) {
  if (Array.isArray(arr)) return arr;
}

function _iterableToArrayLimit(arr, i) {
  var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"];

  if (_i == null) return;
  var _arr = [];
  var _n = true;
  var _d = false;

  var _s, _e;

  try {
    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {
      _arr.push(_s.value);

      if (i && _arr.length === i) break;
    }
  } catch (err) {
    _d = true;
    _e = err;
  } finally {
    try {
      if (!_n && _i["return"] != null) _i["return"]();
    } finally {
      if (_d) throw _e;
    }
  }

  return _arr;
}

function _nonIterableRest() {
  throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}

function _slicedToArray(arr, i) {
  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray$5(arr, i) || _nonIterableRest();
}

function _assertThisInitialized(self) {
  if (self === void 0) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return self;
}

function _setPrototypeOf(o, p) {
  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {
    o.__proto__ = p;
    return o;
  };
  return _setPrototypeOf(o, p);
}

function _inherits(subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function");
  }

  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      writable: true,
      configurable: true
    }
  });
  Object.defineProperty(subClass, "prototype", {
    writable: false
  });
  if (superClass) _setPrototypeOf(subClass, superClass);
}

function _possibleConstructorReturn(self, call) {
  if (call && (_typeof$1(call) === "object" || typeof call === "function")) {
    return call;
  } else if (call !== void 0) {
    throw new TypeError("Derived constructors may only return object or undefined");
  }

  return _assertThisInitialized(self);
}

function _getPrototypeOf(o) {
  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {
    return o.__proto__ || Object.getPrototypeOf(o);
  };
  return _getPrototypeOf(o);
}

function _isNativeFunction(fn) {
  return Function.toString.call(fn).indexOf("[native code]") !== -1;
}

function _isNativeReflectConstruct$4() {
  if (typeof Reflect === "undefined" || !Reflect.construct) return false;
  if (Reflect.construct.sham) return false;
  if (typeof Proxy === "function") return true;

  try {
    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));
    return true;
  } catch (e) {
    return false;
  }
}

function _construct(Parent, args, Class) {
  if (_isNativeReflectConstruct$4()) {
    _construct = Reflect.construct.bind();
  } else {
    _construct = function _construct(Parent, args, Class) {
      var a = [null];
      a.push.apply(a, args);
      var Constructor = Function.bind.apply(Parent, a);
      var instance = new Constructor();
      if (Class) _setPrototypeOf(instance, Class.prototype);
      return instance;
    };
  }

  return _construct.apply(null, arguments);
}

function _wrapNativeSuper(Class) {
  var _cache = typeof Map === "function" ? new Map() : undefined;

  _wrapNativeSuper = function _wrapNativeSuper(Class) {
    if (Class === null || !_isNativeFunction(Class)) return Class;

    if (typeof Class !== "function") {
      throw new TypeError("Super expression must either be null or a function");
    }

    if (typeof _cache !== "undefined") {
      if (_cache.has(Class)) return _cache.get(Class);

      _cache.set(Class, Wrapper);
    }

    function Wrapper() {
      return _construct(Class, arguments, _getPrototypeOf(this).constructor);
    }

    Wrapper.prototype = Object.create(Class.prototype, {
      constructor: {
        value: Wrapper,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
    return _setPrototypeOf(Wrapper, Class);
  };

  return _wrapNativeSuper(Class);
}

var global$1 = typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {};

function _createSuper$3(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct$3(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _isNativeReflectConstruct$3() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var stringToByteArray$1 = function stringToByteArray$1(str) {
  // TODO(user): Use native implementations if/when available
  var out = [];
  var p = 0;

  for (var i = 0; i < str.length; i++) {
    var c = str.charCodeAt(i);

    if (c < 128) {
      out[p++] = c;
    } else if (c < 2048) {
      out[p++] = c >> 6 | 192;
      out[p++] = c & 63 | 128;
    } else if ((c & 0xfc00) === 0xd800 && i + 1 < str.length && (str.charCodeAt(i + 1) & 0xfc00) === 0xdc00) {
      // Surrogate Pair
      c = 0x10000 + ((c & 0x03ff) << 10) + (str.charCodeAt(++i) & 0x03ff);
      out[p++] = c >> 18 | 240;
      out[p++] = c >> 12 & 63 | 128;
      out[p++] = c >> 6 & 63 | 128;
      out[p++] = c & 63 | 128;
    } else {
      out[p++] = c >> 12 | 224;
      out[p++] = c >> 6 & 63 | 128;
      out[p++] = c & 63 | 128;
    }
  }

  return out;
};
/**
 * Turns an array of numbers into the string given by the concatenation of the
 * characters to which the numbers correspond.
 * @param bytes Array of numbers representing characters.
 * @return Stringification of the array.
 */


var byteArrayToString = function byteArrayToString(bytes) {
  // TODO(user): Use native implementations if/when available
  var out = [];
  var pos = 0,
      c = 0;

  while (pos < bytes.length) {
    var c1 = bytes[pos++];

    if (c1 < 128) {
      out[c++] = String.fromCharCode(c1);
    } else if (c1 > 191 && c1 < 224) {
      var c2 = bytes[pos++];
      out[c++] = String.fromCharCode((c1 & 31) << 6 | c2 & 63);
    } else if (c1 > 239 && c1 < 365) {
      // Surrogate Pair
      var _c = bytes[pos++];
      var c3 = bytes[pos++];
      var c4 = bytes[pos++];
      var u = ((c1 & 7) << 18 | (_c & 63) << 12 | (c3 & 63) << 6 | c4 & 63) - 0x10000;
      out[c++] = String.fromCharCode(0xd800 + (u >> 10));
      out[c++] = String.fromCharCode(0xdc00 + (u & 1023));
    } else {
      var _c2 = bytes[pos++];
      var _c3 = bytes[pos++];
      out[c++] = String.fromCharCode((c1 & 15) << 12 | (_c2 & 63) << 6 | _c3 & 63);
    }
  }

  return out.join('');
}; // We define it as an object literal instead of a class because a class compiled down to es5 can't
// be treeshaked. https://github.com/rollup/rollup/issues/1691
// Static lookup maps, lazily populated by init_()


var base64 = {
  /**
   * Maps bytes to characters.
   */
  byteToCharMap_: null,

  /**
   * Maps characters to bytes.
   */
  charToByteMap_: null,

  /**
   * Maps bytes to websafe characters.
   * @private
   */
  byteToCharMapWebSafe_: null,

  /**
   * Maps websafe characters to bytes.
   * @private
   */
  charToByteMapWebSafe_: null,

  /**
   * Our default alphabet, shared between
   * ENCODED_VALS and ENCODED_VALS_WEBSAFE
   */
  ENCODED_VALS_BASE: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz' + '0123456789',

  /**
   * Our default alphabet. Value 64 (=) is special; it means "nothing."
   */
  get ENCODED_VALS() {
    return this.ENCODED_VALS_BASE + '+/=';
  },

  /**
   * Our websafe alphabet.
   */
  get ENCODED_VALS_WEBSAFE() {
    return this.ENCODED_VALS_BASE + '-_.';
  },

  /**
   * Whether this browser supports the atob and btoa functions. This extension
   * started at Mozilla but is now implemented by many browsers. We use the
   * ASSUME_* variables to avoid pulling in the full useragent detection library
   * but still allowing the standard per-browser compilations.
   *
   */
  HAS_NATIVE_SUPPORT: typeof atob === 'function',

  /**
   * Base64-encode an array of bytes.
   *
   * @param input An array of bytes (numbers with
   *     value in [0, 255]) to encode.
   * @param webSafe Boolean indicating we should use the
   *     alternative alphabet.
   * @return The base64 encoded string.
   */
  encodeByteArray: function encodeByteArray(input, webSafe) {
    if (!Array.isArray(input)) {
      throw Error('encodeByteArray takes an array as a parameter');
    }

    this.init_();
    var byteToCharMap = webSafe ? this.byteToCharMapWebSafe_ : this.byteToCharMap_;
    var output = [];

    for (var i = 0; i < input.length; i += 3) {
      var byte1 = input[i];
      var haveByte2 = i + 1 < input.length;
      var byte2 = haveByte2 ? input[i + 1] : 0;
      var haveByte3 = i + 2 < input.length;
      var byte3 = haveByte3 ? input[i + 2] : 0;
      var outByte1 = byte1 >> 2;
      var outByte2 = (byte1 & 0x03) << 4 | byte2 >> 4;
      var outByte3 = (byte2 & 0x0f) << 2 | byte3 >> 6;
      var outByte4 = byte3 & 0x3f;

      if (!haveByte3) {
        outByte4 = 64;

        if (!haveByte2) {
          outByte3 = 64;
        }
      }

      output.push(byteToCharMap[outByte1], byteToCharMap[outByte2], byteToCharMap[outByte3], byteToCharMap[outByte4]);
    }

    return output.join('');
  },

  /**
   * Base64-encode a string.
   *
   * @param input A string to encode.
   * @param webSafe If true, we should use the
   *     alternative alphabet.
   * @return The base64 encoded string.
   */
  encodeString: function encodeString(input, webSafe) {
    // Shortcut for Mozilla browsers that implement
    // a native base64 encoder in the form of "btoa/atob"
    if (this.HAS_NATIVE_SUPPORT && !webSafe) {
      return btoa(input);
    }

    return this.encodeByteArray(stringToByteArray$1(input), webSafe);
  },

  /**
   * Base64-decode a string.
   *
   * @param input to decode.
   * @param webSafe True if we should use the
   *     alternative alphabet.
   * @return string representing the decoded value.
   */
  decodeString: function decodeString(input, webSafe) {
    // Shortcut for Mozilla browsers that implement
    // a native base64 encoder in the form of "btoa/atob"
    if (this.HAS_NATIVE_SUPPORT && !webSafe) {
      return atob(input);
    }

    return byteArrayToString(this.decodeStringToByteArray(input, webSafe));
  },

  /**
   * Base64-decode a string.
   *
   * In base-64 decoding, groups of four characters are converted into three
   * bytes.  If the encoder did not apply padding, the input length may not
   * be a multiple of 4.
   *
   * In this case, the last group will have fewer than 4 characters, and
   * padding will be inferred.  If the group has one or two characters, it decodes
   * to one byte.  If the group has three characters, it decodes to two bytes.
   *
   * @param input Input to decode.
   * @param webSafe True if we should use the web-safe alphabet.
   * @return bytes representing the decoded value.
   */
  decodeStringToByteArray: function decodeStringToByteArray(input, webSafe) {
    this.init_();
    var charToByteMap = webSafe ? this.charToByteMapWebSafe_ : this.charToByteMap_;
    var output = [];

    for (var i = 0; i < input.length;) {
      var byte1 = charToByteMap[input.charAt(i++)];
      var haveByte2 = i < input.length;
      var byte2 = haveByte2 ? charToByteMap[input.charAt(i)] : 0;
      ++i;
      var haveByte3 = i < input.length;
      var byte3 = haveByte3 ? charToByteMap[input.charAt(i)] : 64;
      ++i;
      var haveByte4 = i < input.length;
      var byte4 = haveByte4 ? charToByteMap[input.charAt(i)] : 64;
      ++i;

      if (byte1 == null || byte2 == null || byte3 == null || byte4 == null) {
        throw Error();
      }

      var outByte1 = byte1 << 2 | byte2 >> 4;
      output.push(outByte1);

      if (byte3 !== 64) {
        var outByte2 = byte2 << 4 & 0xf0 | byte3 >> 2;
        output.push(outByte2);

        if (byte4 !== 64) {
          var outByte3 = byte3 << 6 & 0xc0 | byte4;
          output.push(outByte3);
        }
      }
    }

    return output;
  },

  /**
   * Lazy static initialization function. Called before
   * accessing any of the static map variables.
   * @private
   */
  init_: function init_() {
    if (!this.byteToCharMap_) {
      this.byteToCharMap_ = {};
      this.charToByteMap_ = {};
      this.byteToCharMapWebSafe_ = {};
      this.charToByteMapWebSafe_ = {}; // We want quick mappings back and forth, so we precompute two maps.

      for (var i = 0; i < this.ENCODED_VALS.length; i++) {
        this.byteToCharMap_[i] = this.ENCODED_VALS.charAt(i);
        this.charToByteMap_[this.byteToCharMap_[i]] = i;
        this.byteToCharMapWebSafe_[i] = this.ENCODED_VALS_WEBSAFE.charAt(i);
        this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]] = i; // Be forgiving when decoding and correctly decode both encodings.

        if (i >= this.ENCODED_VALS_BASE.length) {
          this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)] = i;
          this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)] = i;
        }
      }
    }
  }
};
/**
 * URL-safe base64 encoding
 */

var base64Encode = function base64Encode(str) {
  var utf8Bytes = stringToByteArray$1(str);
  return base64.encodeByteArray(utf8Bytes, true);
};
/**
 * URL-safe base64 encoding (without "." padding in the end).
 * e.g. Used in JSON Web Token (JWT) parts.
 */


var base64urlEncodeWithoutPadding = function base64urlEncodeWithoutPadding(str) {
  // Use base64url encoding and remove padding in the end (dot characters).
  return base64Encode(str).replace(/\./g, '');
};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var Deferred = /*#__PURE__*/function () {
  function Deferred() {
    var _this = this;

    _classCallCheck(this, Deferred);

    this.reject = function () {};

    this.resolve = function () {};

    this.promise = new Promise(function (resolve, reject) {
      _this.resolve = resolve;
      _this.reject = reject;
    });
  }
  /**
   * Our API internals are not promiseified and cannot because our callback APIs have subtle expectations around
   * invoking promises inline, which Promises are forbidden to do. This method accepts an optional node-style callback
   * and returns a node-style callback which will resolve or reject the Deferred's promise.
   */


  _createClass(Deferred, [{
    key: "wrapCallback",
    value: function wrapCallback(callback) {
      var _this2 = this;

      return function (error, value) {
        if (error) {
          _this2.reject(error);
        } else {
          _this2.resolve(value);
        }

        if (typeof callback === 'function') {
          // Attaching noop handler just in case developer wasn't expecting
          // promises
          _this2.promise.catch(function () {}); // Some of our callbacks don't expect a value and our own tests
          // assert that the parameter length is 1


          if (callback.length === 1) {
            callback(error);
          } else {
            callback(error, value);
          }
        }
      };
    }
  }]);

  return Deferred;
}();
/**
 * This method checks if indexedDB is supported by current browser/service worker context
 * @return true if indexedDB is supported by current browser/service worker context
 */


function isIndexedDBAvailable() {
  return (typeof indexedDB === "undefined" ? "undefined" : _typeof$1(indexedDB)) === 'object';
}
/**
 * This method validates browser/sw context for indexedDB by opening a dummy indexedDB database and reject
 * if errors occur during the database open operation.
 *
 * @throws exception if current browser/sw context can't run idb.open (ex: Safari iframe, Firefox
 * private browsing)
 */


function validateIndexedDBOpenable() {
  return new Promise(function (resolve, reject) {
    try {
      var preExist = true;
      var DB_CHECK_NAME = 'validate-browser-context-for-indexeddb-analytics-module';
      var request = self.indexedDB.open(DB_CHECK_NAME);

      request.onsuccess = function () {
        request.result.close(); // delete database only when it doesn't pre-exist

        if (!preExist) {
          self.indexedDB.deleteDatabase(DB_CHECK_NAME);
        }

        resolve(true);
      };

      request.onupgradeneeded = function () {
        preExist = false;
      };

      request.onerror = function () {
        var _a;

        reject(((_a = request.error) === null || _a === void 0 ? void 0 : _a.message) || '');
      };
    } catch (error) {
      reject(error);
    }
  });
}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * @fileoverview Standardized Firebase Error.
 *
 * Usage:
 *
 *   // Typescript string literals for type-safe codes
 *   type Err =
 *     'unknown' |
 *     'object-not-found'
 *     ;
 *
 *   // Closure enum for type-safe error codes
 *   // at-enum {string}
 *   var Err = {
 *     UNKNOWN: 'unknown',
 *     OBJECT_NOT_FOUND: 'object-not-found',
 *   }
 *
 *   let errors: Map<Err, string> = {
 *     'generic-error': "Unknown error",
 *     'file-not-found': "Could not find file: {$file}",
 *   };
 *
 *   // Type-safe function - must pass a valid error code as param.
 *   let error = new ErrorFactory<Err>('service', 'Service', errors);
 *
 *   ...
 *   throw error.create(Err.GENERIC);
 *   ...
 *   throw error.create(Err.FILE_NOT_FOUND, {'file': fileName});
 *   ...
 *   // Service: Could not file file: foo.txt (service/file-not-found).
 *
 *   catch (e) {
 *     assert(e.message === "Could not find file: foo.txt.");
 *     if ((e as FirebaseError)?.code === 'service/file-not-found') {
 *       console.log("Could not read file: " + e['file']);
 *     }
 *   }
 */


var ERROR_NAME = 'FirebaseError'; // Based on code from:
// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types

var FirebaseError = /*#__PURE__*/function (_Error) {
  _inherits(FirebaseError, _Error);

  var _super = _createSuper$3(FirebaseError);

  function FirebaseError(
  /** The error code for this error. */
  code, message,
  /** Custom data for this error. */
  customData) {
    var _this3;

    _classCallCheck(this, FirebaseError);

    _this3 = _super.call(this, message);
    _this3.code = code;
    _this3.customData = customData;
    /** The custom name for all FirebaseErrors. */

    _this3.name = ERROR_NAME; // Fix For ES5
    // https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work

    Object.setPrototypeOf(_assertThisInitialized(_this3), FirebaseError.prototype); // Maintains proper stack trace for where our error was thrown.
    // Only available on V8.

    if (Error.captureStackTrace) {
      Error.captureStackTrace(_assertThisInitialized(_this3), ErrorFactory.prototype.create);
    }

    return _this3;
  }

  return _createClass(FirebaseError);
}( /*#__PURE__*/_wrapNativeSuper(Error));

var ErrorFactory = /*#__PURE__*/function () {
  function ErrorFactory(service, serviceName, errors) {
    _classCallCheck(this, ErrorFactory);

    this.service = service;
    this.serviceName = serviceName;
    this.errors = errors;
  }

  _createClass(ErrorFactory, [{
    key: "create",
    value: function create(code) {
      var customData = (arguments.length <= 1 ? undefined : arguments[1]) || {};
      var fullCode = "".concat(this.service, "/").concat(code);
      var template = this.errors[code];
      var message = template ? replaceTemplate(template, customData) : 'Error'; // Service Name: Error message (service/code).

      var fullMessage = "".concat(this.serviceName, ": ").concat(message, " (").concat(fullCode, ").");
      var error = new FirebaseError(fullCode, fullMessage, customData);
      return error;
    }
  }]);

  return ErrorFactory;
}();

function replaceTemplate(template, data) {
  return template.replace(PATTERN, function (_, key) {
    var value = data[key];
    return value != null ? String(value) : "<".concat(key, "?>");
  });
}

var PATTERN = /\{\$([^}]+)}/g;
/**
 * Deep equal two objects. Support Arrays and Objects.
 */


function deepEqual(a, b) {
  if (a === b) {
    return true;
  }

  var aKeys = Object.keys(a);
  var bKeys = Object.keys(b);

  for (var _i = 0, _aKeys = aKeys; _i < _aKeys.length; _i++) {
    var k = _aKeys[_i];

    if (!bKeys.includes(k)) {
      return false;
    }

    var aProp = a[k];
    var bProp = b[k];

    if (isObject(aProp) && isObject(bProp)) {
      if (!deepEqual(aProp, bProp)) {
        return false;
      }
    } else if (aProp !== bProp) {
      return false;
    }
  }

  for (var _i2 = 0, _bKeys = bKeys; _i2 < _bKeys.length; _i2++) {
    var _k = _bKeys[_i2];

    if (!aKeys.includes(_k)) {
      return false;
    }
  }

  return true;
}

function isObject(thing) {
  return thing !== null && _typeof$1(thing) === 'object';
}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


function getModularInstance(service) {
  if (service && service._delegate) {
    return service._delegate;
  } else {
    return service;
  }
}

function _createForOfIteratorHelper$4(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray$4(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }

function _unsupportedIterableToArray$4(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray$4(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray$4(o, minLen); }

function _arrayLikeToArray$4(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }
/**
 * Component for service name T, e.g. `auth`, `auth-internal`
 */

var Component = /*#__PURE__*/function () {
  /**
   *
   * @param name The public service name, e.g. app, auth, firestore, database
   * @param instanceFactory Service factory responsible for creating the public interface
   * @param type whether the service provided by the component is public or private
   */
  function Component(name, instanceFactory, type) {
    _classCallCheck(this, Component);

    this.name = name;
    this.instanceFactory = instanceFactory;
    this.type = type;
    this.multipleInstances = false;
    /**
     * Properties to be added to the service namespace
     */

    this.serviceProps = {};
    this.instantiationMode = "LAZY"
    /* LAZY */
    ;
    this.onInstanceCreated = null;
  }

  _createClass(Component, [{
    key: "setInstantiationMode",
    value: function setInstantiationMode(mode) {
      this.instantiationMode = mode;
      return this;
    }
  }, {
    key: "setMultipleInstances",
    value: function setMultipleInstances(multipleInstances) {
      this.multipleInstances = multipleInstances;
      return this;
    }
  }, {
    key: "setServiceProps",
    value: function setServiceProps(props) {
      this.serviceProps = props;
      return this;
    }
  }, {
    key: "setInstanceCreatedCallback",
    value: function setInstanceCreatedCallback(callback) {
      this.onInstanceCreated = callback;
      return this;
    }
  }]);

  return Component;
}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var DEFAULT_ENTRY_NAME$1 = '[DEFAULT]';
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Provider for instance for service name T, e.g. 'auth', 'auth-internal'
 * NameServiceMapping[T] is an alias for the type of the instance
 */

var Provider = /*#__PURE__*/function () {
  function Provider(name, container) {
    _classCallCheck(this, Provider);

    this.name = name;
    this.container = container;
    this.component = null;
    this.instances = new Map();
    this.instancesDeferred = new Map();
    this.instancesOptions = new Map();
    this.onInitCallbacks = new Map();
  }
  /**
   * @param identifier A provider can provide mulitple instances of a service
   * if this.component.multipleInstances is true.
   */


  _createClass(Provider, [{
    key: "get",
    value: function get(identifier) {
      // if multipleInstances is not supported, use the default name
      var normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);

      if (!this.instancesDeferred.has(normalizedIdentifier)) {
        var deferred = new Deferred();
        this.instancesDeferred.set(normalizedIdentifier, deferred);

        if (this.isInitialized(normalizedIdentifier) || this.shouldAutoInitialize()) {
          // initialize the service if it can be auto-initialized
          try {
            var instance = this.getOrInitializeService({
              instanceIdentifier: normalizedIdentifier
            });

            if (instance) {
              deferred.resolve(instance);
            }
          } catch (e) {// when the instance factory throws an exception during get(), it should not cause
            // a fatal error. We just return the unresolved promise in this case.
          }
        }
      }

      return this.instancesDeferred.get(normalizedIdentifier).promise;
    }
  }, {
    key: "getImmediate",
    value: function getImmediate(options) {
      var _a; // if multipleInstances is not supported, use the default name


      var normalizedIdentifier = this.normalizeInstanceIdentifier(options === null || options === void 0 ? void 0 : options.identifier);
      var optional = (_a = options === null || options === void 0 ? void 0 : options.optional) !== null && _a !== void 0 ? _a : false;

      if (this.isInitialized(normalizedIdentifier) || this.shouldAutoInitialize()) {
        try {
          return this.getOrInitializeService({
            instanceIdentifier: normalizedIdentifier
          });
        } catch (e) {
          if (optional) {
            return null;
          } else {
            throw e;
          }
        }
      } else {
        // In case a component is not initialized and should/can not be auto-initialized at the moment, return null if the optional flag is set, or throw
        if (optional) {
          return null;
        } else {
          throw Error("Service ".concat(this.name, " is not available"));
        }
      }
    }
  }, {
    key: "getComponent",
    value: function getComponent() {
      return this.component;
    }
  }, {
    key: "setComponent",
    value: function setComponent(component) {
      if (component.name !== this.name) {
        throw Error("Mismatching Component ".concat(component.name, " for Provider ").concat(this.name, "."));
      }

      if (this.component) {
        throw Error("Component for ".concat(this.name, " has already been provided"));
      }

      this.component = component; // return early without attempting to initialize the component if the component requires explicit initialization (calling `Provider.initialize()`)

      if (!this.shouldAutoInitialize()) {
        return;
      } // if the service is eager, initialize the default instance


      if (isComponentEager(component)) {
        try {
          this.getOrInitializeService({
            instanceIdentifier: DEFAULT_ENTRY_NAME$1
          });
        } catch (e) {// when the instance factory for an eager Component throws an exception during the eager
          // initialization, it should not cause a fatal error.
          // TODO: Investigate if we need to make it configurable, because some component may want to cause
          // a fatal error in this case?
        }
      } // Create service instances for the pending promises and resolve them
      // NOTE: if this.multipleInstances is false, only the default instance will be created
      // and all promises with resolve with it regardless of the identifier.


      var _iterator = _createForOfIteratorHelper$4(this.instancesDeferred.entries()),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var _step$value = _slicedToArray(_step.value, 2),
              instanceIdentifier = _step$value[0],
              instanceDeferred = _step$value[1];

          var normalizedIdentifier = this.normalizeInstanceIdentifier(instanceIdentifier);

          try {
            // `getOrInitializeService()` should always return a valid instance since a component is guaranteed. use ! to make typescript happy.
            var instance = this.getOrInitializeService({
              instanceIdentifier: normalizedIdentifier
            });
            instanceDeferred.resolve(instance);
          } catch (e) {// when the instance factory throws an exception, it should not cause
            // a fatal error. We just leave the promise unresolved.
          }
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }
    }
  }, {
    key: "clearInstance",
    value: function clearInstance() {
      var identifier = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_ENTRY_NAME$1;
      this.instancesDeferred.delete(identifier);
      this.instancesOptions.delete(identifier);
      this.instances.delete(identifier);
    } // app.delete() will call this method on every provider to delete the services
    // TODO: should we mark the provider as deleted?

  }, {
    key: "delete",
    value: function () {
      var _delete2 = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee() {
        var services;
        return regenerator.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                services = Array.from(this.instances.values());
                _context.next = 3;
                return Promise.all([].concat(_toConsumableArray(services.filter(function (service) {
                  return 'INTERNAL' in service;
                }) // legacy services
                // eslint-disable-next-line @typescript-eslint/no-explicit-any
                .map(function (service) {
                  return service.INTERNAL.delete();
                })), _toConsumableArray(services.filter(function (service) {
                  return '_delete' in service;
                }) // modularized services
                // eslint-disable-next-line @typescript-eslint/no-explicit-any
                .map(function (service) {
                  return service._delete();
                }))));

              case 3:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function _delete() {
        return _delete2.apply(this, arguments);
      }

      return _delete;
    }()
  }, {
    key: "isComponentSet",
    value: function isComponentSet() {
      return this.component != null;
    }
  }, {
    key: "isInitialized",
    value: function isInitialized() {
      var identifier = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_ENTRY_NAME$1;
      return this.instances.has(identifier);
    }
  }, {
    key: "getOptions",
    value: function getOptions() {
      var identifier = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_ENTRY_NAME$1;
      return this.instancesOptions.get(identifier) || {};
    }
  }, {
    key: "initialize",
    value: function initialize() {
      var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      var _opts$options = opts.options,
          options = _opts$options === void 0 ? {} : _opts$options;
      var normalizedIdentifier = this.normalizeInstanceIdentifier(opts.instanceIdentifier);

      if (this.isInitialized(normalizedIdentifier)) {
        throw Error("".concat(this.name, "(").concat(normalizedIdentifier, ") has already been initialized"));
      }

      if (!this.isComponentSet()) {
        throw Error("Component ".concat(this.name, " has not been registered yet"));
      }

      var instance = this.getOrInitializeService({
        instanceIdentifier: normalizedIdentifier,
        options: options
      }); // resolve any pending promise waiting for the service instance

      var _iterator2 = _createForOfIteratorHelper$4(this.instancesDeferred.entries()),
          _step2;

      try {
        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
          var _step2$value = _slicedToArray(_step2.value, 2),
              instanceIdentifier = _step2$value[0],
              instanceDeferred = _step2$value[1];

          var normalizedDeferredIdentifier = this.normalizeInstanceIdentifier(instanceIdentifier);

          if (normalizedIdentifier === normalizedDeferredIdentifier) {
            instanceDeferred.resolve(instance);
          }
        }
      } catch (err) {
        _iterator2.e(err);
      } finally {
        _iterator2.f();
      }

      return instance;
    }
    /**
     *
     * @param callback - a function that will be invoked  after the provider has been initialized by calling provider.initialize().
     * The function is invoked SYNCHRONOUSLY, so it should not execute any longrunning tasks in order to not block the program.
     *
     * @param identifier An optional instance identifier
     * @returns a function to unregister the callback
     */

  }, {
    key: "onInit",
    value: function onInit(callback, identifier) {
      var _a;

      var normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);
      var existingCallbacks = (_a = this.onInitCallbacks.get(normalizedIdentifier)) !== null && _a !== void 0 ? _a : new Set();
      existingCallbacks.add(callback);
      this.onInitCallbacks.set(normalizedIdentifier, existingCallbacks);
      var existingInstance = this.instances.get(normalizedIdentifier);

      if (existingInstance) {
        callback(existingInstance, normalizedIdentifier);
      }

      return function () {
        existingCallbacks.delete(callback);
      };
    }
    /**
     * Invoke onInit callbacks synchronously
     * @param instance the service instance`
     */

  }, {
    key: "invokeOnInitCallbacks",
    value: function invokeOnInitCallbacks(instance, identifier) {
      var callbacks = this.onInitCallbacks.get(identifier);

      if (!callbacks) {
        return;
      }

      var _iterator3 = _createForOfIteratorHelper$4(callbacks),
          _step3;

      try {
        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
          var callback = _step3.value;

          try {
            callback(instance, identifier);
          } catch (_a) {// ignore errors in the onInit callback
          }
        }
      } catch (err) {
        _iterator3.e(err);
      } finally {
        _iterator3.f();
      }
    }
  }, {
    key: "getOrInitializeService",
    value: function getOrInitializeService(_ref) {
      var instanceIdentifier = _ref.instanceIdentifier,
          _ref$options = _ref.options,
          options = _ref$options === void 0 ? {} : _ref$options;
      var instance = this.instances.get(instanceIdentifier);

      if (!instance && this.component) {
        instance = this.component.instanceFactory(this.container, {
          instanceIdentifier: normalizeIdentifierForFactory(instanceIdentifier),
          options: options
        });
        this.instances.set(instanceIdentifier, instance);
        this.instancesOptions.set(instanceIdentifier, options);
        /**
         * Invoke onInit listeners.
         * Note this.component.onInstanceCreated is different, which is used by the component creator,
         * while onInit listeners are registered by consumers of the provider.
         */

        this.invokeOnInitCallbacks(instance, instanceIdentifier);
        /**
         * Order is important
         * onInstanceCreated() should be called after this.instances.set(instanceIdentifier, instance); which
         * makes `isInitialized()` return true.
         */

        if (this.component.onInstanceCreated) {
          try {
            this.component.onInstanceCreated(this.container, instanceIdentifier, instance);
          } catch (_a) {// ignore errors in the onInstanceCreatedCallback
          }
        }
      }

      return instance || null;
    }
  }, {
    key: "normalizeInstanceIdentifier",
    value: function normalizeInstanceIdentifier() {
      var identifier = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_ENTRY_NAME$1;

      if (this.component) {
        return this.component.multipleInstances ? identifier : DEFAULT_ENTRY_NAME$1;
      } else {
        return identifier; // assume multiple instances are supported before the component is provided.
      }
    }
  }, {
    key: "shouldAutoInitialize",
    value: function shouldAutoInitialize() {
      return !!this.component && this.component.instantiationMode !== "EXPLICIT"
      /* EXPLICIT */
      ;
    }
  }]);

  return Provider;
}(); // undefined should be passed to the service factory for the default instance


function normalizeIdentifierForFactory(identifier) {
  return identifier === DEFAULT_ENTRY_NAME$1 ? undefined : identifier;
}

function isComponentEager(component) {
  return component.instantiationMode === "EAGER"
  /* EAGER */
  ;
}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * ComponentContainer that provides Providers for service name T, e.g. `auth`, `auth-internal`
 */


var ComponentContainer = /*#__PURE__*/function () {
  function ComponentContainer(name) {
    _classCallCheck(this, ComponentContainer);

    this.name = name;
    this.providers = new Map();
  }
  /**
   *
   * @param component Component being added
   * @param overwrite When a component with the same name has already been registered,
   * if overwrite is true: overwrite the existing component with the new component and create a new
   * provider with the new component. It can be useful in tests where you want to use different mocks
   * for different tests.
   * if overwrite is false: throw an exception
   */


  _createClass(ComponentContainer, [{
    key: "addComponent",
    value: function addComponent(component) {
      var provider = this.getProvider(component.name);

      if (provider.isComponentSet()) {
        throw new Error("Component ".concat(component.name, " has already been registered with ").concat(this.name));
      }

      provider.setComponent(component);
    }
  }, {
    key: "addOrOverwriteComponent",
    value: function addOrOverwriteComponent(component) {
      var provider = this.getProvider(component.name);

      if (provider.isComponentSet()) {
        // delete the existing provider from the container, so we can register the new component
        this.providers.delete(component.name);
      }

      this.addComponent(component);
    }
    /**
     * getProvider provides a type safe interface where it can only be called with a field name
     * present in NameServiceMapping interface.
     *
     * Firebase SDKs providing services should extend NameServiceMapping interface to register
     * themselves.
     */

  }, {
    key: "getProvider",
    value: function getProvider(name) {
      if (this.providers.has(name)) {
        return this.providers.get(name);
      } // create a Provider for a service that hasn't registered with Firebase


      var provider = new Provider(name, this);
      this.providers.set(name, provider);
      return provider;
    }
  }, {
    key: "getProviders",
    value: function getProviders() {
      return Array.from(this.providers.values());
    }
  }]);

  return ComponentContainer;
}();

var _ConsoleMethod;
/**
 * The JS SDK supports 5 log levels and also allows a user the ability to
 * silence the logs altogether.
 *
 * The order is a follows:
 * DEBUG < VERBOSE < INFO < WARN < ERROR
 *
 * All of the log types above the current log level will be captured (i.e. if
 * you set the log level to `INFO`, errors will still be logged, but `DEBUG` and
 * `VERBOSE` logs will not)
 */

var LogLevel;

(function (LogLevel) {
  LogLevel[LogLevel["DEBUG"] = 0] = "DEBUG";
  LogLevel[LogLevel["VERBOSE"] = 1] = "VERBOSE";
  LogLevel[LogLevel["INFO"] = 2] = "INFO";
  LogLevel[LogLevel["WARN"] = 3] = "WARN";
  LogLevel[LogLevel["ERROR"] = 4] = "ERROR";
  LogLevel[LogLevel["SILENT"] = 5] = "SILENT";
})(LogLevel || (LogLevel = {}));

var levelStringToEnum = {
  'debug': LogLevel.DEBUG,
  'verbose': LogLevel.VERBOSE,
  'info': LogLevel.INFO,
  'warn': LogLevel.WARN,
  'error': LogLevel.ERROR,
  'silent': LogLevel.SILENT
};
/**
 * The default log level
 */

var defaultLogLevel = LogLevel.INFO;
/**
 * By default, `console.debug` is not displayed in the developer console (in
 * chrome). To avoid forcing users to have to opt-in to these logs twice
 * (i.e. once for firebase, and once in the console), we are sending `DEBUG`
 * logs to the `console.log` function.
 */

var ConsoleMethod = (_ConsoleMethod = {}, _defineProperty(_ConsoleMethod, LogLevel.DEBUG, 'log'), _defineProperty(_ConsoleMethod, LogLevel.VERBOSE, 'log'), _defineProperty(_ConsoleMethod, LogLevel.INFO, 'info'), _defineProperty(_ConsoleMethod, LogLevel.WARN, 'warn'), _defineProperty(_ConsoleMethod, LogLevel.ERROR, 'error'), _ConsoleMethod);
/**
 * The default log handler will forward DEBUG, VERBOSE, INFO, WARN, and ERROR
 * messages on to their corresponding console counterparts (if the log method
 * is supported by the current log level)
 */

var defaultLogHandler = function defaultLogHandler(instance, logType) {
  if (logType < instance.logLevel) {
    return;
  }

  var now = new Date().toISOString();
  var method = ConsoleMethod[logType];

  if (method) {
    var _console;

    for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {
      args[_key - 2] = arguments[_key];
    }

    (_console = console)[method].apply(_console, ["[".concat(now, "]  ").concat(instance.name, ":")].concat(args));
  } else {
    throw new Error("Attempted to log a message with an invalid logType (value: ".concat(logType, ")"));
  }
};

var Logger = /*#__PURE__*/function () {
  /**
   * Gives you an instance of a Logger to capture messages according to
   * Firebase's logging scheme.
   *
   * @param name The name that the logs will be associated with
   */
  function Logger(name) {
    _classCallCheck(this, Logger);

    this.name = name;
    /**
     * The log level of the given Logger instance.
     */

    this._logLevel = defaultLogLevel;
    /**
     * The main (internal) log handler for the Logger instance.
     * Can be set to a new function in internal package code but not by user.
     */

    this._logHandler = defaultLogHandler;
    /**
     * The optional, additional, user-defined log handler for the Logger instance.
     */

    this._userLogHandler = null;
  }

  _createClass(Logger, [{
    key: "logLevel",
    get: function get() {
      return this._logLevel;
    },
    set: function set(val) {
      if (!(val in LogLevel)) {
        throw new TypeError("Invalid value \"".concat(val, "\" assigned to `logLevel`"));
      }

      this._logLevel = val;
    } // Workaround for setter/getter having to be the same type.

  }, {
    key: "setLogLevel",
    value: function setLogLevel(val) {
      this._logLevel = typeof val === 'string' ? levelStringToEnum[val] : val;
    }
  }, {
    key: "logHandler",
    get: function get() {
      return this._logHandler;
    },
    set: function set(val) {
      if (typeof val !== 'function') {
        throw new TypeError('Value assigned to `logHandler` must be a function');
      }

      this._logHandler = val;
    }
  }, {
    key: "userLogHandler",
    get: function get() {
      return this._userLogHandler;
    },
    set: function set(val) {
      this._userLogHandler = val;
    }
    /**
     * The functions below are all based on the `console` interface
     */

  }, {
    key: "debug",
    value: function debug() {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }

      this._userLogHandler && this._userLogHandler.apply(this, [this, LogLevel.DEBUG].concat(args));

      this._logHandler.apply(this, [this, LogLevel.DEBUG].concat(args));
    }
  }, {
    key: "log",
    value: function log() {
      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
        args[_key3] = arguments[_key3];
      }

      this._userLogHandler && this._userLogHandler.apply(this, [this, LogLevel.VERBOSE].concat(args));

      this._logHandler.apply(this, [this, LogLevel.VERBOSE].concat(args));
    }
  }, {
    key: "info",
    value: function info() {
      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
        args[_key4] = arguments[_key4];
      }

      this._userLogHandler && this._userLogHandler.apply(this, [this, LogLevel.INFO].concat(args));

      this._logHandler.apply(this, [this, LogLevel.INFO].concat(args));
    }
  }, {
    key: "warn",
    value: function warn() {
      for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
        args[_key5] = arguments[_key5];
      }

      this._userLogHandler && this._userLogHandler.apply(this, [this, LogLevel.WARN].concat(args));

      this._logHandler.apply(this, [this, LogLevel.WARN].concat(args));
    }
  }, {
    key: "error",
    value: function error() {
      for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {
        args[_key6] = arguments[_key6];
      }

      this._userLogHandler && this._userLogHandler.apply(this, [this, LogLevel.ERROR].concat(args));

      this._logHandler.apply(this, [this, LogLevel.ERROR].concat(args));
    }
  }]);

  return Logger;
}();

var instanceOfAny = function instanceOfAny(object, constructors) {
  return constructors.some(function (c) {
    return object instanceof c;
  });
};

var idbProxyableTypes;
var cursorAdvanceMethods; // This is a function to prevent it throwing up in node environments.

function getIdbProxyableTypes() {
  return idbProxyableTypes || (idbProxyableTypes = [IDBDatabase, IDBObjectStore, IDBIndex, IDBCursor, IDBTransaction]);
} // This is a function to prevent it throwing up in node environments.


function getCursorAdvanceMethods() {
  return cursorAdvanceMethods || (cursorAdvanceMethods = [IDBCursor.prototype.advance, IDBCursor.prototype.continue, IDBCursor.prototype.continuePrimaryKey]);
}

var cursorRequestMap = new WeakMap();
var transactionDoneMap = new WeakMap();
var transactionStoreNamesMap = new WeakMap();
var transformCache = new WeakMap();
var reverseTransformCache = new WeakMap();

function promisifyRequest(request) {
  var promise = new Promise(function (resolve, reject) {
    var unlisten = function unlisten() {
      request.removeEventListener('success', success);
      request.removeEventListener('error', error);
    };

    var success = function success() {
      resolve(wrap(request.result));
      unlisten();
    };

    var error = function error() {
      reject(request.error);
      unlisten();
    };

    request.addEventListener('success', success);
    request.addEventListener('error', error);
  });
  promise.then(function (value) {
    // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval
    // (see wrapFunction).
    if (value instanceof IDBCursor) {
      cursorRequestMap.set(value, request);
    } // Catching to avoid "Uncaught Promise exceptions"

  }).catch(function () {}); // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This
  // is because we create many promises from a single IDBRequest.

  reverseTransformCache.set(promise, request);
  return promise;
}

function cacheDonePromiseForTransaction(tx) {
  // Early bail if we've already created a done promise for this transaction.
  if (transactionDoneMap.has(tx)) return;
  var done = new Promise(function (resolve, reject) {
    var unlisten = function unlisten() {
      tx.removeEventListener('complete', complete);
      tx.removeEventListener('error', error);
      tx.removeEventListener('abort', error);
    };

    var complete = function complete() {
      resolve();
      unlisten();
    };

    var error = function error() {
      reject(tx.error || new DOMException('AbortError', 'AbortError'));
      unlisten();
    };

    tx.addEventListener('complete', complete);
    tx.addEventListener('error', error);
    tx.addEventListener('abort', error);
  }); // Cache it for later retrieval.

  transactionDoneMap.set(tx, done);
}

var idbProxyTraps = {
  get: function get(target, prop, receiver) {
    if (target instanceof IDBTransaction) {
      // Special handling for transaction.done.
      if (prop === 'done') return transactionDoneMap.get(target); // Polyfill for objectStoreNames because of Edge.

      if (prop === 'objectStoreNames') {
        return target.objectStoreNames || transactionStoreNamesMap.get(target);
      } // Make tx.store return the only store in the transaction, or undefined if there are many.


      if (prop === 'store') {
        return receiver.objectStoreNames[1] ? undefined : receiver.objectStore(receiver.objectStoreNames[0]);
      }
    } // Else transform whatever we get back.


    return wrap(target[prop]);
  },
  set: function set(target, prop, value) {
    target[prop] = value;
    return true;
  },
  has: function has(target, prop) {
    if (target instanceof IDBTransaction && (prop === 'done' || prop === 'store')) {
      return true;
    }

    return prop in target;
  }
};

function replaceTraps(callback) {
  idbProxyTraps = callback(idbProxyTraps);
}

function wrapFunction(func) {
  // Due to expected object equality (which is enforced by the caching in `wrap`), we
  // only create one new func per func.
  // Edge doesn't support objectStoreNames (booo), so we polyfill it here.
  if (func === IDBDatabase.prototype.transaction && !('objectStoreNames' in IDBTransaction.prototype)) {
    return function (storeNames) {
      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        args[_key - 1] = arguments[_key];
      }

      var tx = func.call.apply(func, [unwrap(this), storeNames].concat(args));
      transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);
      return wrap(tx);
    };
  } // Cursor methods are special, as the behaviour is a little more different to standard IDB. In
  // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the
  // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense
  // with real promises, so each advance methods returns a new promise for the cursor object, or
  // undefined if the end of the cursor has been reached.


  if (getCursorAdvanceMethods().includes(func)) {
    return function () {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }

      // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use
      // the original object.
      func.apply(unwrap(this), args);
      return wrap(cursorRequestMap.get(this));
    };
  }

  return function () {
    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
      args[_key3] = arguments[_key3];
    }

    // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use
    // the original object.
    return wrap(func.apply(unwrap(this), args));
  };
}

function transformCachableValue(value) {
  if (typeof value === 'function') return wrapFunction(value); // This doesn't return, it just creates a 'done' promise for the transaction,
  // which is later returned for transaction.done (see idbObjectHandler).

  if (value instanceof IDBTransaction) cacheDonePromiseForTransaction(value);
  if (instanceOfAny(value, getIdbProxyableTypes())) return new Proxy(value, idbProxyTraps); // Return the same value back if we're not going to transform it.

  return value;
}

function wrap(value) {
  // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because
  // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.
  if (value instanceof IDBRequest) return promisifyRequest(value); // If we've already transformed this value before, reuse the transformed value.
  // This is faster, but it also provides object equality.

  if (transformCache.has(value)) return transformCache.get(value);
  var newValue = transformCachableValue(value); // Not all types are transformed.
  // These may be primitive types, so they can't be WeakMap keys.

  if (newValue !== value) {
    transformCache.set(value, newValue);
    reverseTransformCache.set(newValue, value);
  }

  return newValue;
}

var unwrap = function unwrap(value) {
  return reverseTransformCache.get(value);
};

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }
/**
 * Open a database.
 *
 * @param name Name of the database.
 * @param version Schema version.
 * @param callbacks Additional callbacks.
 */

function openDB(name, version) {
  var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},
      blocked = _ref.blocked,
      upgrade = _ref.upgrade,
      blocking = _ref.blocking,
      terminated = _ref.terminated;

  var request = indexedDB.open(name, version);
  var openPromise = wrap(request);

  if (upgrade) {
    request.addEventListener('upgradeneeded', function (event) {
      upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction));
    });
  }

  if (blocked) request.addEventListener('blocked', function () {
    return blocked();
  });
  openPromise.then(function (db) {
    if (terminated) db.addEventListener('close', function () {
      return terminated();
    });
    if (blocking) db.addEventListener('versionchange', function () {
      return blocking();
    });
  }).catch(function () {});
  return openPromise;
}

var readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];
var writeMethods = ['put', 'add', 'delete', 'clear'];
var cachedMethods = new Map();

function getMethod(target, prop) {
  if (!(target instanceof IDBDatabase && !(prop in target) && typeof prop === 'string')) {
    return;
  }

  if (cachedMethods.get(prop)) return cachedMethods.get(prop);
  var targetFuncName = prop.replace(/FromIndex$/, '');
  var useIndex = prop !== targetFuncName;
  var isWrite = writeMethods.includes(targetFuncName);

  if ( // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.
  !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) || !(isWrite || readMethods.includes(targetFuncName))) {
    return;
  }

  var method = /*#__PURE__*/function () {
    var _ref3 = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(storeName) {
      var _target;

      var tx,
          target,
          _len,
          args,
          _key,
          _args = arguments;

      return regenerator.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(
              tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');
              target = tx.store;

              for (_len = _args.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
                args[_key - 1] = _args[_key];
              }

              if (useIndex) target = target.index(args.shift()); // Must reject if op rejects.
              // If it's a write operation, must reject if tx.done rejects.
              // Must reject with op rejection first.
              // Must resolve with op value.
              // Must handle both promises (no unhandled rejections)

              _context.next = 6;
              return Promise.all([(_target = target)[targetFuncName].apply(_target, args), isWrite && tx.done]);

            case 6:
              return _context.abrupt("return", _context.sent[0]);

            case 7:
            case "end":
              return _context.stop();
          }
        }
      }, _callee, this);
    }));

    return function method(_x) {
      return _ref3.apply(this, arguments);
    };
  }();

  cachedMethods.set(prop, method);
  return method;
}

replaceTraps(function (oldTraps) {
  return _objectSpread(_objectSpread({}, oldTraps), {}, {
    get: function get(target, prop, receiver) {
      return getMethod(target, prop) || oldTraps.get(target, prop, receiver);
    },
    has: function has(target, prop) {
      return !!getMethod(target, prop) || oldTraps.has(target, prop);
    }
  });
});

var _PLATFORM_LOG_STRING, _ERRORS;

function _createForOfIteratorHelper$3(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray$3(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }

function _unsupportedIterableToArray$3(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray$3(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray$3(o, minLen); }

function _arrayLikeToArray$3(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var PlatformLoggerServiceImpl = /*#__PURE__*/function () {
  function PlatformLoggerServiceImpl(container) {
    _classCallCheck(this, PlatformLoggerServiceImpl);

    this.container = container;
  } // In initial implementation, this will be called by installations on
  // auth token refresh, and installations will send this string.


  _createClass(PlatformLoggerServiceImpl, [{
    key: "getPlatformInfoString",
    value: function getPlatformInfoString() {
      var providers = this.container.getProviders(); // Loop through providers and get library/version pairs from any that are
      // version components.

      return providers.map(function (provider) {
        if (isVersionServiceProvider(provider)) {
          var service = provider.getImmediate();
          return "".concat(service.library, "/").concat(service.version);
        } else {
          return null;
        }
      }).filter(function (logString) {
        return logString;
      }).join(' ');
    }
  }]);

  return PlatformLoggerServiceImpl;
}();
/**
 *
 * @param provider check if this provider provides a VersionService
 *
 * NOTE: Using Provider<'app-version'> is a hack to indicate that the provider
 * provides VersionService. The provider is not necessarily a 'app-version'
 * provider.
 */


function isVersionServiceProvider(provider) {
  var component = provider.getComponent();
  return (component === null || component === void 0 ? void 0 : component.type) === "VERSION"
  /* VERSION */
  ;
}

var name$o = "@firebase/app";
var version$1 = "0.7.33";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var logger$5 = new Logger('@firebase/app');
var name$n = "@firebase/app-compat";
var name$m = "@firebase/analytics-compat";
var name$l = "@firebase/analytics";
var name$k = "@firebase/app-check-compat";
var name$j = "@firebase/app-check";
var name$i = "@firebase/auth";
var name$h = "@firebase/auth-compat";
var name$g = "@firebase/database";
var name$f = "@firebase/database-compat";
var name$e = "@firebase/functions";
var name$d = "@firebase/functions-compat";
var name$c = "@firebase/installations";
var name$b = "@firebase/installations-compat";
var name$a = "@firebase/messaging";
var name$9 = "@firebase/messaging-compat";
var name$8 = "@firebase/performance";
var name$7 = "@firebase/performance-compat";
var name$6 = "@firebase/remote-config";
var name$5 = "@firebase/remote-config-compat";
var name$4 = "@firebase/storage";
var name$3 = "@firebase/storage-compat";
var name$2 = "@firebase/firestore";
var name$1 = "@firebase/firestore-compat";
var name$p = "firebase";
var version$2 = "9.10.0";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * The default app name
 *
 * @internal
 */

var DEFAULT_ENTRY_NAME = '[DEFAULT]';
var PLATFORM_LOG_STRING = (_PLATFORM_LOG_STRING = {}, _defineProperty(_PLATFORM_LOG_STRING, name$o, 'fire-core'), _defineProperty(_PLATFORM_LOG_STRING, name$n, 'fire-core-compat'), _defineProperty(_PLATFORM_LOG_STRING, name$l, 'fire-analytics'), _defineProperty(_PLATFORM_LOG_STRING, name$m, 'fire-analytics-compat'), _defineProperty(_PLATFORM_LOG_STRING, name$j, 'fire-app-check'), _defineProperty(_PLATFORM_LOG_STRING, name$k, 'fire-app-check-compat'), _defineProperty(_PLATFORM_LOG_STRING, name$i, 'fire-auth'), _defineProperty(_PLATFORM_LOG_STRING, name$h, 'fire-auth-compat'), _defineProperty(_PLATFORM_LOG_STRING, name$g, 'fire-rtdb'), _defineProperty(_PLATFORM_LOG_STRING, name$f, 'fire-rtdb-compat'), _defineProperty(_PLATFORM_LOG_STRING, name$e, 'fire-fn'), _defineProperty(_PLATFORM_LOG_STRING, name$d, 'fire-fn-compat'), _defineProperty(_PLATFORM_LOG_STRING, name$c, 'fire-iid'), _defineProperty(_PLATFORM_LOG_STRING, name$b, 'fire-iid-compat'), _defineProperty(_PLATFORM_LOG_STRING, name$a, 'fire-fcm'), _defineProperty(_PLATFORM_LOG_STRING, name$9, 'fire-fcm-compat'), _defineProperty(_PLATFORM_LOG_STRING, name$8, 'fire-perf'), _defineProperty(_PLATFORM_LOG_STRING, name$7, 'fire-perf-compat'), _defineProperty(_PLATFORM_LOG_STRING, name$6, 'fire-rc'), _defineProperty(_PLATFORM_LOG_STRING, name$5, 'fire-rc-compat'), _defineProperty(_PLATFORM_LOG_STRING, name$4, 'fire-gcs'), _defineProperty(_PLATFORM_LOG_STRING, name$3, 'fire-gcs-compat'), _defineProperty(_PLATFORM_LOG_STRING, name$2, 'fire-fst'), _defineProperty(_PLATFORM_LOG_STRING, name$1, 'fire-fst-compat'), _defineProperty(_PLATFORM_LOG_STRING, 'fire-js', 'fire-js'), _defineProperty(_PLATFORM_LOG_STRING, name$p, 'fire-js-all'), _PLATFORM_LOG_STRING);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * @internal
 */

var _apps = new Map();
/**
 * Registered components.
 *
 * @internal
 */
// eslint-disable-next-line @typescript-eslint/no-explicit-any


var _components = new Map();
/**
 * @param component - the component being added to this app's container
 *
 * @internal
 */


function _addComponent(app, component) {
  try {
    app.container.addComponent(component);
  } catch (e) {
    logger$5.debug("Component ".concat(component.name, " failed to register with FirebaseApp ").concat(app.name), e);
  }
}
/**
 *
 * @param component - the component to register
 * @returns whether or not the component is registered successfully
 *
 * @internal
 */


function _registerComponent(component) {
  var componentName = component.name;

  if (_components.has(componentName)) {
    logger$5.debug("There were multiple attempts to register component ".concat(componentName, "."));
    return false;
  }

  _components.set(componentName, component); // add the component to existing app instances


  var _iterator = _createForOfIteratorHelper$3(_apps.values()),
      _step;

  try {
    for (_iterator.s(); !(_step = _iterator.n()).done;) {
      var app = _step.value;

      _addComponent(app, component);
    }
  } catch (err) {
    _iterator.e(err);
  } finally {
    _iterator.f();
  }

  return true;
}
/**
 *
 * @param app - FirebaseApp instance
 * @param name - service name
 *
 * @returns the provider for the service with the matching name
 *
 * @internal
 */


function _getProvider(app, name) {
  var heartbeatController = app.container.getProvider('heartbeat').getImmediate({
    optional: true
  });

  if (heartbeatController) {
    void heartbeatController.triggerHeartbeat();
  }

  return app.container.getProvider(name);
}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var ERRORS = (_ERRORS = {}, _defineProperty(_ERRORS, "no-app"
/* NO_APP */
, "No Firebase App '{$appName}' has been created - " + 'call Firebase App.initializeApp()'), _defineProperty(_ERRORS, "bad-app-name"
/* BAD_APP_NAME */
, "Illegal App name: '{$appName}"), _defineProperty(_ERRORS, "duplicate-app"
/* DUPLICATE_APP */
, "Firebase App named '{$appName}' already exists with different options or config"), _defineProperty(_ERRORS, "app-deleted"
/* APP_DELETED */
, "Firebase App named '{$appName}' already deleted"), _defineProperty(_ERRORS, "invalid-app-argument"
/* INVALID_APP_ARGUMENT */
, 'firebase.{$appName}() takes either no argument or a ' + 'Firebase App instance.'), _defineProperty(_ERRORS, "invalid-log-argument"
/* INVALID_LOG_ARGUMENT */
, 'First argument to `onLog` must be null or a function.'), _defineProperty(_ERRORS, "idb-open"
/* IDB_OPEN */
, 'Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.'), _defineProperty(_ERRORS, "idb-get"
/* IDB_GET */
, 'Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.'), _defineProperty(_ERRORS, "idb-set"
/* IDB_WRITE */
, 'Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.'), _defineProperty(_ERRORS, "idb-delete"
/* IDB_DELETE */
, 'Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.'), _ERRORS);
var ERROR_FACTORY = new ErrorFactory('app', 'Firebase', ERRORS);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var FirebaseAppImpl = /*#__PURE__*/function () {
  function FirebaseAppImpl(options, config, container) {
    var _this = this;

    _classCallCheck(this, FirebaseAppImpl);

    this._isDeleted = false;
    this._options = Object.assign({}, options);
    this._config = Object.assign({}, config);
    this._name = config.name;
    this._automaticDataCollectionEnabled = config.automaticDataCollectionEnabled;
    this._container = container;
    this.container.addComponent(new Component('app', function () {
      return _this;
    }, "PUBLIC"
    /* PUBLIC */
    ));
  }

  _createClass(FirebaseAppImpl, [{
    key: "automaticDataCollectionEnabled",
    get: function get() {
      this.checkDestroyed();
      return this._automaticDataCollectionEnabled;
    },
    set: function set(val) {
      this.checkDestroyed();
      this._automaticDataCollectionEnabled = val;
    }
  }, {
    key: "name",
    get: function get() {
      this.checkDestroyed();
      return this._name;
    }
  }, {
    key: "options",
    get: function get() {
      this.checkDestroyed();
      return this._options;
    }
  }, {
    key: "config",
    get: function get() {
      this.checkDestroyed();
      return this._config;
    }
  }, {
    key: "container",
    get: function get() {
      return this._container;
    }
  }, {
    key: "isDeleted",
    get: function get() {
      return this._isDeleted;
    },
    set: function set(val) {
      this._isDeleted = val;
    }
    /**
     * This function will throw an Error if the App has already been deleted -
     * use before performing API actions on the App.
     */

  }, {
    key: "checkDestroyed",
    value: function checkDestroyed() {
      if (this.isDeleted) {
        throw ERROR_FACTORY.create("app-deleted"
        /* APP_DELETED */
        , {
          appName: this._name
        });
      }
    }
  }]);

  return FirebaseAppImpl;
}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * The current SDK version.
 *
 * @public
 */


var SDK_VERSION = version$2;

function initializeApp(options) {
  var rawConfig = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  if (_typeof$1(rawConfig) !== 'object') {
    var _name = rawConfig;
    rawConfig = {
      name: _name
    };
  }

  var config = Object.assign({
    name: DEFAULT_ENTRY_NAME,
    automaticDataCollectionEnabled: false
  }, rawConfig);
  var name = config.name;

  if (typeof name !== 'string' || !name) {
    throw ERROR_FACTORY.create("bad-app-name"
    /* BAD_APP_NAME */
    , {
      appName: String(name)
    });
  }

  var existingApp = _apps.get(name);

  if (existingApp) {
    // return the existing app if options and config deep equal the ones in the existing app.
    if (deepEqual(options, existingApp.options) && deepEqual(config, existingApp.config)) {
      return existingApp;
    } else {
      throw ERROR_FACTORY.create("duplicate-app"
      /* DUPLICATE_APP */
      , {
        appName: name
      });
    }
  }

  var container = new ComponentContainer(name);

  var _iterator2 = _createForOfIteratorHelper$3(_components.values()),
      _step2;

  try {
    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
      var component = _step2.value;
      container.addComponent(component);
    }
  } catch (err) {
    _iterator2.e(err);
  } finally {
    _iterator2.f();
  }

  var newApp = new FirebaseAppImpl(options, config, container);

  _apps.set(name, newApp);

  return newApp;
}
/**
 * Retrieves a {@link @firebase/app#FirebaseApp} instance.
 *
 * When called with no arguments, the default app is returned. When an app name
 * is provided, the app corresponding to that name is returned.
 *
 * An exception is thrown if the app being retrieved has not yet been
 * initialized.
 *
 * @example
 * ```javascript
 * // Return the default app
 * const app = getApp();
 * ```
 *
 * @example
 * ```javascript
 * // Return a named app
 * const otherApp = getApp("otherApp");
 * ```
 *
 * @param name - Optional name of the app to return. If no name is
 *   provided, the default is `"[DEFAULT]"`.
 *
 * @returns The app corresponding to the provided app name.
 *   If no app name is provided, the default app is returned.
 *
 * @public
 */


function getApp() {
  var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_ENTRY_NAME;

  var app = _apps.get(name);

  if (!app) {
    throw ERROR_FACTORY.create("no-app"
    /* NO_APP */
    , {
      appName: name
    });
  }

  return app;
}
/**
 * Renders this app unusable and frees the resources of all associated
 * services.
 *
 * @example
 * ```javascript
 * deleteApp(app)
 *   .then(function() {
 *     console.log("App deleted successfully");
 *   })
 *   .catch(function(error) {
 *     console.log("Error deleting app:", error);
 *   });
 * ```
 *
 * @public
 */


function deleteApp(_x) {
  return _deleteApp.apply(this, arguments);
}
/**
 * Registers a library's name and version for platform logging purposes.
 * @param library - Name of 1p or 3p library (e.g. firestore, angularfire)
 * @param version - Current version of that library.
 * @param variant - Bundle variant, e.g., node, rn, etc.
 *
 * @public
 */


function _deleteApp() {
  _deleteApp = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee7(app) {
    var name;
    return regenerator.wrap(function _callee7$(_context7) {
      while (1) {
        switch (_context7.prev = _context7.next) {
          case 0:
            name = app.name;

            if (!_apps.has(name)) {
              _context7.next = 6;
              break;
            }

            _apps.delete(name);

            _context7.next = 5;
            return Promise.all(app.container.getProviders().map(function (provider) {
              return provider.delete();
            }));

          case 5:
            app.isDeleted = true;

          case 6:
          case "end":
            return _context7.stop();
        }
      }
    }, _callee7);
  }));
  return _deleteApp.apply(this, arguments);
}

function registerVersion(libraryKeyOrName, version, variant) {
  var _a; // TODO: We can use this check to whitelist strings when/if we set up
  // a good whitelist system.


  var library = (_a = PLATFORM_LOG_STRING[libraryKeyOrName]) !== null && _a !== void 0 ? _a : libraryKeyOrName;

  if (variant) {
    library += "-".concat(variant);
  }

  var libraryMismatch = library.match(/\s|\//);
  var versionMismatch = version.match(/\s|\//);

  if (libraryMismatch || versionMismatch) {
    var warning = ["Unable to register library \"".concat(library, "\" with version \"").concat(version, "\":")];

    if (libraryMismatch) {
      warning.push("library name \"".concat(library, "\" contains illegal characters (whitespace or \"/\")"));
    }

    if (libraryMismatch && versionMismatch) {
      warning.push('and');
    }

    if (versionMismatch) {
      warning.push("version name \"".concat(version, "\" contains illegal characters (whitespace or \"/\")"));
    }

    logger$5.warn(warning.join(' '));
    return;
  }

  _registerComponent(new Component("".concat(library, "-version"), function () {
    return {
      library: library,
      version: version
    };
  }, "VERSION"
  /* VERSION */
  ));
}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var DB_NAME = 'firebase-heartbeat-database';
var DB_VERSION = 1;
var STORE_NAME = 'firebase-heartbeat-store';
var dbPromise = null;

function getDbPromise() {
  if (!dbPromise) {
    dbPromise = openDB(DB_NAME, DB_VERSION, {
      upgrade: function upgrade(db, oldVersion) {
        // We don't use 'break' in this switch statement, the fall-through
        // behavior is what we want, because if there are multiple versions between
        // the old version and the current version, we want ALL the migrations
        // that correspond to those versions to run, not only the last one.
        // eslint-disable-next-line default-case
        switch (oldVersion) {
          case 0:
            db.createObjectStore(STORE_NAME);
        }
      }
    }).catch(function (e) {
      throw ERROR_FACTORY.create("idb-open"
      /* IDB_OPEN */
      , {
        originalErrorMessage: e.message
      });
    });
  }

  return dbPromise;
}

function readHeartbeatsFromIndexedDB(_x2) {
  return _readHeartbeatsFromIndexedDB.apply(this, arguments);
}

function _readHeartbeatsFromIndexedDB() {
  _readHeartbeatsFromIndexedDB = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee8(app) {
    var _a, db, idbGetError;

    return regenerator.wrap(function _callee8$(_context8) {
      while (1) {
        switch (_context8.prev = _context8.next) {
          case 0:
            _context8.prev = 0;
            _context8.next = 3;
            return getDbPromise();

          case 3:
            db = _context8.sent;
            return _context8.abrupt("return", db.transaction(STORE_NAME).objectStore(STORE_NAME).get(computeKey(app)));

          case 7:
            _context8.prev = 7;
            _context8.t0 = _context8["catch"](0);

            if (_context8.t0 instanceof FirebaseError) {
              logger$5.warn(_context8.t0.message);
            } else {
              idbGetError = ERROR_FACTORY.create("idb-get"
              /* IDB_GET */
              , {
                originalErrorMessage: (_a = _context8.t0) === null || _a === void 0 ? void 0 : _a.message
              });
              logger$5.warn(idbGetError.message);
            }

          case 10:
          case "end":
            return _context8.stop();
        }
      }
    }, _callee8, null, [[0, 7]]);
  }));
  return _readHeartbeatsFromIndexedDB.apply(this, arguments);
}

function writeHeartbeatsToIndexedDB(_x3, _x4) {
  return _writeHeartbeatsToIndexedDB.apply(this, arguments);
}

function _writeHeartbeatsToIndexedDB() {
  _writeHeartbeatsToIndexedDB = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee9(app, heartbeatObject) {
    var _a, db, tx, objectStore, idbGetError;

    return regenerator.wrap(function _callee9$(_context9) {
      while (1) {
        switch (_context9.prev = _context9.next) {
          case 0:
            _context9.prev = 0;
            _context9.next = 3;
            return getDbPromise();

          case 3:
            db = _context9.sent;
            tx = db.transaction(STORE_NAME, 'readwrite');
            objectStore = tx.objectStore(STORE_NAME);
            _context9.next = 8;
            return objectStore.put(heartbeatObject, computeKey(app));

          case 8:
            return _context9.abrupt("return", tx.done);

          case 11:
            _context9.prev = 11;
            _context9.t0 = _context9["catch"](0);

            if (_context9.t0 instanceof FirebaseError) {
              logger$5.warn(_context9.t0.message);
            } else {
              idbGetError = ERROR_FACTORY.create("idb-set"
              /* IDB_WRITE */
              , {
                originalErrorMessage: (_a = _context9.t0) === null || _a === void 0 ? void 0 : _a.message
              });
              logger$5.warn(idbGetError.message);
            }

          case 14:
          case "end":
            return _context9.stop();
        }
      }
    }, _callee9, null, [[0, 11]]);
  }));
  return _writeHeartbeatsToIndexedDB.apply(this, arguments);
}

function computeKey(app) {
  return "".concat(app.name, "!").concat(app.options.appId);
}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var MAX_HEADER_BYTES = 1024; // 30 days

var STORED_HEARTBEAT_RETENTION_MAX_MILLIS = 30 * 24 * 60 * 60 * 1000;

var HeartbeatServiceImpl = /*#__PURE__*/function () {
  function HeartbeatServiceImpl(container) {
    var _this2 = this;

    _classCallCheck(this, HeartbeatServiceImpl);

    this.container = container;
    /**
     * In-memory cache for heartbeats, used by getHeartbeatsHeader() to generate
     * the header string.
     * Stores one record per date. This will be consolidated into the standard
     * format of one record per user agent string before being sent as a header.
     * Populated from indexedDB when the controller is instantiated and should
     * be kept in sync with indexedDB.
     * Leave public for easier testing.
     */

    this._heartbeatsCache = null;
    var app = this.container.getProvider('app').getImmediate();
    this._storage = new HeartbeatStorageImpl(app);
    this._heartbeatsCachePromise = this._storage.read().then(function (result) {
      _this2._heartbeatsCache = result;
      return result;
    });
  }
  /**
   * Called to report a heartbeat. The function will generate
   * a HeartbeatsByUserAgent object, update heartbeatsCache, and persist it
   * to IndexedDB.
   * Note that we only store one heartbeat per day. So if a heartbeat for today is
   * already logged, subsequent calls to this function in the same day will be ignored.
   */


  _createClass(HeartbeatServiceImpl, [{
    key: "triggerHeartbeat",
    value: function () {
      var _triggerHeartbeat = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee() {
        var platformLogger, agent, date;
        return regenerator.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                platformLogger = this.container.getProvider('platform-logger').getImmediate(); // This is the "Firebase user agent" string from the platform logger
                // service, not the browser user agent.

                agent = platformLogger.getPlatformInfoString();
                date = getUTCDateString();

                if (!(this._heartbeatsCache === null)) {
                  _context.next = 7;
                  break;
                }

                _context.next = 6;
                return this._heartbeatsCachePromise;

              case 6:
                this._heartbeatsCache = _context.sent;

              case 7:
                if (!(this._heartbeatsCache.lastSentHeartbeatDate === date || this._heartbeatsCache.heartbeats.some(function (singleDateHeartbeat) {
                  return singleDateHeartbeat.date === date;
                }))) {
                  _context.next = 11;
                  break;
                }

                return _context.abrupt("return");

              case 11:
                // There is no entry for this date. Create one.
                this._heartbeatsCache.heartbeats.push({
                  date: date,
                  agent: agent
                });

              case 12:
                // Remove entries older than 30 days.
                this._heartbeatsCache.heartbeats = this._heartbeatsCache.heartbeats.filter(function (singleDateHeartbeat) {
                  var hbTimestamp = new Date(singleDateHeartbeat.date).valueOf();
                  var now = Date.now();
                  return now - hbTimestamp <= STORED_HEARTBEAT_RETENTION_MAX_MILLIS;
                });
                return _context.abrupt("return", this._storage.overwrite(this._heartbeatsCache));

              case 14:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function triggerHeartbeat() {
        return _triggerHeartbeat.apply(this, arguments);
      }

      return triggerHeartbeat;
    }()
    /**
     * Returns a base64 encoded string which can be attached to the heartbeat-specific header directly.
     * It also clears all heartbeats from memory as well as in IndexedDB.
     *
     * NOTE: Consuming product SDKs should not send the header if this method
     * returns an empty string.
     */

  }, {
    key: "getHeartbeatsHeader",
    value: function () {
      var _getHeartbeatsHeader = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee2() {
        var date, _extractHeartbeatsFor, heartbeatsToSend, unsentEntries, headerString;

        return regenerator.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                if (!(this._heartbeatsCache === null)) {
                  _context2.next = 3;
                  break;
                }

                _context2.next = 3;
                return this._heartbeatsCachePromise;

              case 3:
                if (!(this._heartbeatsCache === null || this._heartbeatsCache.heartbeats.length === 0)) {
                  _context2.next = 5;
                  break;
                }

                return _context2.abrupt("return", '');

              case 5:
                date = getUTCDateString(); // Extract as many heartbeats from the cache as will fit under the size limit.

                _extractHeartbeatsFor = extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats), heartbeatsToSend = _extractHeartbeatsFor.heartbeatsToSend, unsentEntries = _extractHeartbeatsFor.unsentEntries;
                headerString = base64urlEncodeWithoutPadding(JSON.stringify({
                  version: 2,
                  heartbeats: heartbeatsToSend
                })); // Store last sent date to prevent another being logged/sent for the same day.

                this._heartbeatsCache.lastSentHeartbeatDate = date;

                if (!(unsentEntries.length > 0)) {
                  _context2.next = 15;
                  break;
                }

                // Store any unsent entries if they exist.
                this._heartbeatsCache.heartbeats = unsentEntries; // This seems more likely than emptying the array (below) to lead to some odd state
                // since the cache isn't empty and this will be called again on the next request,
                // and is probably safest if we await it.

                _context2.next = 13;
                return this._storage.overwrite(this._heartbeatsCache);

              case 13:
                _context2.next = 17;
                break;

              case 15:
                this._heartbeatsCache.heartbeats = []; // Do not wait for this, to reduce latency.

                void this._storage.overwrite(this._heartbeatsCache);

              case 17:
                return _context2.abrupt("return", headerString);

              case 18:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, this);
      }));

      function getHeartbeatsHeader() {
        return _getHeartbeatsHeader.apply(this, arguments);
      }

      return getHeartbeatsHeader;
    }()
  }]);

  return HeartbeatServiceImpl;
}();

function getUTCDateString() {
  var today = new Date(); // Returns date format 'YYYY-MM-DD'

  return today.toISOString().substring(0, 10);
}

function extractHeartbeatsForHeader(heartbeatsCache) {
  var maxSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : MAX_HEADER_BYTES;
  // Heartbeats grouped by user agent in the standard format to be sent in
  // the header.
  var heartbeatsToSend = []; // Single date format heartbeats that are not sent.

  var unsentEntries = heartbeatsCache.slice();

  var _iterator3 = _createForOfIteratorHelper$3(heartbeatsCache),
      _step3;

  try {
    var _loop = function _loop() {
      var singleDateHeartbeat = _step3.value;
      // Look for an existing entry with the same user agent.
      var heartbeatEntry = heartbeatsToSend.find(function (hb) {
        return hb.agent === singleDateHeartbeat.agent;
      });

      if (!heartbeatEntry) {
        // If no entry for this user agent exists, create one.
        heartbeatsToSend.push({
          agent: singleDateHeartbeat.agent,
          dates: [singleDateHeartbeat.date]
        });

        if (countBytes(heartbeatsToSend) > maxSize) {
          // If the header would exceed max size, remove the added heartbeat
          // entry and stop adding to the header.
          heartbeatsToSend.pop();
          return "break";
        }
      } else {
        heartbeatEntry.dates.push(singleDateHeartbeat.date); // If the header would exceed max size, remove the added date
        // and stop adding to the header.

        if (countBytes(heartbeatsToSend) > maxSize) {
          heartbeatEntry.dates.pop();
          return "break";
        }
      } // Pop unsent entry from queue. (Skipped if adding the entry exceeded
      // quota and the loop breaks early.)


      unsentEntries = unsentEntries.slice(1);
    };

    for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
      var _ret = _loop();

      if (_ret === "break") break;
    }
  } catch (err) {
    _iterator3.e(err);
  } finally {
    _iterator3.f();
  }

  return {
    heartbeatsToSend: heartbeatsToSend,
    unsentEntries: unsentEntries
  };
}

var HeartbeatStorageImpl = /*#__PURE__*/function () {
  function HeartbeatStorageImpl(app) {
    _classCallCheck(this, HeartbeatStorageImpl);

    this.app = app;
    this._canUseIndexedDBPromise = this.runIndexedDBEnvironmentCheck();
  }

  _createClass(HeartbeatStorageImpl, [{
    key: "runIndexedDBEnvironmentCheck",
    value: function () {
      var _runIndexedDBEnvironmentCheck = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee3() {
        return regenerator.wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                if (isIndexedDBAvailable()) {
                  _context3.next = 4;
                  break;
                }

                return _context3.abrupt("return", false);

              case 4:
                return _context3.abrupt("return", validateIndexedDBOpenable().then(function () {
                  return true;
                }).catch(function () {
                  return false;
                }));

              case 5:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3);
      }));

      function runIndexedDBEnvironmentCheck() {
        return _runIndexedDBEnvironmentCheck.apply(this, arguments);
      }

      return runIndexedDBEnvironmentCheck;
    }()
    /**
     * Read all heartbeats.
     */

  }, {
    key: "read",
    value: function () {
      var _read = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee4() {
        var canUseIndexedDB, idbHeartbeatObject;
        return regenerator.wrap(function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                _context4.next = 2;
                return this._canUseIndexedDBPromise;

              case 2:
                canUseIndexedDB = _context4.sent;

                if (canUseIndexedDB) {
                  _context4.next = 7;
                  break;
                }

                return _context4.abrupt("return", {
                  heartbeats: []
                });

              case 7:
                _context4.next = 9;
                return readHeartbeatsFromIndexedDB(this.app);

              case 9:
                idbHeartbeatObject = _context4.sent;
                return _context4.abrupt("return", idbHeartbeatObject || {
                  heartbeats: []
                });

              case 11:
              case "end":
                return _context4.stop();
            }
          }
        }, _callee4, this);
      }));

      function read() {
        return _read.apply(this, arguments);
      }

      return read;
    }() // overwrite the storage with the provided heartbeats

  }, {
    key: "overwrite",
    value: function () {
      var _overwrite = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee5(heartbeatsObject) {
        var _a, canUseIndexedDB, existingHeartbeatsObject;

        return regenerator.wrap(function _callee5$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                _context5.next = 2;
                return this._canUseIndexedDBPromise;

              case 2:
                canUseIndexedDB = _context5.sent;

                if (canUseIndexedDB) {
                  _context5.next = 7;
                  break;
                }

                return _context5.abrupt("return");

              case 7:
                _context5.next = 9;
                return this.read();

              case 9:
                existingHeartbeatsObject = _context5.sent;
                return _context5.abrupt("return", writeHeartbeatsToIndexedDB(this.app, {
                  lastSentHeartbeatDate: (_a = heartbeatsObject.lastSentHeartbeatDate) !== null && _a !== void 0 ? _a : existingHeartbeatsObject.lastSentHeartbeatDate,
                  heartbeats: heartbeatsObject.heartbeats
                }));

              case 11:
              case "end":
                return _context5.stop();
            }
          }
        }, _callee5, this);
      }));

      function overwrite(_x5) {
        return _overwrite.apply(this, arguments);
      }

      return overwrite;
    }() // add heartbeats

  }, {
    key: "add",
    value: function () {
      var _add = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee6(heartbeatsObject) {
        var _a, canUseIndexedDB, existingHeartbeatsObject;

        return regenerator.wrap(function _callee6$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                _context6.next = 2;
                return this._canUseIndexedDBPromise;

              case 2:
                canUseIndexedDB = _context6.sent;

                if (canUseIndexedDB) {
                  _context6.next = 7;
                  break;
                }

                return _context6.abrupt("return");

              case 7:
                _context6.next = 9;
                return this.read();

              case 9:
                existingHeartbeatsObject = _context6.sent;
                return _context6.abrupt("return", writeHeartbeatsToIndexedDB(this.app, {
                  lastSentHeartbeatDate: (_a = heartbeatsObject.lastSentHeartbeatDate) !== null && _a !== void 0 ? _a : existingHeartbeatsObject.lastSentHeartbeatDate,
                  heartbeats: [].concat(_toConsumableArray(existingHeartbeatsObject.heartbeats), _toConsumableArray(heartbeatsObject.heartbeats))
                }));

              case 11:
              case "end":
                return _context6.stop();
            }
          }
        }, _callee6, this);
      }));

      function add(_x6) {
        return _add.apply(this, arguments);
      }

      return add;
    }()
  }]);

  return HeartbeatStorageImpl;
}();
/**
 * Calculate bytes of a HeartbeatsByUserAgent array after being wrapped
 * in a platform logging header JSON object, stringified, and converted
 * to base 64.
 */


function countBytes(heartbeatsCache) {
  // base64 has a restricted set of characters, all of which should be 1 byte.
  return base64urlEncodeWithoutPadding( // heartbeatsCache wrapper properties
  JSON.stringify({
    version: 2,
    heartbeats: heartbeatsCache
  })).length;
}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


function registerCoreComponents(variant) {
  _registerComponent(new Component('platform-logger', function (container) {
    return new PlatformLoggerServiceImpl(container);
  }, "PRIVATE"
  /* PRIVATE */
  ));

  _registerComponent(new Component('heartbeat', function (container) {
    return new HeartbeatServiceImpl(container);
  }, "PRIVATE"
  /* PRIVATE */
  )); // Register `app` package.


  registerVersion(name$o, version$1, variant); // BUILD_TARGET will be replaced by values like esm5, esm2017, cjs5, etc during the compilation

  registerVersion(name$o, version$1, 'esm2017'); // Register platform SDK identifier (no version).

  registerVersion('fire-js', '');
}
/**
 * Firebase App
 *
 * @remarks This package coordinates the communication between the different Firebase components
 * @packageDocumentation
 */


registerCoreComponents('');

var name = "firebase";
var version = "9.10.0";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

registerVersion(name, version, 'app');

function _superPropBase(object, property) {
  while (!Object.prototype.hasOwnProperty.call(object, property)) {
    object = _getPrototypeOf(object);
    if (object === null) break;
  }

  return object;
}

function _get() {
  if (typeof Reflect !== "undefined" && Reflect.get) {
    _get = Reflect.get.bind();
  } else {
    _get = function _get(target, property, receiver) {
      var base = _superPropBase(target, property);
      if (!base) return;
      var desc = Object.getOwnPropertyDescriptor(base, property);

      if (desc.get) {
        return desc.get.call(arguments.length < 3 ? target : receiver);
      }

      return desc.value;
    };
  }

  return _get.apply(this, arguments);
}

if (typeof global$1.setTimeout === 'function') ;

if (typeof global$1.clearTimeout === 'function') ;

var performance = global$1.performance || {};

performance.now || performance.mozNow || performance.msNow || performance.oNow || performance.webkitNow || function () {
  return new Date().getTime();
}; // generate timestamp or delta

function _createForOfIteratorHelper$2(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray$2(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }

function _unsupportedIterableToArray$2(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray$2(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray$2(o, minLen); }

function _arrayLikeToArray$2(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _createSuper$2(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct$2(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _isNativeReflectConstruct$2() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }
var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global$1 !== 'undefined' ? global$1 : typeof self !== 'undefined' ? self : {};
/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/

var k$2,
    goog = goog || {},
    l$1 = commonjsGlobal || self;

function aa() {}

function ba(a) {
  var b = _typeof$1(a);

  b = "object" != b ? b : a ? Array.isArray(a) ? "array" : b : "null";
  return "array" == b || "object" == b && "number" == typeof a.length;
}

function p$1(a) {
  var b = _typeof$1(a);

  return "object" == b && null != a || "function" == b;
}

function ca(a) {
  return Object.prototype.hasOwnProperty.call(a, da) && a[da] || (a[da] = ++ea);
}

var da = "closure_uid_" + (1E9 * Math.random() >>> 0),
    ea = 0;

function fa$1(a, b, c) {
  return a.call.apply(a.bind, arguments);
}

function ha$1(a, b, c) {
  if (!a) throw Error();

  if (2 < arguments.length) {
    var d = Array.prototype.slice.call(arguments, 2);
    return function () {
      var e = Array.prototype.slice.call(arguments);
      Array.prototype.unshift.apply(e, d);
      return a.apply(b, e);
    };
  }

  return function () {
    return a.apply(b, arguments);
  };
}

function q$2(a, b, c) {
  Function.prototype.bind && -1 != Function.prototype.bind.toString().indexOf("native code") ? q$2 = fa$1 : q$2 = ha$1;
  return q$2.apply(null, arguments);
}

function ia(a, b) {
  var c = Array.prototype.slice.call(arguments, 1);
  return function () {
    var d = c.slice();
    d.push.apply(d, arguments);
    return a.apply(this, d);
  };
}

function t(a, b) {
  function c() {}

  c.prototype = b.prototype;
  a.X = b.prototype;
  a.prototype = new c();
  a.prototype.constructor = a;

  a.Vb = function (d, e, f) {
    for (var h = Array(arguments.length - 2), n = 2; n < arguments.length; n++) {
      h[n - 2] = arguments[n];
    }

    return b.prototype[e].apply(d, h);
  };
}

function v$2() {
  this.s = this.s;
  this.o = this.o;
}

var ja = 0;
v$2.prototype.s = !1;

v$2.prototype.na = function () {
  if (!this.s && (this.s = !0, this.M(), 0 != ja)) {
    ca(this);
  }
};

v$2.prototype.M = function () {
  if (this.o) for (; this.o.length;) {
    this.o.shift()();
  }
};

var la = Array.prototype.indexOf ? function (a, b) {
  return Array.prototype.indexOf.call(a, b, void 0);
} : function (a, b) {
  if ("string" === typeof a) return "string" !== typeof b || 1 != b.length ? -1 : a.indexOf(b, 0);

  for (var c = 0; c < a.length; c++) {
    if (c in a && a[c] === b) return c;
  }

  return -1;
};

function ma(a) {
  var b = a.length;

  if (0 < b) {
    var c = Array(b);

    for (var d = 0; d < b; d++) {
      c[d] = a[d];
    }

    return c;
  }

  return [];
}

function na(a, b) {
  for (var c = 1; c < arguments.length; c++) {
    var d = arguments[c];

    if (ba(d)) {
      var e = a.length || 0,
          f = d.length || 0;
      a.length = e + f;

      for (var h = 0; h < f; h++) {
        a[e + h] = d[h];
      }
    } else a.push(d);
  }
}

function w(a, b) {
  this.type = a;
  this.g = this.target = b;
  this.defaultPrevented = !1;
}

w.prototype.h = function () {
  this.defaultPrevented = !0;
};

var oa = function () {
  if (!l$1.addEventListener || !Object.defineProperty) return !1;
  var a = !1,
      b = Object.defineProperty({}, "passive", {
    get: function get() {
      a = !0;
    }
  });

  try {
    l$1.addEventListener("test", aa, b), l$1.removeEventListener("test", aa, b);
  } catch (c) {}

  return a;
}();

function pa$1(a) {
  return /^[\s\xa0]*$/.test(a);
}

var qa = String.prototype.trim ? function (a) {
  return a.trim();
} : function (a) {
  return /^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1];
};

function ra(a, b) {
  return a < b ? -1 : a > b ? 1 : 0;
}

function sa() {
  var a = l$1.navigator;
  return a && (a = a.userAgent) ? a : "";
}

function x$1(a) {
  return -1 != sa().indexOf(a);
}

function ta(a) {
  ta[" "](a);
  return a;
}

ta[" "] = aa;

function ua(a) {
  var b = va;
  return Object.prototype.hasOwnProperty.call(b, 9) ? b[9] : b[9] = a(9);
}

var wa = x$1("Opera"),
    y$1 = x$1("Trident") || x$1("MSIE"),
    xa = x$1("Edge"),
    ya$1 = xa || y$1,
    za = x$1("Gecko") && !(-1 != sa().toLowerCase().indexOf("webkit") && !x$1("Edge")) && !(x$1("Trident") || x$1("MSIE")) && !x$1("Edge"),
    Aa = -1 != sa().toLowerCase().indexOf("webkit") && !x$1("Edge");

function Ba() {
  var a = l$1.document;
  return a ? a.documentMode : void 0;
}

var Ea;

a: {
  var Fa$1 = "",
      Ga = function () {
    var a = sa();
    if (za) return /rv:([^\);]+)(\)|;)/.exec(a);
    if (xa) return /Edge\/([\d\.]+)/.exec(a);
    if (y$1) return /\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);
    if (Aa) return /WebKit\/(\S+)/.exec(a);
    if (wa) return /(?:Version)[ \/]?(\S+)/.exec(a);
  }();

  Ga && (Fa$1 = Ga ? Ga[1] : "");

  if (y$1) {
    var Ha = Ba();

    if (null != Ha && Ha > parseFloat(Fa$1)) {
      Ea = String(Ha);
      break a;
    }
  }

  Ea = Fa$1;
}

var va = {};

function Ia() {
  return ua(function () {
    var a = 0;
    var b = qa(String(Ea)).split("."),
        c = qa("9").split("."),
        d = Math.max(b.length, c.length);

    for (var h = 0; 0 == a && h < d; h++) {
      var e = b[h] || "",
          f = c[h] || "";

      do {
        e = /(\d*)(\D*)(.*)/.exec(e) || ["", "", "", ""];
        f = /(\d*)(\D*)(.*)/.exec(f) || ["", "", "", ""];
        if (0 == e[0].length && 0 == f[0].length) break;
        a = ra(0 == e[1].length ? 0 : parseInt(e[1], 10), 0 == f[1].length ? 0 : parseInt(f[1], 10)) || ra(0 == e[2].length, 0 == f[2].length) || ra(e[2], f[2]);
        e = e[3];
        f = f[3];
      } while (0 == a);
    }

    return 0 <= a;
  });
}

if (l$1.document && y$1) {
  Ba();
}

function z$2(a, b) {
  w.call(this, a ? a.type : "");
  this.relatedTarget = this.g = this.target = null;
  this.button = this.screenY = this.screenX = this.clientY = this.clientX = 0;
  this.key = "";
  this.metaKey = this.shiftKey = this.altKey = this.ctrlKey = !1;
  this.state = null;
  this.pointerId = 0;
  this.pointerType = "";
  this.i = null;

  if (a) {
    var c = this.type = a.type,
        d = a.changedTouches && a.changedTouches.length ? a.changedTouches[0] : null;
    this.target = a.target || a.srcElement;
    this.g = b;

    if (b = a.relatedTarget) {
      if (za) {
        a: {
          try {
            ta(b.nodeName);
            var e = !0;
            break a;
          } catch (f) {}

          e = !1;
        }

        e || (b = null);
      }
    } else "mouseover" == c ? b = a.fromElement : "mouseout" == c && (b = a.toElement);

    this.relatedTarget = b;
    d ? (this.clientX = void 0 !== d.clientX ? d.clientX : d.pageX, this.clientY = void 0 !== d.clientY ? d.clientY : d.pageY, this.screenX = d.screenX || 0, this.screenY = d.screenY || 0) : (this.clientX = void 0 !== a.clientX ? a.clientX : a.pageX, this.clientY = void 0 !== a.clientY ? a.clientY : a.pageY, this.screenX = a.screenX || 0, this.screenY = a.screenY || 0);
    this.button = a.button;
    this.key = a.key || "";
    this.ctrlKey = a.ctrlKey;
    this.altKey = a.altKey;
    this.shiftKey = a.shiftKey;
    this.metaKey = a.metaKey;
    this.pointerId = a.pointerId || 0;
    this.pointerType = "string" === typeof a.pointerType ? a.pointerType : Ma[a.pointerType] || "";
    this.state = a.state;
    this.i = a;
    a.defaultPrevented && z$2.X.h.call(this);
  }
}

t(z$2, w);
var Ma = {
  2: "touch",
  3: "pen",
  4: "mouse"
};

z$2.prototype.h = function () {
  z$2.X.h.call(this);
  var a = this.i;
  a.preventDefault ? a.preventDefault() : a.returnValue = !1;
};

var A$1 = "closure_listenable_" + (1E6 * Math.random() | 0);
var Na$1 = 0;

function Oa(a, b, c, d, e) {
  this.listener = a;
  this.proxy = null;
  this.src = b;
  this.type = c;
  this.capture = !!d;
  this.ha = e;
  this.key = ++Na$1;
  this.ba = this.ea = !1;
}

function Pa(a) {
  a.ba = !0;
  a.listener = null;
  a.proxy = null;
  a.src = null;
  a.ha = null;
}

function Qa(a, b, c) {
  for (var d in a) {
    b.call(c, a[d], d, a);
  }
}

function Ra(a) {
  var b = {};

  for (var c in a) {
    b[c] = a[c];
  }

  return b;
}

var Sa$1 = "constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");

function Ta(a, b) {
  var c, d;

  for (var e = 1; e < arguments.length; e++) {
    d = arguments[e];

    for (c in d) {
      a[c] = d[c];
    }

    for (var f = 0; f < Sa$1.length; f++) {
      c = Sa$1[f], Object.prototype.hasOwnProperty.call(d, c) && (a[c] = d[c]);
    }
  }
}

function Ua(a) {
  this.src = a;
  this.g = {};
  this.h = 0;
}

Ua.prototype.add = function (a, b, c, d, e) {
  var f = a.toString();
  a = this.g[f];
  a || (a = this.g[f] = [], this.h++);
  var h = Va(a, b, d, e);
  -1 < h ? (b = a[h], c || (b.ea = !1)) : (b = new Oa(b, this.src, f, !!d, e), b.ea = c, a.push(b));
  return b;
};

function Wa(a, b) {
  var c = b.type;

  if (c in a.g) {
    var d = a.g[c],
        e = la(d, b),
        f;
    (f = 0 <= e) && Array.prototype.splice.call(d, e, 1);
    f && (Pa(b), 0 == a.g[c].length && (delete a.g[c], a.h--));
  }
}

function Va(a, b, c, d) {
  for (var e = 0; e < a.length; ++e) {
    var f = a[e];
    if (!f.ba && f.listener == b && f.capture == !!c && f.ha == d) return e;
  }

  return -1;
}

var Xa = "closure_lm_" + (1E6 * Math.random() | 0),
    Ya$1 = {};

function $a(a, b, c, d, e) {
  if (d && d.once) return ab(a, b, c, d, e);

  if (Array.isArray(b)) {
    for (var f = 0; f < b.length; f++) {
      $a(a, b[f], c, d, e);
    }

    return null;
  }

  c = bb(c);
  return a && a[A$1] ? a.N(b, c, p$1(d) ? !!d.capture : !!d, e) : cb(a, b, c, !1, d, e);
}

function cb(a, b, c, d, e, f) {
  if (!b) throw Error("Invalid event type");
  var h = p$1(e) ? !!e.capture : !!e,
      n = db$1(a);
  n || (a[Xa] = n = new Ua(a));
  c = n.add(b, c, d, h, f);
  if (c.proxy) return c;
  d = eb();
  c.proxy = d;
  d.src = a;
  d.listener = c;
  if (a.addEventListener) oa || (e = h), void 0 === e && (e = !1), a.addEventListener(b.toString(), d, e);else if (a.attachEvent) a.attachEvent(fb(b.toString()), d);else if (a.addListener && a.removeListener) a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");
  return c;
}

function eb() {
  function a(c) {
    return b.call(a.src, a.listener, c);
  }

  var b = gb;
  return a;
}

function ab(a, b, c, d, e) {
  if (Array.isArray(b)) {
    for (var f = 0; f < b.length; f++) {
      ab(a, b[f], c, d, e);
    }

    return null;
  }

  c = bb(c);
  return a && a[A$1] ? a.O(b, c, p$1(d) ? !!d.capture : !!d, e) : cb(a, b, c, !0, d, e);
}

function hb(a, b, c, d, e) {
  if (Array.isArray(b)) for (var f = 0; f < b.length; f++) {
    hb(a, b[f], c, d, e);
  } else (d = p$1(d) ? !!d.capture : !!d, c = bb(c), a && a[A$1]) ? (a = a.i, b = String(b).toString(), b in a.g && (f = a.g[b], c = Va(f, c, d, e), -1 < c && (Pa(f[c]), Array.prototype.splice.call(f, c, 1), 0 == f.length && (delete a.g[b], a.h--)))) : a && (a = db$1(a)) && (b = a.g[b.toString()], a = -1, b && (a = Va(b, c, d, e)), (c = -1 < a ? b[a] : null) && ib(c));
}

function ib(a) {
  if ("number" !== typeof a && a && !a.ba) {
    var b = a.src;
    if (b && b[A$1]) Wa(b.i, a);else {
      var c = a.type,
          d = a.proxy;
      b.removeEventListener ? b.removeEventListener(c, d, a.capture) : b.detachEvent ? b.detachEvent(fb(c), d) : b.addListener && b.removeListener && b.removeListener(d);
      (c = db$1(b)) ? (Wa(c, a), 0 == c.h && (c.src = null, b[Xa] = null)) : Pa(a);
    }
  }
}

function fb(a) {
  return a in Ya$1 ? Ya$1[a] : Ya$1[a] = "on" + a;
}

function gb(a, b) {
  if (a.ba) a = !0;else {
    b = new z$2(b, this);
    var c = a.listener,
        d = a.ha || a.src;
    a.ea && ib(a);
    a = c.call(d, b);
  }
  return a;
}

function db$1(a) {
  a = a[Xa];
  return a instanceof Ua ? a : null;
}

var jb = "__closure_events_fn_" + (1E9 * Math.random() >>> 0);

function bb(a) {
  if ("function" === typeof a) return a;
  a[jb] || (a[jb] = function (b) {
    return a.handleEvent(b);
  });
  return a[jb];
}

function B$1() {
  v$2.call(this);
  this.i = new Ua(this);
  this.P = this;
  this.I = null;
}

t(B$1, v$2);
B$1.prototype[A$1] = !0;

B$1.prototype.removeEventListener = function (a, b, c, d) {
  hb(this, a, b, c, d);
};

function C$1(a, b) {
  var c,
      d = a.I;
  if (d) for (c = []; d; d = d.I) {
    c.push(d);
  }
  a = a.P;
  d = b.type || b;
  if ("string" === typeof b) b = new w(b, a);else if (b instanceof w) b.target = b.target || a;else {
    var e = b;
    b = new w(d, a);
    Ta(b, e);
  }
  e = !0;
  if (c) for (var f = c.length - 1; 0 <= f; f--) {
    var h = b.g = c[f];
    e = kb(h, d, !0, b) && e;
  }
  h = b.g = a;
  e = kb(h, d, !0, b) && e;
  e = kb(h, d, !1, b) && e;
  if (c) for (f = 0; f < c.length; f++) {
    h = b.g = c[f], e = kb(h, d, !1, b) && e;
  }
}

B$1.prototype.M = function () {
  B$1.X.M.call(this);

  if (this.i) {
    var a = this.i,
        c;

    for (c in a.g) {
      for (var d = a.g[c], e = 0; e < d.length; e++) {
        Pa(d[e]);
      }

      delete a.g[c];
      a.h--;
    }
  }

  this.I = null;
};

B$1.prototype.N = function (a, b, c, d) {
  return this.i.add(String(a), b, !1, c, d);
};

B$1.prototype.O = function (a, b, c, d) {
  return this.i.add(String(a), b, !0, c, d);
};

function kb(a, b, c, d) {
  b = a.i.g[String(b)];
  if (!b) return !0;
  b = b.concat();

  for (var e = !0, f = 0; f < b.length; ++f) {
    var h = b[f];

    if (h && !h.ba && h.capture == c) {
      var n = h.listener,
          u = h.ha || h.src;
      h.ea && Wa(a.i, h);
      e = !1 !== n.call(u, d) && e;
    }
  }

  return e && !d.defaultPrevented;
}

var lb = l$1.JSON.stringify;

function mb() {
  var a = nb;
  var b = null;
  a.g && (b = a.g, a.g = a.g.next, a.g || (a.h = null), b.next = null);
  return b;
}

var ob = /*#__PURE__*/function () {
  function ob() {
    _classCallCheck(this, ob);

    this.h = this.g = null;
  }

  _createClass(ob, [{
    key: "add",
    value: function add(a, b) {
      var c = pb.get();
      c.set(a, b);
      this.h ? this.h.next = c : this.g = c;
      this.h = c;
    }
  }]);

  return ob;
}();

var pb = new ( /*#__PURE__*/function () {
  function _class(a, b) {
    _classCallCheck(this, _class);

    this.i = a;
    this.j = b;
    this.h = 0;
    this.g = null;
  }

  _createClass(_class, [{
    key: "get",
    value: function get() {
      var a;
      0 < this.h ? (this.h--, a = this.g, this.g = a.next, a.next = null) : a = this.i();
      return a;
    }
  }]);

  return _class;
}())(function () {
  return new qb();
}, function (a) {
  return a.reset();
});

var qb = /*#__PURE__*/function () {
  function qb() {
    _classCallCheck(this, qb);

    this.next = this.g = this.h = null;
  }

  _createClass(qb, [{
    key: "set",
    value: function set(a, b) {
      this.h = a;
      this.g = b;
      this.next = null;
    }
  }, {
    key: "reset",
    value: function reset() {
      this.next = this.g = this.h = null;
    }
  }]);

  return qb;
}();

function rb(a) {
  l$1.setTimeout(function () {
    throw a;
  }, 0);
}

function sb(a, b) {
  ub || vb();
  wb || (ub(), wb = !0);
  nb.add(a, b);
}

var ub;

function vb() {
  var a = l$1.Promise.resolve(void 0);

  ub = function ub() {
    a.then(xb);
  };
}

var wb = !1,
    nb = new ob();

function xb() {
  for (var a; a = mb();) {
    try {
      a.h.call(a.g);
    } catch (c) {
      rb(c);
    }

    var b = pb;
    b.j(a);
    100 > b.h && (b.h++, a.next = b.g, b.g = a);
  }

  wb = !1;
}

function yb(a, b) {
  B$1.call(this);
  this.h = a || 1;
  this.g = b || l$1;
  this.j = q$2(this.kb, this);
  this.l = Date.now();
}

t(yb, B$1);
k$2 = yb.prototype;
k$2.ca = !1;
k$2.R = null;

k$2.kb = function () {
  if (this.ca) {
    var a = Date.now() - this.l;
    0 < a && a < .8 * this.h ? this.R = this.g.setTimeout(this.j, this.h - a) : (this.R && (this.g.clearTimeout(this.R), this.R = null), C$1(this, "tick"), this.ca && (zb(this), this.start()));
  }
};

k$2.start = function () {
  this.ca = !0;
  this.R || (this.R = this.g.setTimeout(this.j, this.h), this.l = Date.now());
};

function zb(a) {
  a.ca = !1;
  a.R && (a.g.clearTimeout(a.R), a.R = null);
}

k$2.M = function () {
  yb.X.M.call(this);
  zb(this);
  delete this.g;
};

function Ab(a, b, c) {
  if ("function" === typeof a) c && (a = q$2(a, c));else if (a && "function" == typeof a.handleEvent) a = q$2(a.handleEvent, a);else throw Error("Invalid listener argument");
  return 2147483647 < Number(b) ? -1 : l$1.setTimeout(a, b || 0);
}

function Bb(a) {
  a.g = Ab(function () {
    a.g = null;
    a.i && (a.i = !1, Bb(a));
  }, a.j);
  var b = a.h;
  a.h = null;
  a.m.apply(null, b);
}

var Cb = /*#__PURE__*/function (_v) {
  _inherits(Cb, _v);

  var _super = _createSuper$2(Cb);

  function Cb(a, b) {
    var _this;

    _classCallCheck(this, Cb);

    _this = _super.call(this);
    _this.m = a;
    _this.j = b;
    _this.h = null;
    _this.i = !1;
    _this.g = null;
    return _this;
  }

  _createClass(Cb, [{
    key: "l",
    value: function l(a) {
      this.h = arguments;
      this.g ? this.i = !0 : Bb(this);
    }
  }, {
    key: "M",
    value: function M() {
      _get(_getPrototypeOf(Cb.prototype), "M", this).call(this);

      this.g && (l$1.clearTimeout(this.g), this.g = null, this.i = !1, this.h = null);
    }
  }]);

  return Cb;
}(v$2);

function D$2(a) {
  v$2.call(this);
  this.h = a;
  this.g = {};
}

t(D$2, v$2);
var Db = [];

function Eb(a, b, c, d) {
  Array.isArray(c) || (c && (Db[0] = c.toString()), c = Db);

  for (var e = 0; e < c.length; e++) {
    var f = $a(b, c[e], d || a.handleEvent, !1, a.h || a);
    if (!f) break;
    a.g[f.key] = f;
  }
}

function Fb(a) {
  Qa(a.g, function (b, c) {
    this.g.hasOwnProperty(c) && ib(b);
  }, a);
  a.g = {};
}

D$2.prototype.M = function () {
  D$2.X.M.call(this);
  Fb(this);
};

D$2.prototype.handleEvent = function () {
  throw Error("EventHandler.handleEvent not implemented");
};

function Gb() {
  this.g = !0;
}

Gb.prototype.Aa = function () {
  this.g = !1;
};

function Hb(a, b, c, d, e, f) {
  a.info(function () {
    if (a.g) {
      if (f) {
        var h = "";

        for (var n = f.split("&"), u = 0; u < n.length; u++) {
          var m = n[u].split("=");

          if (1 < m.length) {
            var r = m[0];
            m = m[1];
            var F = r.split("_");
            h = 2 <= F.length && "type" == F[1] ? h + (r + "=" + m + "&") : h + (r + "=redacted&");
          }
        }
      } else h = null;
    } else h = f;
    return "XMLHTTP REQ (" + d + ") [attempt " + e + "]: " + b + "\n" + c + "\n" + h;
  });
}

function Ib(a, b, c, d, e, f, h) {
  a.info(function () {
    return "XMLHTTP RESP (" + d + ") [ attempt " + e + "]: " + b + "\n" + c + "\n" + f + " " + h;
  });
}

function E$1(a, b, c, d) {
  a.info(function () {
    return "XMLHTTP TEXT (" + b + "): " + Jb(a, c) + (d ? " " + d : "");
  });
}

function Kb(a, b) {
  a.info(function () {
    return "TIMEOUT: " + b;
  });
}

Gb.prototype.info = function () {};

function Jb(a, b) {
  if (!a.g) return b;
  if (!b) return null;

  try {
    var c = JSON.parse(b);
    if (c) for (a = 0; a < c.length; a++) {
      if (Array.isArray(c[a])) {
        var d = c[a];

        if (!(2 > d.length)) {
          var e = d[1];

          if (Array.isArray(e) && !(1 > e.length)) {
            var f = e[0];
            if ("noop" != f && "stop" != f && "close" != f) for (var h = 1; h < e.length; h++) {
              e[h] = "";
            }
          }
        }
      }
    }
    return lb(c);
  } catch (n) {
    return b;
  }
}

var G$2 = {},
    Lb = null;

function Mb() {
  return Lb = Lb || new B$1();
}

G$2.Oa = "serverreachability";

function Nb(a) {
  w.call(this, G$2.Oa, a);
}

t(Nb, w);

function H$1(a) {
  var b = Mb();
  C$1(b, new Nb(b));
}

G$2.STAT_EVENT = "statevent";

function Ob(a, b) {
  w.call(this, G$2.STAT_EVENT, a);
  this.stat = b;
}

t(Ob, w);

function I$1(a) {
  var b = Mb();
  C$1(b, new Ob(b, a));
}

G$2.Pa = "timingevent";

function Pb(a, b) {
  w.call(this, G$2.Pa, a);
  this.size = b;
}

t(Pb, w);

function J$2(a, b) {
  if ("function" !== typeof a) throw Error("Fn must not be null and must be a function");
  return l$1.setTimeout(function () {
    a();
  }, b);
}

var Qb = {
  NO_ERROR: 0,
  lb: 1,
  yb: 2,
  xb: 3,
  sb: 4,
  wb: 5,
  zb: 6,
  La: 7,
  TIMEOUT: 8,
  Cb: 9
};
var Rb = {
  qb: "complete",
  Mb: "success",
  Ma: "error",
  La: "abort",
  Eb: "ready",
  Fb: "readystatechange",
  TIMEOUT: "timeout",
  Ab: "incrementaldata",
  Db: "progress",
  tb: "downloadprogress",
  Ub: "uploadprogress"
};

function Sb() {}

Sb.prototype.h = null;

function Tb(a) {
  return a.h || (a.h = a.i());
}

function Ub() {}

var K$1 = {
  OPEN: "a",
  pb: "b",
  Ma: "c",
  Bb: "d"
};

function Vb() {
  w.call(this, "d");
}

t(Vb, w);

function Wb() {
  w.call(this, "c");
}

t(Wb, w);
var Xb;

function Yb() {}

t(Yb, Sb);

Yb.prototype.g = function () {
  return new XMLHttpRequest();
};

Yb.prototype.i = function () {
  return {};
};

Xb = new Yb();

function L$2(a, b, c, d) {
  this.l = a;
  this.j = b;
  this.m = c;
  this.U = d || 1;
  this.S = new D$2(this);
  this.O = Zb;
  a = ya$1 ? 125 : void 0;
  this.T = new yb(a);
  this.H = null;
  this.i = !1;
  this.s = this.A = this.v = this.K = this.F = this.V = this.B = null;
  this.D = [];
  this.g = null;
  this.C = 0;
  this.o = this.u = null;
  this.Y = -1;
  this.I = !1;
  this.N = 0;
  this.L = null;
  this.$ = this.J = this.Z = this.P = !1;
  this.h = new $b();
}

function $b() {
  this.i = null;
  this.g = "";
  this.h = !1;
}

var Zb = 45E3,
    ac = {},
    bc = {};
k$2 = L$2.prototype;

k$2.setTimeout = function (a) {
  this.O = a;
};

function cc(a, b, c) {
  a.K = 1;
  a.v = dc(M$2(b));
  a.s = c;
  a.P = !0;
  ec(a, null);
}

function ec(a, b) {
  a.F = Date.now();
  N$2(a);
  a.A = M$2(a.v);
  var c = a.A,
      d = a.U;
  Array.isArray(d) || (d = [String(d)]);
  fc(c.i, "t", d);
  a.C = 0;
  c = a.l.H;
  a.h = new $b();
  a.g = gc(a.l, c ? b : null, !a.s);
  0 < a.N && (a.L = new Cb(q$2(a.Ka, a, a.g), a.N));
  Eb(a.S, a.g, "readystatechange", a.hb);
  b = a.H ? Ra(a.H) : {};
  a.s ? (a.u || (a.u = "POST"), b["Content-Type"] = "application/x-www-form-urlencoded", a.g.da(a.A, a.u, a.s, b)) : (a.u = "GET", a.g.da(a.A, a.u, null, b));
  H$1();
  Hb(a.j, a.u, a.A, a.m, a.U, a.s);
}

k$2.hb = function (a) {
  a = a.target;
  var b = this.L;
  b && 3 == O$1(a) ? b.l() : this.Ka(a);
};

k$2.Ka = function (a) {
  try {
    if (a == this.g) a: {
      var r = O$1(this.g);
      var b = this.g.Ea();
      var F = this.g.aa();

      if (!(3 > r) && (3 != r || ya$1 || this.g && (this.h.h || this.g.fa() || hc(this.g)))) {
        this.I || 4 != r || 7 == b || (8 == b || 0 >= F ? H$1(3) : H$1(2));
        ic(this);
        var c = this.g.aa();
        this.Y = c;

        b: if (jc(this)) {
          var d = hc(this.g);
          a = "";
          var e = d.length,
              f = 4 == O$1(this.g);

          if (!this.h.i) {
            if ("undefined" === typeof TextDecoder) {
              P$2(this);
              Q$2(this);
              var h = "";
              break b;
            }

            this.h.i = new l$1.TextDecoder();
          }

          for (b = 0; b < e; b++) {
            this.h.h = !0, a += this.h.i.decode(d[b], {
              stream: f && b == e - 1
            });
          }

          d.splice(0, e);
          this.h.g += a;
          this.C = 0;
          h = this.h.g;
        } else h = this.g.fa();

        this.i = 200 == c;
        Ib(this.j, this.u, this.A, this.m, this.U, r, c);

        if (this.i) {
          if (this.Z && !this.J) {
            b: {
              if (this.g) {
                var n,
                    u = this.g;

                if ((n = u.g ? u.g.getResponseHeader("X-HTTP-Initial-Response") : null) && !pa$1(n)) {
                  var m = n;
                  break b;
                }
              }

              m = null;
            }

            if (c = m) E$1(this.j, this.m, c, "Initial handshake response via X-HTTP-Initial-Response"), this.J = !0, kc(this, c);else {
              this.i = !1;
              this.o = 3;
              I$1(12);
              P$2(this);
              Q$2(this);
              break a;
            }
          }

          this.P ? (lc(this, r, h), ya$1 && this.i && 3 == r && (Eb(this.S, this.T, "tick", this.gb), this.T.start())) : (E$1(this.j, this.m, h, null), kc(this, h));
          4 == r && P$2(this);
          this.i && !this.I && (4 == r ? mc(this.l, this) : (this.i = !1, N$2(this)));
        } else 400 == c && 0 < h.indexOf("Unknown SID") ? (this.o = 3, I$1(12)) : (this.o = 0, I$1(13)), P$2(this), Q$2(this);
      }
    }
  } catch (r) {} finally {}
};

function jc(a) {
  return a.g ? "GET" == a.u && 2 != a.K && a.l.Da : !1;
}

function lc(a, b, c) {
  var d = !0,
      e;

  for (; !a.I && a.C < c.length;) {
    if (e = nc(a, c), e == bc) {
      4 == b && (a.o = 4, I$1(14), d = !1);
      E$1(a.j, a.m, null, "[Incomplete Response]");
      break;
    } else if (e == ac) {
      a.o = 4;
      I$1(15);
      E$1(a.j, a.m, c, "[Invalid Chunk]");
      d = !1;
      break;
    } else E$1(a.j, a.m, e, null), kc(a, e);
  }

  jc(a) && e != bc && e != ac && (a.h.g = "", a.C = 0);
  4 != b || 0 != c.length || a.h.h || (a.o = 1, I$1(16), d = !1);
  a.i = a.i && d;
  d ? 0 < c.length && !a.$ && (a.$ = !0, b = a.l, b.g == a && b.$ && !b.K && (b.j.info("Great, no buffering proxy detected. Bytes received: " + c.length), oc(b), b.K = !0, I$1(11))) : (E$1(a.j, a.m, c, "[Invalid Chunked Response]"), P$2(a), Q$2(a));
}

k$2.gb = function () {
  if (this.g) {
    var a = O$1(this.g),
        b = this.g.fa();
    this.C < b.length && (ic(this), lc(this, a, b), this.i && 4 != a && N$2(this));
  }
};

function nc(a, b) {
  var c = a.C,
      d = b.indexOf("\n", c);
  if (-1 == d) return bc;
  c = Number(b.substring(c, d));
  if (isNaN(c)) return ac;
  d += 1;
  if (d + c > b.length) return bc;
  b = b.substr(d, c);
  a.C = d + c;
  return b;
}

k$2.cancel = function () {
  this.I = !0;
  P$2(this);
};

function N$2(a) {
  a.V = Date.now() + a.O;
  pc(a, a.O);
}

function pc(a, b) {
  if (null != a.B) throw Error("WatchDog timer not null");
  a.B = J$2(q$2(a.fb, a), b);
}

function ic(a) {
  a.B && (l$1.clearTimeout(a.B), a.B = null);
}

k$2.fb = function () {
  this.B = null;
  var a = Date.now();
  0 <= a - this.V ? (Kb(this.j, this.A), 2 != this.K && (H$1(), I$1(17)), P$2(this), this.o = 2, Q$2(this)) : pc(this, this.V - a);
};

function Q$2(a) {
  0 == a.l.G || a.I || mc(a.l, a);
}

function P$2(a) {
  ic(a);
  var b = a.L;
  b && "function" == typeof b.na && b.na();
  a.L = null;
  zb(a.T);
  Fb(a.S);
  a.g && (b = a.g, a.g = null, b.abort(), b.na());
}

function kc(a, b) {
  try {
    var c = a.l;
    if (0 != c.G && (c.g == a || qc(c.h, a))) if (!a.J && qc(c.h, a) && 3 == c.G) {
      try {
        var d = c.Fa.g.parse(b);
      } catch (m) {
        d = null;
      }

      if (Array.isArray(d) && 3 == d.length) {
        var e = d;
        if (0 == e[0]) a: {
          if (!c.u) {
            if (c.g) if (c.g.F + 3E3 < a.F) rc(c), sc(c);else break a;
            tc(c);
            I$1(18);
          }
        } else c.Ba = e[1], 0 < c.Ba - c.T && 37500 > e[2] && c.L && 0 == c.A && !c.v && (c.v = J$2(q$2(c.bb, c), 6E3));

        if (1 >= uc(c.h) && c.ja) {
          try {
            c.ja();
          } catch (m) {}

          c.ja = void 0;
        }
      } else R$2(c, 11);
    } else if ((a.J || c.g == a) && rc(c), !pa$1(b)) for (e = c.Fa.g.parse(b), b = 0; b < e.length; b++) {
      var m = e[b];
      c.T = m[0];
      m = m[1];
      if (2 == c.G) {
        if ("c" == m[0]) {
          c.I = m[1];
          c.ka = m[2];
          var r = m[3];
          null != r && (c.ma = r, c.j.info("VER=" + c.ma));
          var F = m[4];
          null != F && (c.Ca = F, c.j.info("SVER=" + c.Ca));
          var Ca = m[5];
          null != Ca && "number" === typeof Ca && 0 < Ca && (d = 1.5 * Ca, c.J = d, c.j.info("backChannelRequestTimeoutMs_=" + d));
          d = c;
          var Z = a.g;

          if (Z) {
            var Da = Z.g ? Z.g.getResponseHeader("X-Client-Wire-Protocol") : null;

            if (Da) {
              var f = d.h;
              f.g || -1 == Da.indexOf("spdy") && -1 == Da.indexOf("quic") && -1 == Da.indexOf("h2") || (f.j = f.l, f.g = new Set(), f.h && (vc(f, f.h), f.h = null));
            }

            if (d.D) {
              var tb = Z.g ? Z.g.getResponseHeader("X-HTTP-Session-Id") : null;
              tb && (d.za = tb, S$1(d.F, d.D, tb));
            }
          }

          c.G = 3;
          c.l && c.l.xa();
          c.$ && (c.P = Date.now() - a.F, c.j.info("Handshake RTT: " + c.P + "ms"));
          d = c;
          var h = a;
          d.sa = wc(d, d.H ? d.ka : null, d.V);

          if (h.J) {
            xc(d.h, h);
            var n = h,
                u = d.J;
            u && n.setTimeout(u);
            n.B && (ic(n), N$2(n));
            d.g = h;
          } else yc(d);

          0 < c.i.length && zc(c);
        } else "stop" != m[0] && "close" != m[0] || R$2(c, 7);
      } else 3 == c.G && ("stop" == m[0] || "close" == m[0] ? "stop" == m[0] ? R$2(c, 7) : Ac(c) : "noop" != m[0] && c.l && c.l.wa(m), c.A = 0);
    }
    H$1(4);
  } catch (m) {}
}

function Bc(a) {
  if (a.W && "function" == typeof a.W) return a.W();
  if ("undefined" !== typeof Map && a instanceof Map || "undefined" !== typeof Set && a instanceof Set) return Array.from(a.values());
  if ("string" === typeof a) return a.split("");

  if (ba(a)) {
    for (var b = [], c = a.length, d = 0; d < c; d++) {
      b.push(a[d]);
    }

    return b;
  }

  b = [];
  c = 0;

  for (d in a) {
    b[c++] = a[d];
  }

  return b;
}

function Cc(a) {
  if (a.oa && "function" == typeof a.oa) return a.oa();

  if (!a.W || "function" != typeof a.W) {
    if ("undefined" !== typeof Map && a instanceof Map) return Array.from(a.keys());

    if (!("undefined" !== typeof Set && a instanceof Set)) {
      if (ba(a) || "string" === typeof a) {
        var b = [];
        a = a.length;

        for (var c = 0; c < a; c++) {
          b.push(c);
        }

        return b;
      }

      b = [];
      c = 0;

      for (var d in a) {
        b[c++] = d;
      }

      return b;
    }
  }
}

function Dc(a, b) {
  if (a.forEach && "function" == typeof a.forEach) a.forEach(b, void 0);else if (ba(a) || "string" === typeof a) Array.prototype.forEach.call(a, b, void 0);else for (var c = Cc(a), d = Bc(a), e = d.length, f = 0; f < e; f++) {
    b.call(void 0, d[f], c && c[f], a);
  }
}

var Ec = RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");

function Fc(a, b) {
  if (a) {
    a = a.split("&");

    for (var c = 0; c < a.length; c++) {
      var d = a[c].indexOf("="),
          e = null;

      if (0 <= d) {
        var f = a[c].substring(0, d);
        e = a[c].substring(d + 1);
      } else f = a[c];

      b(f, e ? decodeURIComponent(e.replace(/\+/g, " ")) : "");
    }
  }
}

function T$1(a, b) {
  this.g = this.s = this.j = "";
  this.m = null;
  this.o = this.l = "";
  this.h = !1;

  if (a instanceof T$1) {
    this.h = void 0 !== b ? b : a.h;
    Gc$1(this, a.j);
    this.s = a.s;
    this.g = a.g;
    Hc(this, a.m);
    this.l = a.l;
    b = a.i;
    var c = new Ic();
    c.i = b.i;
    b.g && (c.g = new Map(b.g), c.h = b.h);
    Jc(this, c);
    this.o = a.o;
  } else a && (c = String(a).match(Ec)) ? (this.h = !!b, Gc$1(this, c[1] || "", !0), this.s = Kc(c[2] || ""), this.g = Kc(c[3] || "", !0), Hc(this, c[4]), this.l = Kc(c[5] || "", !0), Jc(this, c[6] || "", !0), this.o = Kc(c[7] || "")) : (this.h = !!b, this.i = new Ic(null, this.h));
}

T$1.prototype.toString = function () {
  var a = [],
      b = this.j;
  b && a.push(Lc(b, Mc, !0), ":");
  var c = this.g;
  if (c || "file" == b) a.push("//"), (b = this.s) && a.push(Lc(b, Mc, !0), "@"), a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g, "%$1")), c = this.m, null != c && a.push(":", String(c));
  if (c = this.l) this.g && "/" != c.charAt(0) && a.push("/"), a.push(Lc(c, "/" == c.charAt(0) ? Nc : Oc, !0));
  (c = this.i.toString()) && a.push("?", c);
  (c = this.o) && a.push("#", Lc(c, Pc));
  return a.join("");
};

function M$2(a) {
  return new T$1(a);
}

function Gc$1(a, b, c) {
  a.j = c ? Kc(b, !0) : b;
  a.j && (a.j = a.j.replace(/:$/, ""));
}

function Hc(a, b) {
  if (b) {
    b = Number(b);
    if (isNaN(b) || 0 > b) throw Error("Bad port number " + b);
    a.m = b;
  } else a.m = null;
}

function Jc(a, b, c) {
  b instanceof Ic ? (a.i = b, Qc(a.i, a.h)) : (c || (b = Lc(b, Rc)), a.i = new Ic(b, a.h));
}

function S$1(a, b, c) {
  a.i.set(b, c);
}

function dc(a) {
  S$1(a, "zx", Math.floor(2147483648 * Math.random()).toString(36) + Math.abs(Math.floor(2147483648 * Math.random()) ^ Date.now()).toString(36));
  return a;
}

function Kc(a, b) {
  return a ? b ? decodeURI(a.replace(/%25/g, "%2525")) : decodeURIComponent(a) : "";
}

function Lc(a, b, c) {
  return "string" === typeof a ? (a = encodeURI(a).replace(b, Sc), c && (a = a.replace(/%25([0-9a-fA-F]{2})/g, "%$1")), a) : null;
}

function Sc(a) {
  a = a.charCodeAt(0);
  return "%" + (a >> 4 & 15).toString(16) + (a & 15).toString(16);
}

var Mc = /[#\/\?@]/g,
    Oc = /[#\?:]/g,
    Nc = /[#\?]/g,
    Rc = /[#\?@]/g,
    Pc = /#/g;

function Ic(a, b) {
  this.h = this.g = null;
  this.i = a || null;
  this.j = !!b;
}

function U$2(a) {
  a.g || (a.g = new Map(), a.h = 0, a.i && Fc(a.i, function (b, c) {
    a.add(decodeURIComponent(b.replace(/\+/g, " ")), c);
  }));
}

k$2 = Ic.prototype;

k$2.add = function (a, b) {
  U$2(this);
  this.i = null;
  a = V(this, a);
  var c = this.g.get(a);
  c || this.g.set(a, c = []);
  c.push(b);
  this.h += 1;
  return this;
};

function Tc(a, b) {
  U$2(a);
  b = V(a, b);
  a.g.has(b) && (a.i = null, a.h -= a.g.get(b).length, a.g.delete(b));
}

function Uc(a, b) {
  U$2(a);
  b = V(a, b);
  return a.g.has(b);
}

k$2.forEach = function (a, b) {
  U$2(this);
  this.g.forEach(function (c, d) {
    c.forEach(function (e) {
      a.call(b, e, d, this);
    }, this);
  }, this);
};

k$2.oa = function () {
  U$2(this);
  var a = Array.from(this.g.values()),
      b = Array.from(this.g.keys()),
      c = [];

  for (var d = 0; d < b.length; d++) {
    var e = a[d];

    for (var f = 0; f < e.length; f++) {
      c.push(b[d]);
    }
  }

  return c;
};

k$2.W = function (a) {
  U$2(this);
  var b = [];
  if ("string" === typeof a) Uc(this, a) && (b = b.concat(this.g.get(V(this, a))));else {
    a = Array.from(this.g.values());

    for (var c = 0; c < a.length; c++) {
      b = b.concat(a[c]);
    }
  }
  return b;
};

k$2.set = function (a, b) {
  U$2(this);
  this.i = null;
  a = V(this, a);
  Uc(this, a) && (this.h -= this.g.get(a).length);
  this.g.set(a, [b]);
  this.h += 1;
  return this;
};

k$2.get = function (a, b) {
  if (!a) return b;
  a = this.W(a);
  return 0 < a.length ? String(a[0]) : b;
};

function fc(a, b, c) {
  Tc(a, b);
  0 < c.length && (a.i = null, a.g.set(V(a, b), ma(c)), a.h += c.length);
}

k$2.toString = function () {
  if (this.i) return this.i;
  if (!this.g) return "";
  var a = [],
      b = Array.from(this.g.keys());

  for (var c = 0; c < b.length; c++) {
    var d = b[c];
    var f = encodeURIComponent(String(d)),
        h = this.W(d);

    for (d = 0; d < h.length; d++) {
      var e = f;
      "" !== h[d] && (e += "=" + encodeURIComponent(String(h[d])));
      a.push(e);
    }
  }

  return this.i = a.join("&");
};

function V(a, b) {
  b = String(b);
  a.j && (b = b.toLowerCase());
  return b;
}

function Qc(a, b) {
  b && !a.j && (U$2(a), a.i = null, a.g.forEach(function (c, d) {
    var e = d.toLowerCase();
    d != e && (Tc(this, d), fc(this, e, c));
  }, a));
  a.j = b;
}

var Vc = /*#__PURE__*/_createClass(function Vc(a, b) {
  _classCallCheck(this, Vc);

  this.h = a;
  this.g = b;
});

function Wc(a) {
  this.l = a || Xc;
  l$1.PerformanceNavigationTiming ? (a = l$1.performance.getEntriesByType("navigation"), a = 0 < a.length && ("hq" == a[0].nextHopProtocol || "h2" == a[0].nextHopProtocol)) : a = !!(l$1.g && l$1.g.Ga && l$1.g.Ga() && l$1.g.Ga().Zb);
  this.j = a ? this.l : 1;
  this.g = null;
  1 < this.j && (this.g = new Set());
  this.h = null;
  this.i = [];
}

var Xc = 10;

function Yc(a) {
  return a.h ? !0 : a.g ? a.g.size >= a.j : !1;
}

function uc(a) {
  return a.h ? 1 : a.g ? a.g.size : 0;
}

function qc(a, b) {
  return a.h ? a.h == b : a.g ? a.g.has(b) : !1;
}

function vc(a, b) {
  a.g ? a.g.add(b) : a.h = b;
}

function xc(a, b) {
  a.h && a.h == b ? a.h = null : a.g && a.g.has(b) && a.g.delete(b);
}

Wc.prototype.cancel = function () {
  this.i = Zc(this);
  if (this.h) this.h.cancel(), this.h = null;else if (this.g && 0 !== this.g.size) {
    var _iterator = _createForOfIteratorHelper$2(this.g.values()),
        _step;

    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var a = _step.value;
        a.cancel();
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }

    this.g.clear();
  }
};

function Zc(a) {
  if (null != a.h) return a.i.concat(a.h.D);

  if (null != a.g && 0 !== a.g.size) {
    var b = a.i;

    var _iterator2 = _createForOfIteratorHelper$2(a.g.values()),
        _step2;

    try {
      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
        var c = _step2.value;
        b = b.concat(c.D);
      }
    } catch (err) {
      _iterator2.e(err);
    } finally {
      _iterator2.f();
    }

    return b;
  }

  return ma(a.i);
}

function $c() {}

$c.prototype.stringify = function (a) {
  return l$1.JSON.stringify(a, void 0);
};

$c.prototype.parse = function (a) {
  return l$1.JSON.parse(a, void 0);
};

function ad() {
  this.g = new $c();
}

function bd(a, b, c) {
  var d = c || "";

  try {
    Dc(a, function (e, f) {
      var h = e;
      p$1(e) && (h = lb(e));
      b.push(d + f + "=" + encodeURIComponent(h));
    });
  } catch (e) {
    throw b.push(d + "type=" + encodeURIComponent("_badmap")), e;
  }
}

function cd(a, b) {
  var c = new Gb();

  if (l$1.Image) {
    var d = new Image();
    d.onload = ia(dd, c, d, "TestLoadImage: loaded", !0, b);
    d.onerror = ia(dd, c, d, "TestLoadImage: error", !1, b);
    d.onabort = ia(dd, c, d, "TestLoadImage: abort", !1, b);
    d.ontimeout = ia(dd, c, d, "TestLoadImage: timeout", !1, b);
    l$1.setTimeout(function () {
      if (d.ontimeout) d.ontimeout();
    }, 1E4);
    d.src = a;
  } else b(!1);
}

function dd(a, b, c, d, e) {
  try {
    b.onload = null, b.onerror = null, b.onabort = null, b.ontimeout = null, e(d);
  } catch (f) {}
}

function ed(a) {
  this.l = a.$b || null;
  this.j = a.ib || !1;
}

t(ed, Sb);

ed.prototype.g = function () {
  return new fd(this.l, this.j);
};

ed.prototype.i = function (a) {
  return function () {
    return a;
  };
}({});

function fd(a, b) {
  B$1.call(this);
  this.D = a;
  this.u = b;
  this.m = void 0;
  this.readyState = gd;
  this.status = 0;
  this.responseType = this.responseText = this.response = this.statusText = "";
  this.onreadystatechange = null;
  this.v = new Headers();
  this.h = null;
  this.C = "GET";
  this.B = "";
  this.g = !1;
  this.A = this.j = this.l = null;
}

t(fd, B$1);
var gd = 0;
k$2 = fd.prototype;

k$2.open = function (a, b) {
  if (this.readyState != gd) throw this.abort(), Error("Error reopening a connection");
  this.C = a;
  this.B = b;
  this.readyState = 1;
  hd(this);
};

k$2.send = function (a) {
  if (1 != this.readyState) throw this.abort(), Error("need to call open() first. ");
  this.g = !0;
  var b = {
    headers: this.v,
    method: this.C,
    credentials: this.m,
    cache: void 0
  };
  a && (b.body = a);
  (this.D || l$1).fetch(new Request(this.B, b)).then(this.Va.bind(this), this.ga.bind(this));
};

k$2.abort = function () {
  this.response = this.responseText = "";
  this.v = new Headers();
  this.status = 0;
  this.j && this.j.cancel("Request was aborted.").catch(function () {});
  1 <= this.readyState && this.g && 4 != this.readyState && (this.g = !1, id(this));
  this.readyState = gd;
};

k$2.Va = function (a) {
  if (this.g && (this.l = a, this.h || (this.status = this.l.status, this.statusText = this.l.statusText, this.h = a.headers, this.readyState = 2, hd(this)), this.g && (this.readyState = 3, hd(this), this.g))) if ("arraybuffer" === this.responseType) a.arrayBuffer().then(this.Ta.bind(this), this.ga.bind(this));else if ("undefined" !== typeof l$1.ReadableStream && "body" in a) {
    this.j = a.body.getReader();

    if (this.u) {
      if (this.responseType) throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');
      this.response = [];
    } else this.response = this.responseText = "", this.A = new TextDecoder();

    jd(this);
  } else a.text().then(this.Ua.bind(this), this.ga.bind(this));
};

function jd(a) {
  a.j.read().then(a.Sa.bind(a)).catch(a.ga.bind(a));
}

k$2.Sa = function (a) {
  if (this.g) {
    if (this.u && a.value) this.response.push(a.value);else if (!this.u) {
      var b = a.value ? a.value : new Uint8Array(0);
      if (b = this.A.decode(b, {
        stream: !a.done
      })) this.response = this.responseText += b;
    }
    a.done ? id(this) : hd(this);
    3 == this.readyState && jd(this);
  }
};

k$2.Ua = function (a) {
  this.g && (this.response = this.responseText = a, id(this));
};

k$2.Ta = function (a) {
  this.g && (this.response = a, id(this));
};

k$2.ga = function () {
  this.g && id(this);
};

function id(a) {
  a.readyState = 4;
  a.l = null;
  a.j = null;
  a.A = null;
  hd(a);
}

k$2.setRequestHeader = function (a, b) {
  this.v.append(a, b);
};

k$2.getResponseHeader = function (a) {
  return this.h ? this.h.get(a.toLowerCase()) || "" : "";
};

k$2.getAllResponseHeaders = function () {
  if (!this.h) return "";
  var a = [],
      b = this.h.entries();

  for (var c = b.next(); !c.done;) {
    c = c.value, a.push(c[0] + ": " + c[1]), c = b.next();
  }

  return a.join("\r\n");
};

function hd(a) {
  a.onreadystatechange && a.onreadystatechange.call(a);
}

Object.defineProperty(fd.prototype, "withCredentials", {
  get: function get() {
    return "include" === this.m;
  },
  set: function set(a) {
    this.m = a ? "include" : "same-origin";
  }
});
var kd = l$1.JSON.parse;

function W$2(a) {
  B$1.call(this);
  this.headers = new Map();
  this.u = a || null;
  this.h = !1;
  this.C = this.g = null;
  this.H = "";
  this.m = 0;
  this.j = "";
  this.l = this.F = this.v = this.D = !1;
  this.B = 0;
  this.A = null;
  this.J = ld;
  this.K = this.L = !1;
}

t(W$2, B$1);
var ld = "",
    md = /^https?$/i,
    nd = ["POST", "PUT"];
k$2 = W$2.prototype;

k$2.da = function (a, b, c, d) {
  if (this.g) throw Error("[goog.net.XhrIo] Object is active with another request=" + this.H + "; newUri=" + a);
  b = b ? b.toUpperCase() : "GET";
  this.H = a;
  this.j = "";
  this.m = 0;
  this.D = !1;
  this.h = !0;
  this.g = this.u ? this.u.g() : Xb.g();
  this.C = this.u ? Tb(this.u) : Tb(Xb);
  this.g.onreadystatechange = q$2(this.Ha, this);

  try {
    this.F = !0, this.g.open(b, String(a), !0), this.F = !1;
  } catch (f) {
    od(this, f);
    return;
  }

  a = c || "";
  c = new Map(this.headers);
  if (d) if (Object.getPrototypeOf(d) === Object.prototype) for (var e in d) {
    c.set(e, d[e]);
  } else if ("function" === typeof d.keys && "function" === typeof d.get) {
    var _iterator3 = _createForOfIteratorHelper$2(d.keys()),
        _step3;

    try {
      for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
        var f = _step3.value;
        c.set(f, d.get(f));
      }
    } catch (err) {
      _iterator3.e(err);
    } finally {
      _iterator3.f();
    }
  } else throw Error("Unknown input type for opt_headers: " + String(d));
  d = Array.from(c.keys()).find(function (f) {
    return "content-type" == f.toLowerCase();
  });
  e = l$1.FormData && a instanceof l$1.FormData;
  !(0 <= la(nd, b)) || d || e || c.set("Content-Type", "application/x-www-form-urlencoded;charset=utf-8");

  var _iterator4 = _createForOfIteratorHelper$2(c),
      _step4;

  try {
    for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
      var _step4$value = _slicedToArray(_step4.value, 2),
          _f = _step4$value[0],
          h = _step4$value[1];

      this.g.setRequestHeader(_f, h);
    }
  } catch (err) {
    _iterator4.e(err);
  } finally {
    _iterator4.f();
  }

  this.J && (this.g.responseType = this.J);
  "withCredentials" in this.g && this.g.withCredentials !== this.L && (this.g.withCredentials = this.L);

  try {
    pd(this), 0 < this.B && ((this.K = qd(this.g)) ? (this.g.timeout = this.B, this.g.ontimeout = q$2(this.qa, this)) : this.A = Ab(this.qa, this.B, this)), this.v = !0, this.g.send(a), this.v = !1;
  } catch (f) {
    od(this, f);
  }
};

function qd(a) {
  return y$1 && Ia() && "number" === typeof a.timeout && void 0 !== a.ontimeout;
}

k$2.qa = function () {
  "undefined" != typeof goog && this.g && (this.j = "Timed out after " + this.B + "ms, aborting", this.m = 8, C$1(this, "timeout"), this.abort(8));
};

function od(a, b) {
  a.h = !1;
  a.g && (a.l = !0, a.g.abort(), a.l = !1);
  a.j = b;
  a.m = 5;
  rd(a);
  sd(a);
}

function rd(a) {
  a.D || (a.D = !0, C$1(a, "complete"), C$1(a, "error"));
}

k$2.abort = function (a) {
  this.g && this.h && (this.h = !1, this.l = !0, this.g.abort(), this.l = !1, this.m = a || 7, C$1(this, "complete"), C$1(this, "abort"), sd(this));
};

k$2.M = function () {
  this.g && (this.h && (this.h = !1, this.l = !0, this.g.abort(), this.l = !1), sd(this, !0));
  W$2.X.M.call(this);
};

k$2.Ha = function () {
  this.s || (this.F || this.v || this.l ? td(this) : this.eb());
};

k$2.eb = function () {
  td(this);
};

function td(a) {
  if (a.h && "undefined" != typeof goog && (!a.C[1] || 4 != O$1(a) || 2 != a.aa())) if (a.v && 4 == O$1(a)) Ab(a.Ha, 0, a);else if (C$1(a, "readystatechange"), 4 == O$1(a)) {
    a.h = !1;

    try {
      var n = a.aa();

      a: switch (n) {
        case 200:
        case 201:
        case 202:
        case 204:
        case 206:
        case 304:
        case 1223:
          var b = !0;
          break a;

        default:
          b = !1;
      }

      var c;

      if (!(c = b)) {
        var d;

        if (d = 0 === n) {
          var e = String(a.H).match(Ec)[1] || null;

          if (!e && l$1.self && l$1.self.location) {
            var f = l$1.self.location.protocol;
            e = f.substr(0, f.length - 1);
          }

          d = !md.test(e ? e.toLowerCase() : "");
        }

        c = d;
      }

      if (c) C$1(a, "complete"), C$1(a, "success");else {
        a.m = 6;

        try {
          var h = 2 < O$1(a) ? a.g.statusText : "";
        } catch (u) {
          h = "";
        }

        a.j = h + " [" + a.aa() + "]";
        rd(a);
      }
    } finally {
      sd(a);
    }
  }
}

function sd(a, b) {
  if (a.g) {
    pd(a);
    var c = a.g,
        d = a.C[0] ? aa : null;
    a.g = null;
    a.C = null;
    b || C$1(a, "ready");

    try {
      c.onreadystatechange = d;
    } catch (e) {}
  }
}

function pd(a) {
  a.g && a.K && (a.g.ontimeout = null);
  a.A && (l$1.clearTimeout(a.A), a.A = null);
}

function O$1(a) {
  return a.g ? a.g.readyState : 0;
}

k$2.aa = function () {
  try {
    return 2 < O$1(this) ? this.g.status : -1;
  } catch (a) {
    return -1;
  }
};

k$2.fa = function () {
  try {
    return this.g ? this.g.responseText : "";
  } catch (a) {
    return "";
  }
};

k$2.Ra = function (a) {
  if (this.g) {
    var b = this.g.responseText;
    a && 0 == b.indexOf(a) && (b = b.substring(a.length));
    return kd(b);
  }
};

function hc(a) {
  try {
    if (!a.g) return null;
    if ("response" in a.g) return a.g.response;

    switch (a.J) {
      case ld:
      case "text":
        return a.g.responseText;

      case "arraybuffer":
        if ("mozResponseArrayBuffer" in a.g) return a.g.mozResponseArrayBuffer;
    }

    return null;
  } catch (b) {
    return null;
  }
}

k$2.Ea = function () {
  return this.m;
};

k$2.Na = function () {
  return "string" === typeof this.j ? this.j : String(this.j);
};

function ud(a) {
  var b = "";
  Qa(a, function (c, d) {
    b += d;
    b += ":";
    b += c;
    b += "\r\n";
  });
  return b;
}

function vd(a, b, c) {
  a: {
    for (d in c) {
      var d = !1;
      break a;
    }

    d = !0;
  }

  d || (c = ud(c), "string" === typeof a ? null != c && encodeURIComponent(String(c)) : S$1(a, b, c));
}

function wd(a, b, c) {
  return c && c.internalChannelParams ? c.internalChannelParams[a] || b : b;
}

function xd(a) {
  this.Ca = 0;
  this.i = [];
  this.j = new Gb();
  this.ka = this.sa = this.F = this.V = this.g = this.za = this.D = this.ia = this.o = this.S = this.s = null;
  this.$a = this.U = 0;
  this.Ya = wd("failFast", !1, a);
  this.L = this.v = this.u = this.m = this.l = null;
  this.Y = !0;
  this.pa = this.Ba = this.T = -1;
  this.Z = this.A = this.C = 0;
  this.Wa = wd("baseRetryDelayMs", 5E3, a);
  this.ab = wd("retryDelaySeedMs", 1E4, a);
  this.Za = wd("forwardChannelMaxRetries", 2, a);
  this.ta = wd("forwardChannelRequestTimeoutMs", 2E4, a);
  this.ra = a && a.xmlHttpFactory || void 0;
  this.Da = a && a.Yb || !1;
  this.J = void 0;
  this.H = a && a.supportsCrossDomainXhr || !1;
  this.I = "";
  this.h = new Wc(a && a.concurrentRequestLimit);
  this.Fa = new ad();
  this.O = a && a.fastHandshake || !1;
  this.N = a && a.encodeInitMessageHeaders || !1;
  this.O && this.N && (this.N = !1);
  this.Xa = a && a.Wb || !1;
  a && a.Aa && this.j.Aa();
  a && a.forceLongPolling && (this.Y = !1);
  this.$ = !this.O && this.Y && a && a.detectBufferingProxy || !1;
  this.ja = void 0;
  this.P = 0;
  this.K = !1;
  this.la = this.B = null;
}

k$2 = xd.prototype;
k$2.ma = 8;
k$2.G = 1;

function Ac(a) {
  yd(a);

  if (3 == a.G) {
    var b = a.U++,
        c = M$2(a.F);
    S$1(c, "SID", a.I);
    S$1(c, "RID", b);
    S$1(c, "TYPE", "terminate");
    zd(a, c);
    b = new L$2(a, a.j, b, void 0);
    b.K = 2;
    b.v = dc(M$2(c));
    c = !1;
    l$1.navigator && l$1.navigator.sendBeacon && (c = l$1.navigator.sendBeacon(b.v.toString(), ""));
    !c && l$1.Image && (new Image().src = b.v, c = !0);
    c || (b.g = gc(b.l, null), b.g.da(b.v));
    b.F = Date.now();
    N$2(b);
  }

  Ad(a);
}

function sc(a) {
  a.g && (oc(a), a.g.cancel(), a.g = null);
}

function yd(a) {
  sc(a);
  a.u && (l$1.clearTimeout(a.u), a.u = null);
  rc(a);
  a.h.cancel();
  a.m && ("number" === typeof a.m && l$1.clearTimeout(a.m), a.m = null);
}

function zc(a) {
  Yc(a.h) || a.m || (a.m = !0, sb(a.Ja, a), a.C = 0);
}

function Bd(a, b) {
  if (uc(a.h) >= a.h.j - (a.m ? 1 : 0)) return !1;
  if (a.m) return a.i = b.D.concat(a.i), !0;
  if (1 == a.G || 2 == a.G || a.C >= (a.Ya ? 0 : a.Za)) return !1;
  a.m = J$2(q$2(a.Ja, a, b), Cd(a, a.C));
  a.C++;
  return !0;
}

k$2.Ja = function (a) {
  if (this.m) if (this.m = null, 1 == this.G) {
    if (!a) {
      this.U = Math.floor(1E5 * Math.random());
      a = this.U++;
      var e = new L$2(this, this.j, a, void 0);
      var f = this.s;
      this.S && (f ? (f = Ra(f), Ta(f, this.S)) : f = this.S);
      null !== this.o || this.N || (e.H = f, f = null);
      if (this.O) a: {
        var b = 0;

        for (var c = 0; c < this.i.length; c++) {
          b: {
            var d = this.i[c];

            if ("__data__" in d.g && (d = d.g.__data__, "string" === typeof d)) {
              d = d.length;
              break b;
            }

            d = void 0;
          }

          if (void 0 === d) break;
          b += d;

          if (4096 < b) {
            b = c;
            break a;
          }

          if (4096 === b || c === this.i.length - 1) {
            b = c + 1;
            break a;
          }
        }

        b = 1E3;
      } else b = 1E3;
      b = Dd(this, e, b);
      c = M$2(this.F);
      S$1(c, "RID", a);
      S$1(c, "CVER", 22);
      this.D && S$1(c, "X-HTTP-Session-Id", this.D);
      zd(this, c);
      f && (this.N ? b = "headers=" + encodeURIComponent(String(ud(f))) + "&" + b : this.o && vd(c, this.o, f));
      vc(this.h, e);
      this.Xa && S$1(c, "TYPE", "init");
      this.O ? (S$1(c, "$req", b), S$1(c, "SID", "null"), e.Z = !0, cc(e, c, null)) : cc(e, c, b);
      this.G = 2;
    }
  } else 3 == this.G && (a ? Ed(this, a) : 0 == this.i.length || Yc(this.h) || Ed(this));
};

function Ed(a, b) {
  var c;
  b ? c = b.m : c = a.U++;
  var d = M$2(a.F);
  S$1(d, "SID", a.I);
  S$1(d, "RID", c);
  S$1(d, "AID", a.T);
  zd(a, d);
  a.o && a.s && vd(d, a.o, a.s);
  c = new L$2(a, a.j, c, a.C + 1);
  null === a.o && (c.H = a.s);
  b && (a.i = b.D.concat(a.i));
  b = Dd(a, c, 1E3);
  c.setTimeout(Math.round(.5 * a.ta) + Math.round(.5 * a.ta * Math.random()));
  vc(a.h, c);
  cc(c, d, b);
}

function zd(a, b) {
  a.ia && Qa(a.ia, function (c, d) {
    S$1(b, d, c);
  });
  a.l && Dc({}, function (c, d) {
    S$1(b, d, c);
  });
}

function Dd(a, b, c) {
  c = Math.min(a.i.length, c);
  var d = a.l ? q$2(a.l.Qa, a.l, a) : null;

  a: {
    var e = a.i;
    var f = -1;

    for (;;) {
      var h = ["count=" + c];
      -1 == f ? 0 < c ? (f = e[0].h, h.push("ofs=" + f)) : f = 0 : h.push("ofs=" + f);
      var n = !0;

      for (var u = 0; u < c; u++) {
        var m = e[u].h;
        var r = e[u].g;
        m -= f;
        if (0 > m) f = Math.max(0, e[u].h - 100), n = !1;else try {
          bd(r, h, "req" + m + "_");
        } catch (F) {
          d && d(r);
        }
      }

      if (n) {
        d = h.join("&");
        break a;
      }
    }
  }

  a = a.i.splice(0, c);
  b.D = a;
  return d;
}

function yc(a) {
  a.g || a.u || (a.Z = 1, sb(a.Ia, a), a.A = 0);
}

function tc(a) {
  if (a.g || a.u || 3 <= a.A) return !1;
  a.Z++;
  a.u = J$2(q$2(a.Ia, a), Cd(a, a.A));
  a.A++;
  return !0;
}

k$2.Ia = function () {
  this.u = null;
  Fd(this);

  if (this.$ && !(this.K || null == this.g || 0 >= this.P)) {
    var a = 2 * this.P;
    this.j.info("BP detection timer enabled: " + a);
    this.B = J$2(q$2(this.cb, this), a);
  }
};

k$2.cb = function () {
  this.B && (this.B = null, this.j.info("BP detection timeout reached."), this.j.info("Buffering proxy detected and switch to long-polling!"), this.L = !1, this.K = !0, I$1(10), sc(this), Fd(this));
};

function oc(a) {
  null != a.B && (l$1.clearTimeout(a.B), a.B = null);
}

function Fd(a) {
  a.g = new L$2(a, a.j, "rpc", a.Z);
  null === a.o && (a.g.H = a.s);
  a.g.N = 0;
  var b = M$2(a.sa);
  S$1(b, "RID", "rpc");
  S$1(b, "SID", a.I);
  S$1(b, "CI", a.L ? "0" : "1");
  S$1(b, "AID", a.T);
  S$1(b, "TYPE", "xmlhttp");
  zd(a, b);
  a.o && a.s && vd(b, a.o, a.s);
  a.J && a.g.setTimeout(a.J);
  var c = a.g;
  a = a.ka;
  c.K = 1;
  c.v = dc(M$2(b));
  c.s = null;
  c.P = !0;
  ec(c, a);
}

k$2.bb = function () {
  null != this.v && (this.v = null, sc(this), tc(this), I$1(19));
};

function rc(a) {
  null != a.v && (l$1.clearTimeout(a.v), a.v = null);
}

function mc(a, b) {
  var c = null;

  if (a.g == b) {
    rc(a);
    oc(a);
    a.g = null;
    var d = 2;
  } else if (qc(a.h, b)) c = b.D, xc(a.h, b), d = 1;else return;

  if (0 != a.G) if (a.pa = b.Y, b.i) {
    if (1 == d) {
      c = b.s ? b.s.length : 0;
      b = Date.now() - b.F;
      var e = a.C;
      d = Mb();
      C$1(d, new Pb(d, c));
      zc(a);
    } else yc(a);
  } else if (e = b.o, 3 == e || 0 == e && 0 < a.pa || !(1 == d && Bd(a, b) || 2 == d && tc(a))) switch (c && 0 < c.length && (b = a.h, b.i = b.i.concat(c)), e) {
    case 1:
      R$2(a, 5);
      break;

    case 4:
      R$2(a, 10);
      break;

    case 3:
      R$2(a, 6);
      break;

    default:
      R$2(a, 2);
  }
}

function Cd(a, b) {
  var c = a.Wa + Math.floor(Math.random() * a.ab);
  a.l || (c *= 2);
  return c * b;
}

function R$2(a, b) {
  a.j.info("Error code " + b);

  if (2 == b) {
    var c = null;
    a.l && (c = null);
    var d = q$2(a.jb, a);
    c || (c = new T$1("//www.google.com/images/cleardot.gif"), l$1.location && "http" == l$1.location.protocol || Gc$1(c, "https"), dc(c));
    cd(c.toString(), d);
  } else I$1(2);

  a.G = 0;
  a.l && a.l.va(b);
  Ad(a);
  yd(a);
}

k$2.jb = function (a) {
  a ? (this.j.info("Successfully pinged google.com"), I$1(2)) : (this.j.info("Failed to ping google.com"), I$1(1));
};

function Ad(a) {
  a.G = 0;
  a.la = [];

  if (a.l) {
    var b = Zc(a.h);
    if (0 != b.length || 0 != a.i.length) na(a.la, b), na(a.la, a.i), a.h.i.length = 0, ma(a.i), a.i.length = 0;
    a.l.ua();
  }
}

function wc(a, b, c) {
  var d = c instanceof T$1 ? M$2(c) : new T$1(c, void 0);
  if ("" != d.g) b && (d.g = b + "." + d.g), Hc(d, d.m);else {
    var e = l$1.location;
    d = e.protocol;
    b = b ? b + "." + e.hostname : e.hostname;
    e = +e.port;
    var f = new T$1(null, void 0);
    d && Gc$1(f, d);
    b && (f.g = b);
    e && Hc(f, e);
    c && (f.l = c);
    d = f;
  }
  c = a.D;
  b = a.za;
  c && b && S$1(d, c, b);
  S$1(d, "VER", a.ma);
  zd(a, d);
  return d;
}

function gc(a, b, c) {
  if (b && !a.H) throw Error("Can't create secondary domain capable XhrIo object.");
  b = c && a.Da && !a.ra ? new W$2(new ed({
    ib: !0
  })) : new W$2(a.ra);
  b.L = a.H;
  return b;
}

function Gd() {}

k$2 = Gd.prototype;

k$2.xa = function () {};

k$2.wa = function () {};

k$2.va = function () {};

k$2.ua = function () {};

k$2.Qa = function () {};

function X$2(a, b) {
  B$1.call(this);
  this.g = new xd(b);
  this.l = a;
  this.h = b && b.messageUrlParams || null;
  a = b && b.messageHeaders || null;
  b && b.clientProtocolHeaderRequired && (a ? a["X-Client-Protocol"] = "webchannel" : a = {
    "X-Client-Protocol": "webchannel"
  });
  this.g.s = a;
  a = b && b.initMessageHeaders || null;
  b && b.messageContentType && (a ? a["X-WebChannel-Content-Type"] = b.messageContentType : a = {
    "X-WebChannel-Content-Type": b.messageContentType
  });
  b && b.ya && (a ? a["X-WebChannel-Client-Profile"] = b.ya : a = {
    "X-WebChannel-Client-Profile": b.ya
  });
  this.g.S = a;
  (a = b && b.Xb) && !pa$1(a) && (this.g.o = a);
  this.A = b && b.supportsCrossDomainXhr || !1;
  this.v = b && b.sendRawJson || !1;
  (b = b && b.httpSessionIdParam) && !pa$1(b) && (this.g.D = b, a = this.h, null !== a && b in a && (a = this.h, b in a && delete a[b]));
  this.j = new Y$2(this);
}

t(X$2, B$1);

X$2.prototype.m = function () {
  this.g.l = this.j;
  this.A && (this.g.H = !0);
  var a = this.g,
      b = this.l,
      c = this.h || void 0;
  I$1(0);
  a.V = b;
  a.ia = c || {};
  a.L = a.Y;
  a.F = wc(a, null, a.V);
  zc(a);
};

X$2.prototype.close = function () {
  Ac(this.g);
};

X$2.prototype.u = function (a) {
  var b = this.g;

  if ("string" === typeof a) {
    var c = {};
    c.__data__ = a;
    a = c;
  } else this.v && (c = {}, c.__data__ = lb(a), a = c);

  b.i.push(new Vc(b.$a++, a));
  3 == b.G && zc(b);
};

X$2.prototype.M = function () {
  this.g.l = null;
  delete this.j;
  Ac(this.g);
  delete this.g;
  X$2.X.M.call(this);
};

function Id(a) {
  Vb.call(this);
  var b = a.__sm__;

  if (b) {
    a: {
      for (var c in b) {
        a = c;
        break a;
      }

      a = void 0;
    }

    if (this.i = a) a = this.i, b = null !== b && a in b ? b[a] : void 0;
    this.data = b;
  } else this.data = a;
}

t(Id, Vb);

function Jd() {
  Wb.call(this);
  this.status = 1;
}

t(Jd, Wb);

function Y$2(a) {
  this.g = a;
}

t(Y$2, Gd);

Y$2.prototype.xa = function () {
  C$1(this.g, "a");
};

Y$2.prototype.wa = function (a) {
  C$1(this.g, new Id(a));
};

Y$2.prototype.va = function (a) {
  C$1(this.g, new Jd());
};

Y$2.prototype.ua = function () {
  C$1(this.g, "b");
};
X$2.prototype.send = X$2.prototype.u;
X$2.prototype.open = X$2.prototype.m;
X$2.prototype.close = X$2.prototype.close;
Qb.NO_ERROR = 0;
Qb.TIMEOUT = 8;
Qb.HTTP_ERROR = 6;
Rb.COMPLETE = "complete";
Ub.EventType = K$1;
K$1.OPEN = "a";
K$1.CLOSE = "b";
K$1.ERROR = "c";
K$1.MESSAGE = "d";
B$1.prototype.listen = B$1.prototype.N;
W$2.prototype.listenOnce = W$2.prototype.O;
W$2.prototype.getLastError = W$2.prototype.Na;
W$2.prototype.getLastErrorCode = W$2.prototype.Ea;
W$2.prototype.getStatus = W$2.prototype.aa;
W$2.prototype.getResponseJson = W$2.prototype.Ra;
W$2.prototype.getResponseText = W$2.prototype.fa;
W$2.prototype.send = W$2.prototype.da;

function _createForOfIteratorHelper$1(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray$1(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return {s:F,n:function n(){if(i>=o.length)return {done:true};return {done:false,value:o[i++]};},e:function e(_e67){throw _e67;},f:F};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=true,didErr=false,err;return {s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e68){didErr=true;err=_e68;},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return();}finally{if(didErr)throw err;}}};}function _unsupportedIterableToArray$1(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray$1(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray$1(o,minLen);}function _arrayLikeToArray$1(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _createSuper$1(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$1();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else {result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$1(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}var R$1="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * Simple wrapper around a nullable UID. Mostly exists to make code more
 * readable.
 */var b$1=/*#__PURE__*/function(){function b(t){_classCallCheck(this,b);this.uid=t;}_createClass(b,[{key:"isAuthenticated",value:function isAuthenticated(){return null!=this.uid;}/**
     * Returns a key representing this user, suitable for inclusion in a
     * dictionary.
     */},{key:"toKey",value:function toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user";}},{key:"isEqual",value:function isEqual(t){return t.uid===this.uid;}}]);return b;}();/** A user with a null UID. */b$1.UNAUTHENTICATED=new b$1(null),// TODO(mikelehen): Look into getting a proper uid-equivalent for
// non-FirebaseAuth providers.
b$1.GOOGLE_CREDENTIALS=new b$1("google-credentials-uid"),b$1.FIRST_PARTY=new b$1("first-party-uid"),b$1.MOCK_USER=new b$1("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var P$1="9.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var v$1=new Logger("@firebase/firestore");// Helper methods are needed because variables can't be exported as read/write
function D$1(t){if(v$1.logLevel<=LogLevel.DEBUG){for(var _len=arguments.length,e=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){e[_key-1]=arguments[_key];}var n=e.map(N$1);v$1.debug.apply(v$1,["Firestore (".concat(P$1,"): ").concat(t)].concat(_toConsumableArray(n)));}}function C(t){if(v$1.logLevel<=LogLevel.ERROR){for(var _len2=arguments.length,e=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){e[_key2-1]=arguments[_key2];}var n=e.map(N$1);v$1.error.apply(v$1,["Firestore (".concat(P$1,"): ").concat(t)].concat(_toConsumableArray(n)));}}/**
 * Converts an additional log parameter to a string representation.
 */function N$1(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e);}catch(e){// Converting to JSON failed, just log the object directly
return t;}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /** Formats an object as a JSON string, suitable for logging. */var e;}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * Unconditionally fails, throwing an Error with the given message.
 * Messages are stripped in production builds.
 *
 * Returns `never` and can be used in expressions:
 * @example
 * let futureVar = fail('not implemented yet');
 */function k$1(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Unexpected state";// Log the failure in addition to throw an exception, just in case the
// exception is swallowed.
var e="FIRESTORE (".concat(P$1,") INTERNAL ASSERTION FAILED: ")+t;// NOTE: We don't use FirestoreError here because these are internal failures
// that cannot be handled by the user. (Also it would create a circular
// dependency between the error and assert modules which doesn't work.)
throw C(e),new Error(e);}/**
 * Fails if the given assertion condition is false, throwing an Error with the
 * given message if it did.
 *
 * Messages are stripped in production builds.
 */function M$1(t,e){t||k$1();}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $$1={// Causes are copied from:
// https://github.com/grpc/grpc/blob/bceec94ea4fc5f0085d81235d8e1c06798dc341a/include/grpc%2B%2B/impl/codegen/status_code_enum.h
/** Not an error; returned on success. */OK:"ok",/** The operation was cancelled (typically by the caller). */CANCELLED:"cancelled",/** Unknown error or an error from a different error domain. */UNKNOWN:"unknown",/**
     * Client specified an invalid argument. Note that this differs from
     * FAILED_PRECONDITION. INVALID_ARGUMENT indicates arguments that are
     * problematic regardless of the state of the system (e.g., a malformed file
     * name).
     */INVALID_ARGUMENT:"invalid-argument",/**
     * Deadline expired before operation could complete. For operations that
     * change the state of the system, this error may be returned even if the
     * operation has completed successfully. For example, a successful response
     * from a server could have been delayed long enough for the deadline to
     * expire.
     */DEADLINE_EXCEEDED:"deadline-exceeded",/** Some requested entity (e.g., file or directory) was not found. */NOT_FOUND:"not-found",/**
     * Some entity that we attempted to create (e.g., file or directory) already
     * exists.
     */ALREADY_EXISTS:"already-exists",/**
     * The caller does not have permission to execute the specified operation.
     * PERMISSION_DENIED must not be used for rejections caused by exhausting
     * some resource (use RESOURCE_EXHAUSTED instead for those errors).
     * PERMISSION_DENIED must not be used if the caller can not be identified
     * (use UNAUTHENTICATED instead for those errors).
     */PERMISSION_DENIED:"permission-denied",/**
     * The request does not have valid authentication credentials for the
     * operation.
     */UNAUTHENTICATED:"unauthenticated",/**
     * Some resource has been exhausted, perhaps a per-user quota, or perhaps the
     * entire file system is out of space.
     */RESOURCE_EXHAUSTED:"resource-exhausted",/**
     * Operation was rejected because the system is not in a state required for
     * the operation's execution. For example, directory to be deleted may be
     * non-empty, an rmdir operation is applied to a non-directory, etc.
     *
     * A litmus test that may help a service implementor in deciding
     * between FAILED_PRECONDITION, ABORTED, and UNAVAILABLE:
     *  (a) Use UNAVAILABLE if the client can retry just the failing call.
     *  (b) Use ABORTED if the client should retry at a higher-level
     *      (e.g., restarting a read-modify-write sequence).
     *  (c) Use FAILED_PRECONDITION if the client should not retry until
     *      the system state has been explicitly fixed. E.g., if an "rmdir"
     *      fails because the directory is non-empty, FAILED_PRECONDITION
     *      should be returned since the client should not retry unless
     *      they have first fixed up the directory by deleting files from it.
     *  (d) Use FAILED_PRECONDITION if the client performs conditional
     *      REST Get/Update/Delete on a resource and the resource on the
     *      server does not match the condition. E.g., conflicting
     *      read-modify-write on the same resource.
     */FAILED_PRECONDITION:"failed-precondition",/**
     * The operation was aborted, typically due to a concurrency issue like
     * sequencer check failures, transaction aborts, etc.
     *
     * See litmus test above for deciding between FAILED_PRECONDITION, ABORTED,
     * and UNAVAILABLE.
     */ABORTED:"aborted",/**
     * Operation was attempted past the valid range. E.g., seeking or reading
     * past end of file.
     *
     * Unlike INVALID_ARGUMENT, this error indicates a problem that may be fixed
     * if the system state changes. For example, a 32-bit file system will
     * generate INVALID_ARGUMENT if asked to read at an offset that is not in the
     * range [0,2^32-1], but it will generate OUT_OF_RANGE if asked to read from
     * an offset past the current file size.
     *
     * There is a fair bit of overlap between FAILED_PRECONDITION and
     * OUT_OF_RANGE. We recommend using OUT_OF_RANGE (the more specific error)
     * when it applies so that callers who are iterating through a space can
     * easily look for an OUT_OF_RANGE error to detect when they are done.
     */OUT_OF_RANGE:"out-of-range",/** Operation is not implemented or not supported/enabled in this service. */UNIMPLEMENTED:"unimplemented",/**
     * Internal errors. Means some invariants expected by underlying System has
     * been broken. If you see one of these errors, Something is very broken.
     */INTERNAL:"internal",/**
     * The service is currently unavailable. This is a most likely a transient
     * condition and may be corrected by retrying with a backoff.
     *
     * See litmus test above for deciding between FAILED_PRECONDITION, ABORTED,
     * and UNAVAILABLE.
     */UNAVAILABLE:"unavailable",/** Unrecoverable data loss or corruption. */DATA_LOSS:"data-loss"};/** An error returned by a Firestore operation. */var B=/*#__PURE__*/function(_FirebaseError){_inherits(B,_FirebaseError);var _super=_createSuper$1(B);/** @hideconstructor */function B(/**
     * The backend error code associated with this error.
     */t,/**
     * A custom error description.
     */e){var _this;_classCallCheck(this,B);_this=_super.call(this,t,e),_this.code=t,_this.message=e,// HACK: We write a toString property directly because Error is not a real
// class and so inheritance does not work correctly. We could alternatively
// do the same "back-door inheritance" trick that FirebaseError does.
_this.toString=function(){return "".concat(_this.name,": [code=").concat(_this.code,"]: ").concat(_this.message);};return _this;}return _createClass(B);}(FirebaseError);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var L$1=/*#__PURE__*/_createClass(function L(){var _this2=this;_classCallCheck(this,L);this.promise=new Promise(function(t,e){_this2.resolve=t,_this2.reject=e;});});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var U$1=/*#__PURE__*/_createClass(function U(t,e){_classCallCheck(this,U);this.user=e,this.type="OAuth",this.headers=new Map(),this.headers.set("Authorization","Bearer ".concat(t));});/**
 * A CredentialsProvider that always yields an empty token.
 * @internal
 */var q$1=/*#__PURE__*/function(){function q(){_classCallCheck(this,q);}_createClass(q,[{key:"getToken",value:function getToken(){return Promise.resolve(null);}},{key:"invalidateToken",value:function invalidateToken(){}},{key:"start",value:function start(t,e){// Fire with initial user.
t.enqueueRetryable(function(){return e(b$1.UNAUTHENTICATED);});}},{key:"shutdown",value:function shutdown(){}}]);return q;}();var G$1=/*#__PURE__*/function(){function G(t){_classCallCheck(this,G);this.t=t,/** Tracks the current User. */this.currentUser=b$1.UNAUTHENTICATED,/**
         * Counter used to detect if the token changed while a getToken request was
         * outstanding.
         */this.i=0,this.forceRefresh=!1,this.auth=null;}_createClass(G,[{key:"start",value:function start(t,e){var _this4=this;var n=this.i;// A change listener that prevents double-firing for the same token change.
var s=function s(t){return _this4.i!==n?(n=_this4.i,e(t)):Promise.resolve();};// A promise that can be waited on to block on the next token change.
// This promise is re-created after each change.
var i=new L$1();this.o=function(){_this4.i++,_this4.currentUser=_this4.u(),i.resolve(),i=new L$1(),t.enqueueRetryable(function(){return s(_this4.currentUser);});};var r=function r(){var e=i;t.enqueueRetryable(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/regenerator.mark(function _callee(){return regenerator.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return e.promise;case 2:_context.next=4;return s(_this4.currentUser);case 4:case"end":return _context.stop();}}},_callee);})));},o=function o(t){D$1("FirebaseAuthCredentialsProvider","Auth detected"),_this4.auth=t,_this4.auth.addAuthTokenListener(_this4.o),r();};this.t.onInit(function(t){return o(t);}),// Our users can initialize Auth right after Firestore, so we give it
// a chance to register itself with the component framework before we
// determine whether to start up in unauthenticated mode.
setTimeout(function(){if(!_this4.auth){var _t2=_this4.t.getImmediate({optional:!0});_t2?o(_t2):(// If auth is still not available, proceed with `null` user
D$1("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new L$1());}},0),r();}},{key:"getToken",value:function getToken(){var _this5=this;// Take note of the current value of the tokenCounter so that this method
// can fail (with an ABORTED error) if there is a token change while the
// request is outstanding.
var t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(function(e){return(// Cancel the request since the token changed while the request was
// outstanding so the response is potentially for a previous user (which
// user, we can't be sure).
_this5.i!==t?(D$1("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),_this5.getToken()):e?(M$1("string"==typeof e.accessToken),new U$1(e.accessToken,_this5.currentUser)):null);}):Promise.resolve(null);}},{key:"invalidateToken",value:function invalidateToken(){this.forceRefresh=!0;}},{key:"shutdown",value:function shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o);}// Auth.getUid() can return null even with a user logged in. It is because
// getUid() is synchronous, but the auth code populating Uid is asynchronous.
// This method should only be called in the AuthTokenListener callback
// to guarantee to get the actual user.
},{key:"u",value:function u(){var t=this.auth&&this.auth.getUid();return M$1(null===t||"string"==typeof t),new b$1(t);}}]);return G;}();/*
 * FirstPartyToken provides a fresh token each time its value
 * is requested, because if the token is too old, requests will be rejected.
 * Technically this may no longer be necessary since the SDK should gracefully
 * recover from unauthenticated errors (see b/33147818 for context), but it's
 * safer to keep the implementation as-is.
 */var Q$1=/*#__PURE__*/function(){function Q(t,e,n,s){_classCallCheck(this,Q);this.h=t,this.l=e,this.m=n,this.g=s,this.type="FirstParty",this.user=b$1.FIRST_PARTY,this.p=new Map();}/** Gets an authorization token, using a provided factory function, or falling back to First Party GAPI. */_createClass(Q,[{key:"I",value:function I(){return this.g?this.g():(// Make sure this really is a Gapi client.
M$1(!("object"!=_typeof$1(this.h)||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]));}},{key:"headers",get:function get(){this.p.set("X-Goog-AuthUser",this.l);// Use array notation to prevent minification
var t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p;}}]);return Q;}();/*
 * Provides user credentials required for the Firestore JavaScript SDK
 * to authenticate the user, using technique that is only available
 * to applications hosted by Google.
 */var j$1=/*#__PURE__*/function(){function j(t,e,n,s){_classCallCheck(this,j);this.h=t,this.l=e,this.m=n,this.g=s;}_createClass(j,[{key:"getToken",value:function getToken(){return Promise.resolve(new Q$1(this.h,this.l,this.m,this.g));}},{key:"start",value:function start(t,e){// Fire with initial uid.
t.enqueueRetryable(function(){return e(b$1.FIRST_PARTY);});}},{key:"shutdown",value:function shutdown(){}},{key:"invalidateToken",value:function invalidateToken(){}}]);return j;}();var W$1=/*#__PURE__*/_createClass(function W(t){_classCallCheck(this,W);this.value=t,this.type="AppCheck",this.headers=new Map(),t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value);});var z$1=/*#__PURE__*/function(){function z(t){_classCallCheck(this,z);this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null;}_createClass(z,[{key:"start",value:function start(t,e){var _this6=this;var n=function n(t){null!=t.error&&D$1("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(t.error.message));var n=t.token!==_this6.A;return _this6.A=t.token,D$1("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?e(t.token):Promise.resolve();};this.o=function(e){t.enqueueRetryable(function(){return n(e);});};var s=function s(t){D$1("FirebaseAppCheckTokenProvider","AppCheck detected"),_this6.appCheck=t,_this6.appCheck.addTokenListener(_this6.o);};this.T.onInit(function(t){return s(t);}),// Our users can initialize AppCheck after Firestore, so we give it
// a chance to register itself with the component framework.
setTimeout(function(){if(!_this6.appCheck){var _t3=_this6.T.getImmediate({optional:!0});_t3?s(_t3):// If AppCheck is still not available, proceed without it.
D$1("FirebaseAppCheckTokenProvider","AppCheck not yet detected");}},0);}},{key:"getToken",value:function getToken(){var _this7=this;var t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(function(t){return t?(M$1("string"==typeof t.token),_this7.A=t.token,new W$1(t.token)):null;}):Promise.resolve(null);}},{key:"invalidateToken",value:function invalidateToken(){this.forceRefresh=!0;}},{key:"shutdown",value:function shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o);}}]);return z;}();/**
 * Builds a CredentialsProvider depending on the type of
 * the credentials passed in.
 */ /**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * Generates `nBytes` of random bytes.
 *
 * If `nBytes < 0` , an error will be thrown.
 */function J$1(t){// Polyfills for IE and WebWorker by using `self` and `msCrypto` when `crypto` is not available.
var e=// eslint-disable-next-line @typescript-eslint/no-explicit-any
"undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else// Falls back to Math.random
for(var _e2=0;_e2<t;_e2++){n[_e2]=Math.floor(256*Math.random());}return n;}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Y$1=/*#__PURE__*/function(){function Y(){_classCallCheck(this,Y);}_createClass(Y,null,[{key:"R",value:function R(){// Alphanumeric characters
var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;// The largest byte value that is a multiple of `char.length`.
var n="";for(;n.length<20;){var s=J$1(40);for(var i=0;i<s.length;++i){// Only accept values that are [0, maxMultiple), this ensures they can
// be evenly mapped to indices of `chars` via a modulo operation.
n.length<20&&s[i]<e&&(n+=t.charAt(s[i]%t.length));}}return n;}}]);return Y;}();function X$1(t,e){return t<e?-1:t>e?1:0;}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * Path represents an ordered sequence of string segments.
 */var st=/*#__PURE__*/function(){function st(t,e,n){_classCallCheck(this,st);void 0===e?e=0:e>t.length&&k$1(),void 0===n?n=t.length-e:n>t.length-e&&k$1(),this.segments=t,this.offset=e,this.len=n;}_createClass(st,[{key:"length",get:function get(){return this.len;}},{key:"isEqual",value:function isEqual(t){return 0===st.comparator(this,t);}},{key:"child",value:function child(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof st?t.forEach(function(t){e.push(t);}):e.push(t),this.construct(e);}/** The index of one past the last segment of the path. */},{key:"limit",value:function limit(){return this.offset+this.length;}},{key:"popFirst",value:function popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t);}},{key:"popLast",value:function popLast(){return this.construct(this.segments,this.offset,this.length-1);}},{key:"firstSegment",value:function firstSegment(){return this.segments[this.offset];}},{key:"lastSegment",value:function lastSegment(){return this.get(this.length-1);}},{key:"get",value:function get(t){return this.segments[this.offset+t];}},{key:"isEmpty",value:function isEmpty(){return 0===this.length;}},{key:"isPrefixOf",value:function isPrefixOf(t){if(t.length<this.length)return !1;for(var e=0;e<this.length;e++){if(this.get(e)!==t.get(e))return !1;}return !0;}},{key:"isImmediateParentOf",value:function isImmediateParentOf(t){if(this.length+1!==t.length)return !1;for(var e=0;e<this.length;e++){if(this.get(e)!==t.get(e))return !1;}return !0;}},{key:"forEach",value:function forEach(t){for(var e=this.offset,n=this.limit();e<n;e++){t(this.segments[e]);}}},{key:"toArray",value:function toArray(){return this.segments.slice(this.offset,this.limit());}}],[{key:"comparator",value:function comparator(t,e){var n=Math.min(t.length,e.length);for(var s=0;s<n;s++){var _n2=t.get(s),i=e.get(s);if(_n2<i)return -1;if(_n2>i)return 1;}return t.length<e.length?-1:t.length>e.length?1:0;}}]);return st;}();/**
 * A slash-separated path for navigating resources (documents and collections)
 * within Firestore.
 *
 * @internal
 */var it$1=/*#__PURE__*/function(_st){_inherits(it,_st);var _super2=_createSuper$1(it);function it(){_classCallCheck(this,it);return _super2.apply(this,arguments);}_createClass(it,[{key:"construct",value:function construct(t,e,n){return new it(t,e,n);}},{key:"canonicalString",value:function canonicalString(){// NOTE: The client is ignorant of any path segments containing escape
// sequences (e.g. __id123__) and just passes them through raw (they exist
// for legacy reasons and should not be used frequently).
return this.toArray().join("/");}},{key:"toString",value:function toString(){return this.canonicalString();}/**
     * Creates a resource path from the given slash-delimited string. If multiple
     * arguments are provided, all components are combined. Leading and trailing
     * slashes from all components are ignored.
     */}],[{key:"fromString",value:function fromString(){// NOTE: The client is ignorant of any path segments containing escape
// sequences (e.g. __id123__) and just passes them through raw (they exist
// for legacy reasons and should not be used frequently).
var e=[];for(var _len4=arguments.length,t=new Array(_len4),_key4=0;_key4<_len4;_key4++){t[_key4]=arguments[_key4];}for(var _i2=0,_t4=t;_i2<_t4.length;_i2++){var n=_t4[_i2];if(n.indexOf("//")>=0)throw new B($$1.INVALID_ARGUMENT,"Invalid segment (".concat(n,"). Paths must not contain // in them."));// Strip leading and traling slashed.
e.push.apply(e,_toConsumableArray(n.split("/").filter(function(t){return t.length>0;})));}return new it(e);}},{key:"emptyPath",value:function emptyPath(){return new it([]);}}]);return it;}(st);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * @internal
 */var ut=/*#__PURE__*/function(){function ut(t){_classCallCheck(this,ut);this.path=t;}_createClass(ut,[{key:"collectionGroup",get:function get(){return this.path.popLast().lastSegment();}/** Returns true if the document is in the specified collectionId. */},{key:"hasCollectionId",value:function hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t;}/** Returns the collection group (i.e. the name of the parent collection) for this key. */},{key:"getCollectionGroup",value:function getCollectionGroup(){return this.path.get(this.path.length-2);}/** Returns the fully qualified path to the parent collection. */},{key:"getCollectionPath",value:function getCollectionPath(){return this.path.popLast();}},{key:"isEqual",value:function isEqual(t){return null!==t&&0===it$1.comparator(this.path,t.path);}},{key:"toString",value:function toString(){return this.path.toString();}}],[{key:"fromPath",value:function fromPath(t){return new ut(it$1.fromString(t));}},{key:"fromName",value:function fromName(t){return new ut(it$1.fromString(t).popFirst(5));}},{key:"empty",value:function empty(){return new ut(it$1.emptyPath());}},{key:"comparator",value:function comparator(t,e){return it$1.comparator(t.path,e.path);}},{key:"isDocumentKey",value:function isDocumentKey(t){return t.length%2==0;}/**
     * Creates and returns a new document key with the given segments.
     *
     * @param segments - The segments of the path to the document
     * @returns A new instance of DocumentKey
     */},{key:"fromSegments",value:function fromSegments(t){return new ut(new it$1(t.slice()));}}]);return ut;}();/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * The initial mutation batch id for each index. Gets updated during index
 * backfill.
 */ /**
 * An index definition for field indexes in Firestore.
 *
 * Every index is associated with a collection. The definition contains a list
 * of fields and their index kind (which can be `ASCENDING`, `DESCENDING` or
 * `CONTAINS` for ArrayContains/ArrayContainsAny queries).
 *
 * Unlike the backend, the SDK does not differentiate between collection or
 * collection group-scoped indices. Every index can be used for both single
 * collection and collection group queries.
 */var ct=/*#__PURE__*/_createClass(function ct(/**
     * The index ID. Returns -1 if the index ID is not available (e.g. the index
     * has not yet been persisted).
     */t,/** The collection ID this index applies to. */e,/** The field segments for this index. */n,/** Shows how up-to-date the index is for the current user. */s){_classCallCheck(this,ct);this.indexId=t,this.collectionGroup=e,this.fields=n,this.indexState=s;});/** Returns a debug representation of the field index */ct.UNKNOWN_ID=-1;/** Verifies whether `e` is an IndexedDbTransactionError. */function vt$1(t){// Use name equality, as instanceof checks on errors don't work with errors
// that wrap other errors.
return "IndexedDbTransactionError"===t.name;}var $t$1=/*#__PURE__*/function(){function $t(t,e){_classCallCheck(this,$t);this.comparator=t,this.root=e||Lt$1.EMPTY;}// Returns a copy of the map, with the specified key/value added or replaced.
_createClass($t,[{key:"insert",value:function insert(t,e){return new $t(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Lt$1.BLACK,null,null));}// Returns a copy of the map, with the specified key removed.
},{key:"remove",value:function remove(t){return new $t(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Lt$1.BLACK,null,null));}// Returns the value of the node with the given key, or null.
},{key:"get",value:function get(t){var e=this.root;for(;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right);}return null;}// Returns the index of the element in this sorted map, or -1 if it doesn't
// exist.
},{key:"indexOf",value:function indexOf(t){// Number of nodes that were pruned when descending right
var e=0,n=this.root;for(;!n.isEmpty();){var s=this.comparator(t,n.key);if(0===s)return e+n.left.size;s<0?n=n.left:(// Count all nodes left of the node plus the node itself
e+=n.left.size+1,n=n.right);}// Node not found
return -1;}},{key:"isEmpty",value:function isEmpty(){return this.root.isEmpty();}// Returns the total number of nodes in the map.
},{key:"size",get:function get(){return this.root.size;}// Returns the minimum key in the map.
},{key:"minKey",value:function minKey(){return this.root.minKey();}// Returns the maximum key in the map.
},{key:"maxKey",value:function maxKey(){return this.root.maxKey();}// Traverses the map in key order and calls the specified action function
// for each key/value pair. If action returns true, traversal is aborted.
// Returns the first truthy value returned by action, or the last falsey
// value returned by action.
},{key:"inorderTraversal",value:function inorderTraversal(t){return this.root.inorderTraversal(t);}},{key:"forEach",value:function forEach(t){this.inorderTraversal(function(e,n){return t(e,n),!1;});}},{key:"toString",value:function toString(){var t=[];return this.inorderTraversal(function(e,n){return t.push("".concat(e,":").concat(n)),!1;}),"{".concat(t.join(", "),"}");}// Traverses the map in reverse key order and calls the specified action
// function for each key/value pair. If action returns true, traversal is
// aborted.
// Returns the first truthy value returned by action, or the last falsey
// value returned by action.
},{key:"reverseTraversal",value:function reverseTraversal(t){return this.root.reverseTraversal(t);}// Returns an iterator over the SortedMap.
},{key:"getIterator",value:function getIterator(){return new Bt(this.root,null,this.comparator,!1);}},{key:"getIteratorFrom",value:function getIteratorFrom(t){return new Bt(this.root,t,this.comparator,!1);}},{key:"getReverseIterator",value:function getReverseIterator(){return new Bt(this.root,null,this.comparator,!0);}},{key:"getReverseIteratorFrom",value:function getReverseIteratorFrom(t){return new Bt(this.root,t,this.comparator,!0);}}]);return $t;}();// end SortedMap
// An iterator over an LLRBNode.
var Bt=/*#__PURE__*/function(){function Bt(t,e,n,s){_classCallCheck(this,Bt);this.isReverse=s,this.nodeStack=[];var i=1;for(;!t.isEmpty();){if(i=e?n(t.key,e):1,// flip the comparison if we're going in reverse
e&&s&&(i*=-1),i<0)// This node is less than our start key. ignore it
t=this.isReverse?t.left:t.right;else {if(0===i){// This node is exactly equal to our start key. Push it on the stack,
// but stop iterating;
this.nodeStack.push(t);break;}// This node is greater than our start key, add it to the stack and move
// to the next one
this.nodeStack.push(t),t=this.isReverse?t.right:t.left;}}}_createClass(Bt,[{key:"getNext",value:function getNext(){var t=this.nodeStack.pop();var e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();){this.nodeStack.push(t),t=t.right;}else for(t=t.right;!t.isEmpty();){this.nodeStack.push(t),t=t.left;}return e;}},{key:"hasNext",value:function hasNext(){return this.nodeStack.length>0;}},{key:"peek",value:function peek(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return {key:t.key,value:t.value};}}]);return Bt;}();// end SortedMapIterator
// Represents a node in a Left-leaning Red-Black tree.
var Lt$1=/*#__PURE__*/function(){function Lt(t,e,n,s,i){_classCallCheck(this,Lt);this.key=t,this.value=e,this.color=null!=n?n:Lt.RED,this.left=null!=s?s:Lt.EMPTY,this.right=null!=i?i:Lt.EMPTY,this.size=this.left.size+1+this.right.size;}// Returns a copy of the current node, optionally replacing pieces of it.
_createClass(Lt,[{key:"copy",value:function copy(t,e,n,s,i){return new Lt(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=s?s:this.left,null!=i?i:this.right);}},{key:"isEmpty",value:function isEmpty(){return !1;}// Traverses the tree in key order and calls the specified action function
// for each node. If action returns true, traversal is aborted.
// Returns the first truthy value returned by action, or the last falsey
// value returned by action.
},{key:"inorderTraversal",value:function inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t);}// Traverses the tree in reverse key order and calls the specified action
// function for each node. If action returns true, traversal is aborted.
// Returns the first truthy value returned by action, or the last falsey
// value returned by action.
},{key:"reverseTraversal",value:function reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t);}// Returns the minimum node in the tree.
},{key:"min",value:function min(){return this.left.isEmpty()?this:this.left.min();}// Returns the maximum key in the tree.
},{key:"minKey",value:function minKey(){return this.min().key;}// Returns the maximum key in the tree.
},{key:"maxKey",value:function maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey();}// Returns new tree, with the key/value added.
},{key:"insert",value:function insert(t,e,n){var s=this;var i=n(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,n),null):0===i?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,n)),s.fixUp();}},{key:"removeMin",value:function removeMin(){if(this.left.isEmpty())return Lt.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp();}// Returns new tree, with the specified item removed.
},{key:"remove",value:function remove(t,e){var n,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else {if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return Lt.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin());}s=s.copy(null,null,null,null,s.right.remove(t,e));}return s.fixUp();}},{key:"isRed",value:function isRed(){return this.color;}// Returns new tree after performing any needed rotations.
},{key:"fixUp",value:function fixUp(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t;}},{key:"moveRedLeft",value:function moveRedLeft(){var t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t;}},{key:"moveRedRight",value:function moveRedRight(){var t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t;}},{key:"rotateLeft",value:function rotateLeft(){var t=this.copy(null,null,Lt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null);}},{key:"rotateRight",value:function rotateRight(){var t=this.copy(null,null,Lt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t);}},{key:"colorFlip",value:function colorFlip(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e);}// For testing.
},{key:"checkMaxDepth",value:function checkMaxDepth(){var t=this.check();return Math.pow(2,t)<=this.size+1;}// In a balanced RB tree, the black-depth (number of black nodes) from root to
// leaves is equal on both sides.  This function verifies that or asserts.
},{key:"check",value:function check(){if(this.isRed()&&this.left.isRed())throw k$1();if(this.right.isRed())throw k$1();var t=this.left.check();if(t!==this.right.check())throw k$1();return t+(this.isRed()?0:1);}}]);return Lt;}();// end LLRBNode
// Empty node is shared between all LLRB trees.
// eslint-disable-next-line @typescript-eslint/no-explicit-any
Lt$1.EMPTY=null,Lt$1.RED=!0,Lt$1.BLACK=!1;// end LLRBEmptyNode
Lt$1.EMPTY=new(/*#__PURE__*/ // Represents an empty node (a leaf node in the Red-Black Tree).
function(){function _class(){_classCallCheck(this,_class);this.size=0;}_createClass(_class,[{key:"key",get:function get(){throw k$1();}},{key:"value",get:function get(){throw k$1();}},{key:"color",get:function get(){throw k$1();}},{key:"left",get:function get(){throw k$1();}},{key:"right",get:function get(){throw k$1();}// Returns a copy of the current node.
},{key:"copy",value:function copy(t,e,n,s,i){return this;}// Returns a copy of the tree, with the specified key/value added.
},{key:"insert",value:function insert(t,e,n){return new Lt$1(t,e);}// Returns a copy of the tree, with the specified key removed.
},{key:"remove",value:function remove(t,e){return this;}},{key:"isEmpty",value:function isEmpty(){return !0;}},{key:"inorderTraversal",value:function inorderTraversal(t){return !1;}},{key:"reverseTraversal",value:function reverseTraversal(t){return !1;}},{key:"minKey",value:function minKey(){return null;}},{key:"maxKey",value:function maxKey(){return null;}},{key:"isRed",value:function isRed(){return !1;}// For testing.
},{key:"checkMaxDepth",value:function checkMaxDepth(){return !0;}},{key:"check",value:function check(){return 0;}}]);return _class;}())();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * SortedSet is an immutable (copy-on-write) collection that holds elements
 * in order specified by the provided comparator.
 *
 * NOTE: if provided comparator returns 0 for two elements, we consider them to
 * be equal!
 */var Ut=/*#__PURE__*/function(){function Ut(t){_classCallCheck(this,Ut);this.comparator=t,this.data=new $t$1(this.comparator);}_createClass(Ut,[{key:"has",value:function has(t){return null!==this.data.get(t);}},{key:"first",value:function first(){return this.data.minKey();}},{key:"last",value:function last(){return this.data.maxKey();}},{key:"size",get:function get(){return this.data.size;}},{key:"indexOf",value:function indexOf(t){return this.data.indexOf(t);}/** Iterates elements in order defined by "comparator" */},{key:"forEach",value:function forEach(t){this.data.inorderTraversal(function(e,n){return t(e),!1;});}/** Iterates over `elem`s such that: range[0] &lt;= elem &lt; range[1]. */},{key:"forEachInRange",value:function forEachInRange(t,e){var n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){var s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key);}}/**
     * Iterates over `elem`s such that: start &lt;= elem until false is returned.
     */},{key:"forEachWhile",value:function forEachWhile(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();){if(!t(n.getNext().key))return;}}/** Finds the least element greater than or equal to `elem`. */},{key:"firstAfterOrEqual",value:function firstAfterOrEqual(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null;}},{key:"getIterator",value:function getIterator(){return new qt$1(this.data.getIterator());}},{key:"getIteratorFrom",value:function getIteratorFrom(t){return new qt$1(this.data.getIteratorFrom(t));}/** Inserts or updates an element */},{key:"add",value:function add(t){return this.copy(this.data.remove(t).insert(t,!0));}/** Deletes an element */},{key:"delete",value:function _delete(t){return this.has(t)?this.copy(this.data.remove(t)):this;}},{key:"isEmpty",value:function isEmpty(){return this.data.isEmpty();}},{key:"unionWith",value:function unionWith(t){var e=this;// Make sure `result` always refers to the larger one of the two sets.
return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t);}),e;}},{key:"isEqual",value:function isEqual(t){if(!(t instanceof Ut))return !1;if(this.size!==t.size)return !1;var e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){var _t9=e.getNext().key,s=n.getNext().key;if(0!==this.comparator(_t9,s))return !1;}return !0;}},{key:"toArray",value:function toArray(){var t=[];return this.forEach(function(e){t.push(e);}),t;}},{key:"toString",value:function toString(){var t=[];return this.forEach(function(e){return t.push(e);}),"SortedSet("+t.toString()+")";}},{key:"copy",value:function copy(t){var e=new Ut(this.comparator);return e.data=t,e;}}]);return Ut;}();var qt$1=/*#__PURE__*/function(){function qt(t){_classCallCheck(this,qt);this.iter=t;}_createClass(qt,[{key:"getNext",value:function getNext(){return this.iter.getNext().key;}},{key:"hasNext",value:function hasNext(){return this.iter.hasNext();}}]);return qt;}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * Immutable class that represents a "proto" byte string.
 *
 * Proto byte strings can either be Base64-encoded strings or Uint8Arrays when
 * sent on the wire. This class abstracts away this differentiation by holding
 * the proto byte string in a common class that must be converted into a string
 * before being sent as a proto.
 * @internal
 */var jt=/*#__PURE__*/function(_Symbol$iterator){function jt(t){_classCallCheck(this,jt);this.binaryString=t;}_createClass(jt,[{key:_Symbol$iterator,value:function value(){var _this22=this;var t=0;return {next:function next(){return t<_this22.binaryString.length?{value:_this22.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0};}};}},{key:"toBase64",value:function toBase64(){return t=this.binaryString,btoa(t);/** Converts a binary string to a Base64 encoded string. */var t;}},{key:"toUint8Array",value:function toUint8Array(){return function(t){var e=new Uint8Array(t.length);for(var n=0;n<t.length;n++){e[n]=t.charCodeAt(n);}return e;}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ // A RegExp matching ISO 8601 UTC timestamps with optional fraction.
(this.binaryString);}},{key:"approximateByteSize",value:function approximateByteSize(){return 2*this.binaryString.length;}},{key:"compareTo",value:function compareTo(t){return X$1(this.binaryString,t.binaryString);}},{key:"isEqual",value:function isEqual(t){return this.binaryString===t.binaryString;}}],[{key:"fromBase64String",value:function fromBase64String(t){var e=atob(t);return new jt(e);}},{key:"fromUint8Array",value:function fromUint8Array(t){// TODO(indexing); Remove the copy of the byte string here as this method
// is frequently called during indexing.
var e=/**
 * Helper function to convert an Uint8array to a binary string.
 */function(t){var e="";for(var n=0;n<t.length;++n){e+=String.fromCharCode(t[n]);}return e;}/**
 * Helper function to convert a binary string to an Uint8Array.
 */(t);return new jt(e);}}]);return jt;}(Symbol.iterator);jt.EMPTY_BYTE_STRING=new jt("");/**
 * Converts the possible Proto types for numbers into a JavaScript number.
 * Returns 0 if the value is not numeric.
 */function Ht$1(t){// TODO(bjornick): Handle int64 greater than 53 bits.
return "number"==typeof t?t:"string"==typeof t?Number(t):0;}/** Converts the possible Proto types for Blobs into a ByteString. */function Jt(t){return "string"==typeof t?jt.fromBase64String(t):jt.fromUint8Array(t);}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var te=/*#__PURE__*/_createClass(/**
     * Constructs a DatabaseInfo using the provided host, databaseId and
     * persistenceKey.
     *
     * @param databaseId - The database to use.
     * @param appId - The Firebase App Id.
     * @param persistenceKey - A unique identifier for this Firestore's local
     * storage (used in conjunction with the databaseId).
     * @param host - The Firestore backend host to connect to.
     * @param ssl - Whether to use SSL when connecting.
     * @param forceLongPolling - Whether to use the forceLongPolling option
     * when using WebChannel as the network transport.
     * @param autoDetectLongPolling - Whether to use the detectBufferingProxy
     * option when using WebChannel as the network transport.
     * @param useFetchStreams Whether to use the Fetch API instead of
     * XMLHTTPRequest
     */function te(t,e,n,s,i,r,o,u){_classCallCheck(this,te);this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.useFetchStreams=u;});/** The default database name for a project. */ /**
 * Represents the database ID a Firestore client is associated with.
 * @internal
 */var ee=/*#__PURE__*/function(){function ee(t,e){_classCallCheck(this,ee);this.projectId=t,this.database=e||"(default)";}_createClass(ee,[{key:"isDefaultDatabase",get:function get(){return "(default)"===this.database;}},{key:"isEqual",value:function isEqual(t){return t instanceof ee&&t.projectId===this.projectId&&t.database===this.database;}}],[{key:"empty",value:function empty(){return new ee("","");}}]);return ee;}();/** Returns whether the value represents -0. */function se(t){// Detect if the value is -0.0. Based on polyfill from
// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is
return 0===t&&1/t==-1/0;}/** Returns true if the Value represents the canonical {@link #MAX_VALUE} . */function Te$1(t){return "__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue;}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * Error Codes describing the different ways GRPC can fail. These are copied
 * directly from GRPC's sources here:
 *
 * https://github.com/grpc/grpc/blob/bceec94ea4fc5f0085d81235d8e1c06798dc341a/include/grpc%2B%2B/impl/codegen/status_code_enum.h
 *
 * Important! The names of these identifiers matter because the string forms
 * are used for reverse lookups from the webchannel stream. Do NOT change the
 * names of these identifiers or change this into a const enum.
 */var Jn$1,Yn$1;/**
 * Converts an HTTP response's error status to the equivalent error code.
 *
 * @param status - An HTTP error response status ("FAILED_PRECONDITION",
 * "UNKNOWN", etc.)
 * @returns The equivalent Code. Non-matching responses are mapped to
 *     Code.UNKNOWN.
 */(Yn$1=Jn$1||(Jn$1={}))[Yn$1.OK=0]="OK",Yn$1[Yn$1.CANCELLED=1]="CANCELLED",Yn$1[Yn$1.UNKNOWN=2]="UNKNOWN",Yn$1[Yn$1.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Yn$1[Yn$1.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Yn$1[Yn$1.NOT_FOUND=5]="NOT_FOUND",Yn$1[Yn$1.ALREADY_EXISTS=6]="ALREADY_EXISTS",Yn$1[Yn$1.PERMISSION_DENIED=7]="PERMISSION_DENIED",Yn$1[Yn$1.UNAUTHENTICATED=16]="UNAUTHENTICATED",Yn$1[Yn$1.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Yn$1[Yn$1.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Yn$1[Yn$1.ABORTED=10]="ABORTED",Yn$1[Yn$1.OUT_OF_RANGE=11]="OUT_OF_RANGE",Yn$1[Yn$1.UNIMPLEMENTED=12]="UNIMPLEMENTED",Yn$1[Yn$1.INTERNAL=13]="INTERNAL",Yn$1[Yn$1.UNAVAILABLE=14]="UNAVAILABLE",Yn$1[Yn$1.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new $t$1(ut.comparator);new $t$1(ut.comparator);new $t$1(ut.comparator);new Ut(ut.comparator);new Ut(X$1);/**
 * Because we store all the useful information for this store in the key,
 * there is no useful information to store as the value. The raw (unencoded)
 * path cannot be stored because IndexedDb doesn't store prototype
 * information.
 */var Pi=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]);[].concat(_toConsumableArray(Pi),["documentOverlays"]);// Firestore was removed.
/** Firestore index value writer.  */var er=/*#__PURE__*/function(){function er(){_classCallCheck(this,er);}// The write methods below short-circuit writing terminators for values
// containing a (terminating) truncated value.
// As an example, consider the resulting encoding for:
// ["bar", [2, "foo"]] -> (STRING, "bar", TERM, ARRAY, NUMBER, 2, STRING, "foo", TERM, TERM, TERM)
// ["bar", [2, truncated("foo")]] -> (STRING, "bar", TERM, ARRAY, NUMBER, 2, STRING, "foo", TRUNC)
// ["bar", truncated(["foo"])] -> (STRING, "bar", TERM, ARRAY. STRING, "foo", TERM, TRUNC)
/** Writes an index value.  */_createClass(er,[{key:"ce",value:function ce(t,e){this.ae(t,e),// Write separator to split index values
// (see go/firestore-storage-format#encodings).
e.he();}},{key:"ae",value:function ae(t,e){if("nullValue"in t)this.le(e,5);else if("booleanValue"in t)this.le(e,10),e.fe(t.booleanValue?1:0);else if("integerValue"in t)this.le(e,15),e.fe(Ht$1(t.integerValue));else if("doubleValue"in t){var n=Ht$1(t.doubleValue);isNaN(n)?this.le(e,13):(this.le(e,15),se(n)?// -0.0, 0 and 0.0 are all considered the same
e.fe(0):e.fe(n));}else if("timestampValue"in t){var _n16=t.timestampValue;this.le(e,20),"string"==typeof _n16?e.de(_n16):(e.de("".concat(_n16.seconds||"")),e.fe(_n16.nanos||0));}else if("stringValue"in t)this._e(t.stringValue,e),this.we(e);else if("bytesValue"in t)this.le(e,30),e.me(Jt(t.bytesValue)),this.we(e);else if("referenceValue"in t)this.ge(t.referenceValue,e);else if("geoPointValue"in t){var _n17=t.geoPointValue;this.le(e,45),e.fe(_n17.latitude||0),e.fe(_n17.longitude||0);}else "mapValue"in t?Te$1(t)?this.le(e,Number.MAX_SAFE_INTEGER):(this.ye(t.mapValue,e),this.we(e)):"arrayValue"in t?(this.pe(t.arrayValue,e),this.we(e)):k$1();}},{key:"_e",value:function _e(t,e){this.le(e,25),this.Ie(t,e);}},{key:"Ie",value:function Ie(t,e){e.de(t);}},{key:"ye",value:function ye(t,e){var n=t.fields||{};this.le(e,55);for(var _i9=0,_Object$keys=Object.keys(n);_i9<_Object$keys.length;_i9++){var _t44=_Object$keys[_i9];this._e(_t44,e),this.ae(n[_t44],e);}}},{key:"pe",value:function pe(t,e){var n=t.values||[];this.le(e,50);var _iterator29=_createForOfIteratorHelper$1(n),_step29;try{for(_iterator29.s();!(_step29=_iterator29.n()).done;){var _t45=_step29.value;this.ae(_t45,e);}}catch(err){_iterator29.e(err);}finally{_iterator29.f();}}},{key:"ge",value:function ge(t,e){var _this48=this;this.le(e,37);ut.fromName(t).path.forEach(function(t){_this48.le(e,60),_this48.Ie(t,e);});}},{key:"le",value:function le(t,e){t.fe(e);}},{key:"we",value:function we(t){// While the SDK does not implement truncation, the truncation marker is
// used to terminate all variable length values (which are strings, bytes,
// references, arrays and maps).
t.fe(2);}}]);return er;}();er.Te=new er();var Er=/*#__PURE__*/function(){function Er(// When we attempt to collect, we will only do so if the cache size is greater than this
// threshold. Passing `COLLECTION_DISABLED` here will cause collection to always be skipped.
t,// The percentage of sequence numbers that we will attempt to collect
e,// A cap on the total number of sequence numbers that will be collected. This prevents
// us from collecting a huge number of sequence numbers if the cache has grown very large.
n){_classCallCheck(this,Er);this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n;}_createClass(Er,null,[{key:"withCacheSize",value:function withCacheSize(t){return new Er(t,Er.DEFAULT_COLLECTION_PERCENTILE,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT);}}]);return Er;}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /** A mutation queue for a specific user, backed by IndexedDB. */Er.DEFAULT_COLLECTION_PERCENTILE=10,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Er.DEFAULT=new Er(41943040,Er.DEFAULT_COLLECTION_PERCENTILE,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Er.DISABLED=new Er(-1,0,0);/** The Platform's 'document' implementation or null if not available. */function Yo(){// `document` is not always available, e.g. in ReactNative and WebWorkers.
// eslint-disable-next-line no-restricted-globals
return "undefined"!=typeof document?document:null;}/**
 * An instance of the Platform's 'TextEncoder' implementation.
 */ /**
 * A helper for running delayed tasks following an exponential backoff curve
 * between attempts.
 *
 * Each delay is made up of a "base" delay which follows the exponential
 * backoff curve, and a +/- 50% "jitter" that is calculated and added to the
 * base delay. This prevents clients from accidentally synchronizing their
 * delays causing spikes of load to the backend.
 */var Zo=/*#__PURE__*/function(){function Zo(/**
     * The AsyncQueue to run backoff operations on.
     */t,/**
     * The ID to use when scheduling backoff operations on the AsyncQueue.
     */e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1e3;var s=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1.5;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:6e4;_classCallCheck(this,Zo);this.Hs=t,this.timerId=e,this.wo=n,this.mo=s,this.yo=i,this.po=0,this.Io=null,/** The last backoff attempt, as epoch milliseconds. */this.To=Date.now(),this.reset();}/**
     * Resets the backoff delay.
     *
     * The very next backoffAndWait() will have no delay. If it is called again
     * (i.e. due to an error), initialDelayMs (plus jitter) will be used, and
     * subsequent ones will increase according to the backoffFactor.
     */_createClass(Zo,[{key:"reset",value:function reset(){this.po=0;}/**
     * Resets the backoff delay to the maximum delay (e.g. for use after a
     * RESOURCE_EXHAUSTED error).
     */},{key:"Eo",value:function Eo(){this.po=this.yo;}/**
     * Returns a promise that resolves after currentDelayMs, and increases the
     * delay for any subsequent attempts. If there was a pending backoff operation
     * already, it will be canceled.
     */},{key:"Ao",value:function Ao(t){var _this155=this;// Cancel any pending backoff operation.
this.cancel();// First schedule using the current base (which may be 0 and should be
// honored as such).
var e=Math.floor(this.po+this.Ro()),n=Math.max(0,Date.now()-this.To),s=Math.max(0,e-n);// Guard against lastAttemptTime being in the future due to a clock change.
s>0&&D$1("ExponentialBackoff","Backing off for ".concat(s," ms (base delay: ").concat(this.po," ms, delay with jitter: ").concat(e," ms, last attempt: ").concat(n," ms ago)")),this.Io=this.Hs.enqueueAfterDelay(this.timerId,s,function(){return _this155.To=Date.now(),t();}),// Apply backoff factor to determine next delay and ensure it is within
// bounds.
this.po*=this.mo,this.po<this.wo&&(this.po=this.wo),this.po>this.yo&&(this.po=this.yo);}},{key:"bo",value:function bo(){null!==this.Io&&(this.Io.skipDelay(),this.Io=null);}},{key:"cancel",value:function cancel(){null!==this.Io&&(this.Io.cancel(),this.Io=null);}/** Returns a random value in the range [-currentBaseMs/2, currentBaseMs/2] */},{key:"Ro",value:function Ro(){return (Math.random()-.5)*this.po;}}]);return Zo;}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * Represents an operation scheduled to be run in the future on an AsyncQueue.
 *
 * It is created via DelayedOperation.createAndSchedule().
 *
 * Supports cancellation (via cancel()) and early execution (via skipDelay()).
 *
 * Note: We implement `PromiseLike` instead of `Promise`, as the `Promise` type
 * in newer versions of TypeScript defines `finally`, which is not available in
 * IE.
 */var ku=/*#__PURE__*/function(){function ku(t,e,n,s,i){_classCallCheck(this,ku);this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new L$1(),this.then=this.deferred.promise.then.bind(this.deferred.promise),// It's normal for the deferred promise to be canceled (due to cancellation)
// and so we attach a dummy catch callback to avoid
// 'UnhandledPromiseRejectionWarning' log spam.
this.deferred.promise.catch(function(t){});}/**
     * Creates and returns a DelayedOperation that has been scheduled to be
     * executed on the provided asyncQueue after the provided delayMs.
     *
     * @param asyncQueue - The queue to schedule the operation on.
     * @param id - A Timer ID identifying the type of operation this is.
     * @param delayMs - The delay (ms) before the operation should be scheduled.
     * @param op - The operation to run.
     * @param removalCallback - A callback to be called synchronously once the
     *   operation is executed or canceled, notifying the AsyncQueue to remove it
     *   from its delayedOperations list.
     *   PORTING NOTE: This exists to prevent making removeDelayedOperation() and
     *   the DelayedOperation class public.
     */_createClass(ku,[{key:"start",value:/**
     * Starts the timer. This is called immediately after construction by
     * createAndSchedule().
     */function start(t){var _this169=this;this.timerHandle=setTimeout(function(){return _this169.handleDelayElapsed();},t);}/**
     * Queues the operation to run immediately (if it hasn't already been run or
     * canceled).
     */},{key:"skipDelay",value:function skipDelay(){return this.handleDelayElapsed();}/**
     * Cancels the operation if it hasn't already been executed or canceled. The
     * promise will be rejected.
     *
     * As long as the operation has not yet been run, calling cancel() provides a
     * guarantee that the operation will not be run.
     */},{key:"cancel",value:function cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new B($$1.CANCELLED,"Operation cancelled"+(t?": "+t:""))));}},{key:"handleDelayElapsed",value:function handleDelayElapsed(){var _this170=this;this.asyncQueue.enqueueAndForget(function(){return null!==_this170.timerHandle?(_this170.clearTimeout(),_this170.op().then(function(t){return _this170.deferred.resolve(t);})):Promise.resolve();});}},{key:"clearTimeout",value:function(_clearTimeout){function clearTimeout(){return _clearTimeout.apply(this,arguments);}clearTimeout.toString=function(){return _clearTimeout.toString();};return clearTimeout;}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null);})}],[{key:"createAndSchedule",value:function createAndSchedule(t,e,n,s,i){var r=Date.now()+n,o=new ku(t,e,r,s,i);return o.start(n),o;}}]);return ku;}();/**
 * Returns a FirestoreError that can be surfaced to the user if the provided
 * error is an IndexedDbTransactionError. Re-throws the error otherwise.
 */function Mu(t,e){if(C("AsyncQueue","".concat(e,": ").concat(t)),vt$1(t))return new B($$1.UNAVAILABLE,"".concat(e,": ").concat(t));throw t;}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * FirestoreClient is a top-level class that constructs and owns all of the
 * pieces of the client SDK architecture. It is responsible for creating the
 * async queue that is shared by all of the other components in the system.
 */var Gc=/*#__PURE__*/function(){function Gc(t,e,/**
     * Asynchronous queue responsible for all of our internal processing. When
     * we get incoming work from the user (via public API) or the network
     * (incoming GRPC messages), we should always schedule onto this queue.
     * This ensures all of our work is properly serialized (e.g. we don't
     * start processing a new operation while the previous one is waiting for
     * an async I/O to complete).
     */n,s){var _this187=this;_classCallCheck(this,Gc);this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=s,this.user=b$1.UNAUTHENTICATED,this.clientId=Y$1.R(),this.authCredentialListener=function(){return Promise.resolve();},this.appCheckCredentialListener=function(){return Promise.resolve();},this.authCredentials.start(n,/*#__PURE__*/function(){var _ref42=_asyncToGenerator(/*#__PURE__*/regenerator.mark(function _callee46(t){return regenerator.wrap(function _callee46$(_context46){while(1){switch(_context46.prev=_context46.next){case 0:D$1("FirestoreClient","Received user=",t.uid);_context46.next=3;return _this187.authCredentialListener(t);case 3:_this187.user=t;case 4:case"end":return _context46.stop();}}},_callee46);}));return function(_x117){return _ref42.apply(this,arguments);};}()),this.appCheckCredentials.start(n,function(t){return D$1("FirestoreClient","Received new app check token=",t),_this187.appCheckCredentialListener(t,_this187.user);});}_createClass(Gc,[{key:"getConfiguration",value:function(){var _getConfiguration=_asyncToGenerator(/*#__PURE__*/regenerator.mark(function _callee47(){return regenerator.wrap(function _callee47$(_context47){while(1){switch(_context47.prev=_context47.next){case 0:return _context47.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return _context47.stop();}}},_callee47,this);}));function getConfiguration(){return _getConfiguration.apply(this,arguments);}return getConfiguration;}()},{key:"setCredentialChangeListener",value:function setCredentialChangeListener(t){this.authCredentialListener=t;}},{key:"setAppCheckTokenChangeListener",value:function setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t;}/**
     * Checks that the client has not been terminated. Ensures that other methods on
     * this class cannot be called after the client is terminated.
     */},{key:"verifyNotTerminated",value:function verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new B($$1.FAILED_PRECONDITION,"The client has already been terminated.");}},{key:"terminate",value:function terminate(){var _this188=this;this.asyncQueue.enterRestrictedMode();var t=new L$1();return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/regenerator.mark(function _callee48(){var n;return regenerator.wrap(function _callee48$(_context48){while(1){switch(_context48.prev=_context48.next){case 0:_context48.prev=0;_context48.t0=_this188.onlineComponents;if(!_context48.t0){_context48.next=5;break;}_context48.next=5;return _this188.onlineComponents.terminate();case 5:_context48.t1=_this188.offlineComponents;if(!_context48.t1){_context48.next=9;break;}_context48.next=9;return _this188.offlineComponents.terminate();case 9:// The credentials provider must be terminated after shutting down the
// RemoteStore as it will prevent the RemoteStore from retrieving auth
// tokens.
_this188.authCredentials.shutdown();_this188.appCheckCredentials.shutdown();t.resolve();_context48.next=18;break;case 14:_context48.prev=14;_context48.t2=_context48["catch"](0);n=Mu(_context48.t2,"Failed to shutdown persistence");t.reject(n);case 18:case"end":return _context48.stop();}}},_callee48,null,[[0,14]]);}))),t.promise;}}]);return Gc;}();var ha=new Map();/**
 * Validates that two boolean options are not set at the same time.
 * @internal
 */function fa(t,e,n,s){if(!0===e&&!0===s)throw new B($$1.INVALID_ARGUMENT,"".concat(t," and ").concat(n," cannot be used together."));}/**
 * A concrete type describing all the values that can be applied via a
 * user-supplied `FirestoreSettings` object. This is a separate type so that
 * defaults can be supplied and the value can be checked for equality.
 */var ya=/*#__PURE__*/function(){function ya(t){_classCallCheck(this,ya);var e;if(void 0===t.host){if(void 0!==t.ssl)throw new B($$1.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=true;}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else {if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new B($$1.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes;}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,fa("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling);}_createClass(ya,[{key:"isEqual",value:function isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams;}}]);return ya;}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * The Cloud Firestore service interface.
 *
 * Do not call this constructor directly. Instead, use {@link getFirestore}.
 */var pa=/*#__PURE__*/function(){/** @hideconstructor */function pa(t,e,n,s){_classCallCheck(this,pa);this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=s,/**
         * Whether it's a Firestore or Firestore Lite instance.
         */this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ya({}),this._settingsFrozen=!1;}/**
     * The {@link @firebase/app#FirebaseApp} associated with this `Firestore` service
     * instance.
     */_createClass(pa,[{key:"app",get:function get(){if(!this._app)throw new B($$1.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app;}},{key:"_initialized",get:function get(){return this._settingsFrozen;}},{key:"_terminated",get:function get(){return void 0!==this._terminateTask;}},{key:"_setSettings",value:function _setSettings(t){if(this._settingsFrozen)throw new B($$1.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ya(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new q$1();switch(t.type){case"gapi":var e=t.client;return new j$1(e,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new B($$1.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type");}}(t.credentials));}},{key:"_getSettings",value:function _getSettings(){return this._settings;}},{key:"_freezeSettings",value:function _freezeSettings(){return this._settingsFrozen=!0,this._settings;}},{key:"_delete",value:function _delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask;}/** Returns a JSON-serializable representation of this `Firestore` instance. */},{key:"toJSON",value:function toJSON(){return {app:this._app,databaseId:this._databaseId,settings:this._settings};}/**
     * Terminates all components used by this client. Subclasses can override
     * this method to clean up their own dependencies, but must also call this
     * method.
     *
     * Only ever called once.
     */},{key:"_terminate",value:function _terminate(){/**
 * Removes all components associated with the provided instance. Must be called
 * when the `Firestore` instance is terminated.
 */return function(t){var e=ha.get(t);e&&(D$1("ComponentProvider","Removing Datastore"),ha.delete(t),e.terminate());}(this),Promise.resolve();}}]);return pa;}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sa=/*#__PURE__*/function(){function Sa(){var _this190=this;_classCallCheck(this,Sa);// The last promise in the queue.
this.$c=Promise.resolve(),// A list of retryable operations. Retryable operations are run in order and
// retried with backoff.
this.Bc=[],// Is this AsyncQueue being shut down? Once it is set to true, it will not
// be changed again.
this.Lc=!1,// Operations scheduled to be queued in the future. Operations are
// automatically removed after they are run or canceled.
this.Uc=[],// visible for testing
this.qc=null,// Flag set while there's an outstanding AsyncQueue operation, used for
// assertion sanity-checks.
this.Kc=!1,// Enabled during shutdown on Safari to prevent future access to IndexedDB.
this.Gc=!1,// List of TimerIds to fast-forward delays for.
this.Qc=[],// Backoff timer used to schedule retries for retryable operations
this.xo=new Zo(this,"async_queue_retry"/* AsyncQueueRetry */),// Visibility handler that triggers an immediate retry of all retryable
// operations. Meant to speed up recovery when we regain file system access
// after page comes into foreground.
this.jc=function(){var t=Yo();t&&D$1("AsyncQueue","Visibility state changed to "+t.visibilityState),_this190.xo.bo();};var t=Yo();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.jc);}_createClass(Sa,[{key:"isShuttingDown",get:function get(){return this.Lc;}/**
     * Adds a new operation to the queue without waiting for it to complete (i.e.
     * we ignore the Promise result).
     */},{key:"enqueueAndForget",value:function enqueueAndForget(t){// eslint-disable-next-line @typescript-eslint/no-floating-promises
this.enqueue(t);}},{key:"enqueueAndForgetEvenWhileRestricted",value:function enqueueAndForgetEvenWhileRestricted(t){this.Wc(),// eslint-disable-next-line @typescript-eslint/no-floating-promises
this.zc(t);}},{key:"enterRestrictedMode",value:function enterRestrictedMode(t){if(!this.Lc){this.Lc=!0,this.Gc=t||!1;var e=Yo();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.jc);}}},{key:"enqueue",value:function enqueue(t){var _this191=this;if(this.Wc(),this.Lc)// Return a Promise which never resolves.
return new Promise(function(){});// Create a deferred Promise that we can return to the callee. This
// allows us to return a "hanging Promise" only to the callee and still
// advance the queue even when the operation is not run.
var e=new L$1();return this.zc(function(){return _this191.Lc&&_this191.Gc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise);}).then(function(){return e.promise;});}},{key:"enqueueRetryable",value:function enqueueRetryable(t){var _this192=this;this.enqueueAndForget(function(){return _this192.Bc.push(t),_this192.Hc();});}/**
     * Runs the next operation from the retryable queue. If the operation fails,
     * reschedules with backoff.
     */},{key:"Hc",value:function(){var _Hc=_asyncToGenerator(/*#__PURE__*/regenerator.mark(function _callee63(){var _this193=this;return regenerator.wrap(function _callee63$(_context63){while(1){switch(_context63.prev=_context63.next){case 0:if(!(0!==this.Bc.length)){_context63.next=14;break;}_context63.prev=1;_context63.next=4;return this.Bc[0]();case 4:this.Bc.shift();this.xo.reset();_context63.next=13;break;case 8:_context63.prev=8;_context63.t0=_context63["catch"](1);if(vt$1(_context63.t0)){_context63.next=12;break;}throw _context63.t0;case 12:// Failure will be handled by AsyncQueue
D$1("AsyncQueue","Operation failed with retryable error: "+_context63.t0);case 13:this.Bc.length>0&&// If there are additional operations, we re-schedule `retryNextOp()`.
// This is necessary to run retryable operations that failed during
// their initial attempt since we don't know whether they are already
// enqueued. If, for example, `op1`, `op2`, `op3` are enqueued and `op1`
// needs to  be re-run, we will run `op1`, `op1`, `op2` using the
// already enqueued calls to `retryNextOp()`. `op3()` will then run in the
// call scheduled here.
// Since `backoffAndRun()` cancels an existing backoff and schedules a
// new backoff on every call, there is only ever a single additional
// operation in the queue.
this.xo.Ao(function(){return _this193.Hc();});case 14:case"end":return _context63.stop();}}},_callee63,this,[[1,8]]);}));function Hc(){return _Hc.apply(this,arguments);}return Hc;}()},{key:"zc",value:function zc(t){var _this194=this;var e=this.$c.then(function(){return _this194.Kc=!0,t().catch(function(t){_this194.qc=t,_this194.Kc=!1;var e=/**
 * Chrome includes Error.message in Error.stack. Other browsers do not.
 * This returns expected output of message + stack when available.
 * @param error - Error or FirestoreError
 */function(t){var e=t.message||"";t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack);return e;}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t);// Re-throw the error so that this.tail becomes a rejected Promise and
// all further attempts to chain (via .then) will just short-circuit
// and return the rejected Promise.
throw C("INTERNAL UNHANDLED ERROR: ",e),t;}).then(function(t){return _this194.Kc=!1,t;});});return this.$c=e,e;}},{key:"enqueueAfterDelay",value:function enqueueAfterDelay(t,e,n){var _this195=this;this.Wc(),// Fast-forward delays for timerIds that have been overriden.
this.Qc.indexOf(t)>-1&&(e=0);var s=ku.createAndSchedule(this,t,e,n,function(t){return _this195.Jc(t);});return this.Uc.push(s),s;}},{key:"Wc",value:function Wc(){this.qc&&k$1();}},{key:"verifyOperationInProgress",value:function verifyOperationInProgress(){}/**
     * Waits until all currently queued tasks are finished executing. Delayed
     * operations are not run.
     */},{key:"Yc",value:function(){var _Yc=_asyncToGenerator(/*#__PURE__*/regenerator.mark(function _callee64(){var t;return regenerator.wrap(function _callee64$(_context64){while(1){switch(_context64.prev=_context64.next){case 0:t=this.$c;_context64.next=3;return t;case 3:if(t!==this.$c){_context64.next=0;break;}case 4:case"end":return _context64.stop();}}},_callee64,this);}));function Yc(){return _Yc.apply(this,arguments);}return Yc;}()/**
     * For Tests: Determine if a delayed operation with a particular TimerId
     * exists.
     */},{key:"Xc",value:function Xc(t){var _iterator72=_createForOfIteratorHelper$1(this.Uc),_step72;try{for(_iterator72.s();!(_step72=_iterator72.n()).done;){var e=_step72.value;if(e.timerId===t)return !0;}}catch(err){_iterator72.e(err);}finally{_iterator72.f();}return !1;}/**
     * For Tests: Runs some or all delayed operations early.
     *
     * @param lastTimerId - Delayed operations up to and including this TimerId
     * will be drained. Pass TimerId.All to run all delayed operations.
     * @returns a Promise that resolves once all operations have been run.
     */},{key:"Zc",value:function Zc(t){var _this196=this;// Note that draining may generate more delayed ops, so we do that first.
return this.Yc().then(function(){// Run ops in the same order they'd run if they ran naturally.
_this196.Uc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs;});var _iterator73=_createForOfIteratorHelper$1(_this196.Uc),_step73;try{for(_iterator73.s();!(_step73=_iterator73.n()).done;){var e=_step73.value;if(e.skipDelay(),"all"/* All */!==t&&e.timerId===t)break;}}catch(err){_iterator73.e(err);}finally{_iterator73.f();}return _this196.Yc();});}/**
     * For Tests: Skip all subsequent delays for a timer id.
     */},{key:"ta",value:function ta(t){this.Qc.push(t);}/** Called once a DelayedOperation is run or canceled. */},{key:"Jc",value:function Jc(t){// NOTE: indexOf / slice are O(n), but delayedOperations is expected to be small.
var e=this.Uc.indexOf(t);this.Uc.splice(e,1);}}]);return Sa;}();/**
 * The Cloud Firestore service interface.
 *
 * Do not call this constructor directly. Instead, use {@link getFirestore}.
 */var Na=/*#__PURE__*/function(_pa){_inherits(Na,_pa);var _super32=_createSuper$1(Na);/** @hideconstructor */function Na(t,e,n,s){var _this197;_classCallCheck(this,Na);_this197=_super32.call(this,t,e,n,s),/**
         * Whether it's a {@link Firestore} or Firestore Lite instance.
         */_this197.type="firestore",_this197._queue=new Sa(),_this197._persistenceKey=(null==s?void 0:s.name)||"[DEFAULT]";return _this197;}_createClass(Na,[{key:"_terminate",value:function _terminate(){return this._firestoreClient||// The client must be initialized to ensure that all subsequent API
// usage throws an exception.
Fa(this),this._firestoreClient.terminate();}}]);return Na;}(pa);function Fa(t){var e;var n=t._freezeSettings(),s=function(t,e,n,s){return new te(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,s.useFetchStreams);}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Gc(t._authCredentials,t._appCheckCredentials,t._queue,s);}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /**
 * An immutable object representing an array of bytes.
 */var Ya=/*#__PURE__*/function(){/** @hideconstructor */function Ya(t){_classCallCheck(this,Ya);this._byteString=t;}/**
     * Creates a new `Bytes` object from the given Base64 string, converting it to
     * bytes.
     *
     * @param base64 - The Base64 string used to create the `Bytes` object.
     */_createClass(Ya,[{key:"toBase64",value:/**
     * Returns the underlying bytes as a Base64-encoded string.
     *
     * @returns The Base64-encoded string created from the `Bytes` object.
     */function toBase64(){return this._byteString.toBase64();}/**
     * Returns the underlying bytes in a new `Uint8Array`.
     *
     * @returns The Uint8Array created from the `Bytes` object.
     */},{key:"toUint8Array",value:function toUint8Array(){return this._byteString.toUint8Array();}/**
     * Returns a string representation of the `Bytes` object.
     *
     * @returns A string representation of the `Bytes` object.
     */},{key:"toString",value:function toString(){return "Bytes(base64: "+this.toBase64()+")";}/**
     * Returns true if this `Bytes` object is equal to the provided one.
     *
     * @param other - The `Bytes` object to compare against.
     * @returns true if this `Bytes` object is equal to the provided one.
     */},{key:"isEqual",value:function isEqual(t){return this._byteString.isEqual(t._byteString);}}],[{key:"fromBase64String",value:function fromBase64String(t){try{return new Ya(jt.fromBase64String(t));}catch(t){throw new B($$1.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t);}}/**
     * Creates a new `Bytes` object from the given Uint8Array.
     *
     * @param array - The Uint8Array used to create the `Bytes` object.
     */},{key:"fromUint8Array",value:function fromUint8Array(t){return new Ya(jt.fromUint8Array(t));}}]);return Ya;}();/**
 * Cloud Firestore
 *
 * @packageDocumentation
 */!function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;!function(t){P$1=t;}(SDK_VERSION),_registerComponent(new Component("firestore",function(t,_ref67){var n=_ref67.instanceIdentifier,s=_ref67.options;var i=t.getProvider("app").getImmediate(),r=new Na(new G$1(t.getProvider("auth-internal")),new z$1(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new B($$1.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ee(t.options.projectId,e);}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ /** Sentinel value that sorts before any Mutation Batch ID. */(i,n),i);return s=Object.assign({useFetchStreams:e},s),r._setSettings(s),r;},"PUBLIC").setMultipleInstances(!0)),registerVersion(R$1,"3.5.0",t),// BUILD_TARGET will be replaced by values like esm5, esm2017, cjs5, etc during the compilation
registerVersion(R$1,"3.5.0","esm2017");}();

function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e16) { throw _e16; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e17) { didErr = true; err = _e17; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Simple wrapper around a nullable UID. Mostly exists to make code more
 * readable.
 */

var l = /*#__PURE__*/function () {
  function l(t) {
    _classCallCheck(this, l);

    this.uid = t;
  }

  _createClass(l, [{
    key: "isAuthenticated",
    value: function isAuthenticated() {
      return null != this.uid;
    }
    /**
     * Returns a key representing this user, suitable for inclusion in a
     * dictionary.
     */

  }, {
    key: "toKey",
    value: function toKey() {
      return this.isAuthenticated() ? "uid:" + this.uid : "anonymous-user";
    }
  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return t.uid === this.uid;
    }
  }]);

  return l;
}();
/** A user with a null UID. */


l.UNAUTHENTICATED = new l(null), // TODO(mikelehen): Look into getting a proper uid-equivalent for
// non-FirebaseAuth providers.
l.GOOGLE_CREDENTIALS = new l("google-credentials-uid"), l.FIRST_PARTY = new l("first-party-uid"), l.MOCK_USER = new l("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var f = "9.10.0";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var d = new Logger("@firebase/firestore");

function m(t) {
  if (d.logLevel <= LogLevel.DEBUG) {
    for (var _len = arguments.length, e = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      e[_key - 1] = arguments[_key];
    }

    var n = e.map(_);
    d.debug.apply(d, ["Firestore (".concat(f, "): ").concat(t)].concat(_toConsumableArray(n)));
  }
}

function p(t) {
  if (d.logLevel <= LogLevel.ERROR) {
    for (var _len2 = arguments.length, e = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
      e[_key2 - 1] = arguments[_key2];
    }

    var n = e.map(_);
    d.error.apply(d, ["Firestore (".concat(f, "): ").concat(t)].concat(_toConsumableArray(n)));
  }
}
/**
 * @internal
 */


function y(t) {
  if (d.logLevel <= LogLevel.WARN) {
    for (var _len3 = arguments.length, e = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
      e[_key3 - 1] = arguments[_key3];
    }

    var n = e.map(_);
    d.warn.apply(d, ["Firestore (".concat(f, "): ").concat(t)].concat(_toConsumableArray(n)));
  }
}
/**
 * Converts an additional log parameter to a string representation.
 */


function _(t) {
  if ("string" == typeof t) return t;

  try {
    return e = t, JSON.stringify(e);
  } catch (e) {
    // Converting to JSON failed, just log the object directly
    return t;
  }
  /**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */

  /** Formats an object as a JSON string, suitable for logging. */


  var e;
}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Unconditionally fails, throwing an Error with the given message.
 * Messages are stripped in production builds.
 *
 * Returns `never` and can be used in expressions:
 * @example
 * let futureVar = fail('not implemented yet');
 */


function g() {
  var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "Unexpected state";
  // Log the failure in addition to throw an exception, just in case the
  // exception is swallowed.
  var e = "FIRESTORE (".concat(f, ") INTERNAL ASSERTION FAILED: ") + t; // NOTE: We don't use FirestoreError here because these are internal failures
  // that cannot be handled by the user. (Also it would create a circular
  // dependency between the error and assert modules which doesn't work.)

  throw p(e), new Error(e);
}
/**
 * Fails if the given assertion condition is false, throwing an Error with the
 * given message if it did.
 *
 * Messages are stripped in production builds.
 */


function v(t, e) {
  t || g();
}
/**
 * Casts `obj` to `T`. In non-production builds, verifies that `obj` is an
 * instance of `T` before casting.
 */


function b(t, // eslint-disable-next-line @typescript-eslint/no-explicit-any
e) {
  return t;
}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var E = "ok",
    T = "cancelled",
    I = "unknown",
    A = "invalid-argument",
    R = "deadline-exceeded",
    P = "not-found",
    N = "permission-denied",
    D = "unauthenticated",
    $ = "resource-exhausted",
    x = "failed-precondition",
    F = "aborted",
    S = "out-of-range",
    q = "unimplemented",
    O = "internal",
    k = "unavailable";
/** An error returned by a Firestore operation. */

var L = /*#__PURE__*/function (_FirebaseError) {
  _inherits(L, _FirebaseError);

  var _super = _createSuper(L);

  /** @hideconstructor */
  function L(
  /**
   * The backend error code associated with this error.
   */
  t,
  /**
   * A custom error description.
   */
  e) {
    var _this;

    _classCallCheck(this, L);

    _this = _super.call(this, t, e), _this.code = t, _this.message = e, // HACK: We write a toString property directly because Error is not a real
    // class and so inheritance does not work correctly. We could alternatively
    // do the same "back-door inheritance" trick that FirebaseError does.
    _this.toString = function () {
      return "".concat(_this.name, ": [code=").concat(_this.code, "]: ").concat(_this.message);
    };
    return _this;
  }

  return _createClass(L);
}(FirebaseError);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var U = /*#__PURE__*/_createClass(function U(t, e) {
  _classCallCheck(this, U);

  this.user = e, this.type = "OAuth", this.headers = new Map(), this.headers.set("Authorization", "Bearer ".concat(t));
});
/**
 * A CredentialsProvider that always yields an empty token.
 * @internal
 */


var j = /*#__PURE__*/function () {
  function j() {
    _classCallCheck(this, j);
  }

  _createClass(j, [{
    key: "getToken",
    value: function getToken() {
      return Promise.resolve(null);
    }
  }, {
    key: "invalidateToken",
    value: function invalidateToken() {}
  }, {
    key: "start",
    value: function start(t, e) {
      // Fire with initial user.
      t.enqueueRetryable(function () {
        return e(l.UNAUTHENTICATED);
      });
    }
  }, {
    key: "shutdown",
    value: function shutdown() {}
  }]);

  return j;
}();
/** Credential provider for the Lite SDK. */


var z = /*#__PURE__*/function () {
  function z(t) {
    var _this4 = this;

    _classCallCheck(this, z);

    this.auth = null, t.onInit(function (t) {
      _this4.auth = t;
    });
  }

  _createClass(z, [{
    key: "getToken",
    value: function getToken() {
      var _this5 = this;

      return this.auth ? this.auth.getToken().then(function (t) {
        return t ? (v("string" == typeof t.accessToken), new U(t.accessToken, new l(_this5.auth.getUid()))) : null;
      }) : Promise.resolve(null);
    }
  }, {
    key: "invalidateToken",
    value: function invalidateToken() {}
  }, {
    key: "start",
    value: function start(t, e) {}
  }, {
    key: "shutdown",
    value: function shutdown() {}
  }]);

  return z;
}();
/*
 * FirstPartyToken provides a fresh token each time its value
 * is requested, because if the token is too old, requests will be rejected.
 * Technically this may no longer be necessary since the SDK should gracefully
 * recover from unauthenticated errors (see b/33147818 for context), but it's
 * safer to keep the implementation as-is.
 */


var G = /*#__PURE__*/function () {
  function G(t, e, n, r) {
    _classCallCheck(this, G);

    this.t = t, this.i = e, this.o = n, this.u = r, this.type = "FirstParty", this.user = l.FIRST_PARTY, this.h = new Map();
  }
  /** Gets an authorization token, using a provided factory function, or falling back to First Party GAPI. */


  _createClass(G, [{
    key: "l",
    value: function l() {
      return this.u ? this.u() : ( // Make sure this really is a Gapi client.
      v(!("object" != _typeof$1(this.t) || null === this.t || !this.t.auth || !this.t.auth.getAuthHeaderValueForFirstParty)), this.t.auth.getAuthHeaderValueForFirstParty([]));
    }
  }, {
    key: "headers",
    get: function get() {
      this.h.set("X-Goog-AuthUser", this.i); // Use array notation to prevent minification

      var t = this.l();
      return t && this.h.set("Authorization", t), this.o && this.h.set("X-Goog-Iam-Authorization-Token", this.o), this.h;
    }
  }]);

  return G;
}();
/*
 * Provides user credentials required for the Firestore JavaScript SDK
 * to authenticate the user, using technique that is only available
 * to applications hosted by Google.
 */


var W = /*#__PURE__*/function () {
  function W(t, e, n, r) {
    _classCallCheck(this, W);

    this.t = t, this.i = e, this.o = n, this.u = r;
  }

  _createClass(W, [{
    key: "getToken",
    value: function getToken() {
      return Promise.resolve(new G(this.t, this.i, this.o, this.u));
    }
  }, {
    key: "start",
    value: function start(t, e) {
      // Fire with initial uid.
      t.enqueueRetryable(function () {
        return e(l.FIRST_PARTY);
      });
    }
  }, {
    key: "shutdown",
    value: function shutdown() {}
  }, {
    key: "invalidateToken",
    value: function invalidateToken() {}
  }]);

  return W;
}();

var K = /*#__PURE__*/_createClass(function K(t) {
  _classCallCheck(this, K);

  this.value = t, this.type = "AppCheck", this.headers = new Map(), t && t.length > 0 && this.headers.set("x-firebase-appcheck", this.value);
});
/** AppCheck token provider for the Lite SDK. */


var Q = /*#__PURE__*/function () {
  function Q(t) {
    var _this6 = this;

    _classCallCheck(this, Q);

    this.m = t, this.appCheck = null, t.onInit(function (t) {
      _this6.appCheck = t;
    });
  }

  _createClass(Q, [{
    key: "getToken",
    value: function getToken() {
      return this.appCheck ? this.appCheck.getToken().then(function (t) {
        return t ? (v("string" == typeof t.token), new K(t.token)) : null;
      }) : Promise.resolve(null);
    }
  }, {
    key: "invalidateToken",
    value: function invalidateToken() {}
  }, {
    key: "start",
    value: function start(t, e) {}
  }, {
    key: "shutdown",
    value: function shutdown() {}
  }]);

  return Q;
}();
/**
 * Builds a CredentialsProvider depending on the type of
 * the credentials passed in.
 */

/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var Y = /*#__PURE__*/_createClass(
/**
 * Constructs a DatabaseInfo using the provided host, databaseId and
 * persistenceKey.
 *
 * @param databaseId - The database to use.
 * @param appId - The Firebase App Id.
 * @param persistenceKey - A unique identifier for this Firestore's local
 * storage (used in conjunction with the databaseId).
 * @param host - The Firestore backend host to connect to.
 * @param ssl - Whether to use SSL when connecting.
 * @param forceLongPolling - Whether to use the forceLongPolling option
 * when using WebChannel as the network transport.
 * @param autoDetectLongPolling - Whether to use the detectBufferingProxy
 * option when using WebChannel as the network transport.
 * @param useFetchStreams Whether to use the Fetch API instead of
 * XMLHTTPRequest
 */
function Y(t, e, n, r, s, i, o, u) {
  _classCallCheck(this, Y);

  this.databaseId = t, this.appId = e, this.persistenceKey = n, this.host = r, this.ssl = s, this.forceLongPolling = i, this.autoDetectLongPolling = o, this.useFetchStreams = u;
});
/** The default database name for a project. */

/**
 * Represents the database ID a Firestore client is associated with.
 * @internal
 */


var H = /*#__PURE__*/function () {
  function H(t, e) {
    _classCallCheck(this, H);

    this.projectId = t, this.database = e || "(default)";
  }

  _createClass(H, [{
    key: "isDefaultDatabase",
    get: function get() {
      return "(default)" === this.database;
    }
  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return t instanceof H && t.projectId === this.projectId && t.database === this.database;
    }
  }], [{
    key: "empty",
    value: function empty() {
      return new H("", "");
    }
  }]);

  return H;
}();
/**
 * Path represents an ordered sequence of string segments.
 */


var J = /*#__PURE__*/function () {
  function J(t, e, n) {
    _classCallCheck(this, J);

    void 0 === e ? e = 0 : e > t.length && g(), void 0 === n ? n = t.length - e : n > t.length - e && g(), this.segments = t, this.offset = e, this.len = n;
  }

  _createClass(J, [{
    key: "length",
    get: function get() {
      return this.len;
    }
  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return 0 === J.comparator(this, t);
    }
  }, {
    key: "child",
    value: function child(t) {
      var e = this.segments.slice(this.offset, this.limit());
      return t instanceof J ? t.forEach(function (t) {
        e.push(t);
      }) : e.push(t), this.construct(e);
    }
    /** The index of one past the last segment of the path. */

  }, {
    key: "limit",
    value: function limit() {
      return this.offset + this.length;
    }
  }, {
    key: "popFirst",
    value: function popFirst(t) {
      return t = void 0 === t ? 1 : t, this.construct(this.segments, this.offset + t, this.length - t);
    }
  }, {
    key: "popLast",
    value: function popLast() {
      return this.construct(this.segments, this.offset, this.length - 1);
    }
  }, {
    key: "firstSegment",
    value: function firstSegment() {
      return this.segments[this.offset];
    }
  }, {
    key: "lastSegment",
    value: function lastSegment() {
      return this.get(this.length - 1);
    }
  }, {
    key: "get",
    value: function get(t) {
      return this.segments[this.offset + t];
    }
  }, {
    key: "isEmpty",
    value: function isEmpty() {
      return 0 === this.length;
    }
  }, {
    key: "isPrefixOf",
    value: function isPrefixOf(t) {
      if (t.length < this.length) return !1;

      for (var e = 0; e < this.length; e++) {
        if (this.get(e) !== t.get(e)) return !1;
      }

      return !0;
    }
  }, {
    key: "isImmediateParentOf",
    value: function isImmediateParentOf(t) {
      if (this.length + 1 !== t.length) return !1;

      for (var e = 0; e < this.length; e++) {
        if (this.get(e) !== t.get(e)) return !1;
      }

      return !0;
    }
  }, {
    key: "forEach",
    value: function forEach(t) {
      for (var e = this.offset, n = this.limit(); e < n; e++) {
        t(this.segments[e]);
      }
    }
  }, {
    key: "toArray",
    value: function toArray() {
      return this.segments.slice(this.offset, this.limit());
    }
  }], [{
    key: "comparator",
    value: function comparator(t, e) {
      var n = Math.min(t.length, e.length);

      for (var r = 0; r < n; r++) {
        var _n2 = t.get(r),
            s = e.get(r);

        if (_n2 < s) return -1;
        if (_n2 > s) return 1;
      }

      return t.length < e.length ? -1 : t.length > e.length ? 1 : 0;
    }
  }]);

  return J;
}();
/**
 * A slash-separated path for navigating resources (documents and collections)
 * within Firestore.
 *
 * @internal
 */


var X = /*#__PURE__*/function (_J) {
  _inherits(X, _J);

  var _super2 = _createSuper(X);

  function X() {
    _classCallCheck(this, X);

    return _super2.apply(this, arguments);
  }

  _createClass(X, [{
    key: "construct",
    value: function construct(t, e, n) {
      return new X(t, e, n);
    }
  }, {
    key: "canonicalString",
    value: function canonicalString() {
      // NOTE: The client is ignorant of any path segments containing escape
      // sequences (e.g. __id123__) and just passes them through raw (they exist
      // for legacy reasons and should not be used frequently).
      return this.toArray().join("/");
    }
  }, {
    key: "toString",
    value: function toString() {
      return this.canonicalString();
    }
    /**
     * Creates a resource path from the given slash-delimited string. If multiple
     * arguments are provided, all components are combined. Leading and trailing
     * slashes from all components are ignored.
     */

  }], [{
    key: "fromString",
    value: function fromString() {
      // NOTE: The client is ignorant of any path segments containing escape
      // sequences (e.g. __id123__) and just passes them through raw (they exist
      // for legacy reasons and should not be used frequently).
      var e = [];

      for (var _len4 = arguments.length, t = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
        t[_key4] = arguments[_key4];
      }

      for (var _i = 0, _t2 = t; _i < _t2.length; _i++) {
        var n = _t2[_i];
        if (n.indexOf("//") >= 0) throw new L(A, "Invalid segment (".concat(n, "). Paths must not contain // in them.")); // Strip leading and traling slashed.

        e.push.apply(e, _toConsumableArray(n.split("/").filter(function (t) {
          return t.length > 0;
        })));
      }

      return new X(e);
    }
  }, {
    key: "emptyPath",
    value: function emptyPath() {
      return new X([]);
    }
  }]);

  return X;
}(J);

var Z = /^[_a-zA-Z][_a-zA-Z0-9]*$/;
/**
 * A dot-separated path for navigating sub-objects within a document.
 * @internal
 */

var tt = /*#__PURE__*/function (_J2) {
  _inherits(tt, _J2);

  var _super3 = _createSuper(tt);

  function tt() {
    _classCallCheck(this, tt);

    return _super3.apply(this, arguments);
  }

  _createClass(tt, [{
    key: "construct",
    value: function construct(t, e, n) {
      return new tt(t, e, n);
    }
    /**
     * Returns true if the string could be used as a segment in a field path
     * without escaping.
     */

  }, {
    key: "canonicalString",
    value: function canonicalString() {
      return this.toArray().map(function (t) {
        return t = t.replace(/\\/g, "\\\\").replace(/`/g, "\\`"), tt.isValidIdentifier(t) || (t = "`" + t + "`"), t;
      }).join(".");
    }
  }, {
    key: "toString",
    value: function toString() {
      return this.canonicalString();
    }
    /**
     * Returns true if this field references the key of a document.
     */

  }, {
    key: "isKeyField",
    value: function isKeyField() {
      return 1 === this.length && "__name__" === this.get(0);
    }
    /**
     * The field designating the key of a document.
     */

  }], [{
    key: "isValidIdentifier",
    value: function isValidIdentifier(t) {
      return Z.test(t);
    }
  }, {
    key: "keyField",
    value: function keyField() {
      return new tt(["__name__"]);
    }
    /**
     * Parses a field string from the given server-formatted string.
     *
     * - Splitting the empty string is not allowed (for now at least).
     * - Empty segments within the string (e.g. if there are two consecutive
     *   separators) are not allowed.
     *
     * TODO(b/37244157): we should make this more strict. Right now, it allows
     * non-identifier path components, even if they aren't escaped.
     */

  }, {
    key: "fromServerFormat",
    value: function fromServerFormat(t) {
      var e = [];
      var n = "",
          r = 0;

      var s = function s() {
        if (0 === n.length) throw new L(A, "Invalid field path (".concat(t, "). Paths must not be empty, begin with '.', end with '.', or contain '..'"));
        e.push(n), n = "";
      };

      var i = !1;

      for (; r < t.length;) {
        var _e2 = t[r];

        if ("\\" === _e2) {
          if (r + 1 === t.length) throw new L(A, "Path has trailing escape character: " + t);
          var _e3 = t[r + 1];
          if ("\\" !== _e3 && "." !== _e3 && "`" !== _e3) throw new L(A, "Path has invalid escape sequence: " + t);
          n += _e3, r += 2;
        } else "`" === _e2 ? (i = !i, r++) : "." !== _e2 || i ? (n += _e2, r++) : (s(), r++);
      }

      if (s(), i) throw new L(A, "Unterminated ` in path: " + t);
      return new tt(e);
    }
  }, {
    key: "emptyPath",
    value: function emptyPath() {
      return new tt([]);
    }
  }]);

  return tt;
}(J);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * @internal
 */


var et = /*#__PURE__*/function () {
  function et(t) {
    _classCallCheck(this, et);

    this.path = t;
  }

  _createClass(et, [{
    key: "collectionGroup",
    get: function get() {
      return this.path.popLast().lastSegment();
    }
    /** Returns true if the document is in the specified collectionId. */

  }, {
    key: "hasCollectionId",
    value: function hasCollectionId(t) {
      return this.path.length >= 2 && this.path.get(this.path.length - 2) === t;
    }
    /** Returns the collection group (i.e. the name of the parent collection) for this key. */

  }, {
    key: "getCollectionGroup",
    value: function getCollectionGroup() {
      return this.path.get(this.path.length - 2);
    }
    /** Returns the fully qualified path to the parent collection. */

  }, {
    key: "getCollectionPath",
    value: function getCollectionPath() {
      return this.path.popLast();
    }
  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return null !== t && 0 === X.comparator(this.path, t.path);
    }
  }, {
    key: "toString",
    value: function toString() {
      return this.path.toString();
    }
  }], [{
    key: "fromPath",
    value: function fromPath(t) {
      return new et(X.fromString(t));
    }
  }, {
    key: "fromName",
    value: function fromName(t) {
      return new et(X.fromString(t).popFirst(5));
    }
  }, {
    key: "empty",
    value: function empty() {
      return new et(X.emptyPath());
    }
  }, {
    key: "comparator",
    value: function comparator(t, e) {
      return X.comparator(t.path, e.path);
    }
  }, {
    key: "isDocumentKey",
    value: function isDocumentKey(t) {
      return t.length % 2 == 0;
    }
    /**
     * Creates and returns a new document key with the given segments.
     *
     * @param segments - The segments of the path to the document
     * @returns A new instance of DocumentKey
     */

  }, {
    key: "fromSegments",
    value: function fromSegments(t) {
      return new et(new X(t.slice()));
    }
  }]);

  return et;
}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


function nt(t, e, n) {
  if (!n) throw new L(A, "Function ".concat(t, "() cannot be called with an empty ").concat(e, "."));
}
/**
 * Validates that two boolean options are not set at the same time.
 * @internal
 */

/**
 * Validates that `path` refers to a document (indicated by the fact it contains
 * an even numbers of segments).
 */


function rt(t) {
  if (!et.isDocumentKey(t)) throw new L(A, "Invalid document reference. Document references must have an even number of segments, but ".concat(t, " has ").concat(t.length, "."));
}
/**
 * Returns true if it's a non-null object without a custom prototype
 * (i.e. excludes Array, Date, etc.).
 */

/** Returns a string describing the type / value of the provided input. */


function it(t) {
  if (void 0 === t) return "undefined";
  if (null === t) return "null";
  if ("string" == typeof t) return t.length > 20 && (t = "".concat(t.substring(0, 20), "...")), JSON.stringify(t);
  if ("number" == typeof t || "boolean" == typeof t) return "" + t;

  if ("object" == _typeof$1(t)) {
    if (t instanceof Array) return "an array";
    {
      var e =
      /** try to get the constructor name for an object. */
      function (t) {
        if (t.constructor) return t.constructor.name;
        return null;
      }
      /**
      * Casts `obj` to `T`, optionally unwrapping Compat types to expose the
      * underlying instance. Throws if  `obj` is not an instance of `T`.
      *
      * This cast is used in the Lite and Full SDK to verify instance types for
      * arguments passed to the public API.
      * @internal
      */
      (t);

      return e ? "a custom ".concat(e, " object") : "an object";
    }
  }

  return "function" == typeof t ? "a function" : g();
}

function ot(t, // eslint-disable-next-line @typescript-eslint/no-explicit-any
e) {
  if ("_delegate" in t && ( // Unwrap Compat types
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  t = t._delegate), !(t instanceof e)) {
    if (e.name === t.constructor.name) throw new L(A, "Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");
    {
      var n = it(t);
      throw new L(A, "Expected type '".concat(e.name, "', but it was: ").concat(n));
    }
  }

  return t;
}
/** Returns whether the value represents -0. */


function at(t) {
  // Detect if the value is -0.0. Based on polyfill from
  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is
  return 0 === t && 1 / t == -1 / 0;
}
/**
 * Returns whether a value is an integer and in the safe integer range
 * @param value - The value to test for being an integer and in the safe range
 */

/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var ht = {
  BatchGetDocuments: "batchGet",
  Commit: "commit",
  RunQuery: "runQuery"
};
/**
 * Maps RPC names to the corresponding REST endpoint name.
 *
 * We use array notation to avoid mangling.
 */

/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Error Codes describing the different ways GRPC can fail. These are copied
 * directly from GRPC's sources here:
 *
 * https://github.com/grpc/grpc/blob/bceec94ea4fc5f0085d81235d8e1c06798dc341a/include/grpc%2B%2B/impl/codegen/status_code_enum.h
 *
 * Important! The names of these identifiers matter because the string forms
 * are used for reverse lookups from the webchannel stream. Do NOT change the
 * names of these identifiers or change this into a const enum.
 */

var lt, ft;
/**
 * Converts an HTTP Status Code to the equivalent error code.
 *
 * @param status - An HTTP Status Code, like 200, 404, 503, etc.
 * @returns The equivalent Code. Unknown status codes are mapped to
 *     Code.UNKNOWN.
 */

function dt(t) {
  if (void 0 === t) return p("RPC_ERROR", "HTTP error has no status"), I; // The canonical error codes for Google APIs [1] specify mapping onto HTTP
  // status codes but the mapping is not bijective. In each case of ambiguity
  // this function chooses a primary error.
  // [1]
  // https://github.com/googleapis/googleapis/blob/master/google/rpc/code.proto

  switch (t) {
    case 200:
      // OK
      return E;

    case 400:
      // Bad Request
      return x;
    // Other possibilities based on the forward mapping
    // return Code.INVALID_ARGUMENT;
    // return Code.OUT_OF_RANGE;

    case 401:
      // Unauthorized
      return D;

    case 403:
      // Forbidden
      return N;

    case 404:
      // Not Found
      return P;

    case 409:
      // Conflict
      return F;
    // Other possibilities:
    // return Code.ALREADY_EXISTS;

    case 416:
      // Range Not Satisfiable
      return S;

    case 429:
      // Too Many Requests
      return $;

    case 499:
      // Client Closed Request
      return T;

    case 500:
      // Internal Server Error
      return I;
    // Other possibilities:
    // return Code.INTERNAL;
    // return Code.DATA_LOSS;

    case 501:
      // Unimplemented
      return q;

    case 503:
      // Service Unavailable
      return k;

    case 504:
      // Gateway Timeout
      return R;

    default:
      return t >= 200 && t < 300 ? E : t >= 400 && t < 500 ? x : t >= 500 && t < 600 ? O : I;
  }
}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * A Rest-based connection that relies on the native HTTP stack
 * (e.g. `fetch` or a polyfill).
 */


(ft = lt || (lt = {}))[ft.OK = 0] = "OK", ft[ft.CANCELLED = 1] = "CANCELLED", ft[ft.UNKNOWN = 2] = "UNKNOWN", ft[ft.INVALID_ARGUMENT = 3] = "INVALID_ARGUMENT", ft[ft.DEADLINE_EXCEEDED = 4] = "DEADLINE_EXCEEDED", ft[ft.NOT_FOUND = 5] = "NOT_FOUND", ft[ft.ALREADY_EXISTS = 6] = "ALREADY_EXISTS", ft[ft.PERMISSION_DENIED = 7] = "PERMISSION_DENIED", ft[ft.UNAUTHENTICATED = 16] = "UNAUTHENTICATED", ft[ft.RESOURCE_EXHAUSTED = 8] = "RESOURCE_EXHAUSTED", ft[ft.FAILED_PRECONDITION = 9] = "FAILED_PRECONDITION", ft[ft.ABORTED = 10] = "ABORTED", ft[ft.OUT_OF_RANGE = 11] = "OUT_OF_RANGE", ft[ft.UNIMPLEMENTED = 12] = "UNIMPLEMENTED", ft[ft.INTERNAL = 13] = "INTERNAL", ft[ft.UNAVAILABLE = 14] = "UNAVAILABLE", ft[ft.DATA_LOSS = 15] = "DATA_LOSS";

var wt = /*#__PURE__*/function (_ref) {
  _inherits(wt, _ref);

  var _super4 = _createSuper(wt);

  /**
   * @param databaseInfo - The connection info.
   * @param fetchImpl - `fetch` or a Polyfill that implements the fetch API.
   */
  function wt(t, e) {
    var _this7;

    _classCallCheck(this, wt);

    _this7 = _super4.call(this, t), _this7.P = e;
    return _this7;
  }

  _createClass(wt, [{
    key: "V",
    value: function V(t, e) {
      throw new Error("Not supported by FetchConnection");
    }
  }, {
    key: "A",
    value: function () {
      var _A = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(t, e, n, r) {
        var s, i;
        return regenerator.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                s = JSON.stringify(r);
                _context.prev = 1;
                _context.next = 4;
                return this.P(e, {
                  method: "POST",
                  headers: n,
                  body: s
                });

              case 4:
                i = _context.sent;
                _context.next = 10;
                break;

              case 7:
                _context.prev = 7;
                _context.t0 = _context["catch"](1);
                throw new L(dt(_context.t0.status), "Request failed with error: " + _context.t0.statusText);

              case 10:
                if (i.ok) {
                  _context.next = 12;
                  break;
                }

                throw new L(dt(i.status), "Request failed with error: " + i.statusText);

              case 12:
                return _context.abrupt("return", i.json());

              case 13:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this, [[1, 7]]);
      }));

      function A(_x, _x2, _x3, _x4) {
        return _A.apply(this, arguments);
      }

      return A;
    }()
  }]);

  return wt;
}(
/*#__PURE__*/

/**
 * Base class for all Rest-based connections to the backend (WebChannel and
 * HTTP).
 */
function () {
  function _class(t) {
    _classCallCheck(this, _class);

    this.databaseInfo = t, this.databaseId = t.databaseId;
    var e = t.ssl ? "https" : "http";
    this.p = e + "://" + t.host, this.g = "projects/" + this.databaseId.projectId + "/databases/" + this.databaseId.database + "/documents";
  }

  _createClass(_class, [{
    key: "v",
    value: function v(t, e, n, r, s) {
      var i = this.T(t, e);
      m("RestConnection", "Sending: ", i, n);
      var o = {};
      return this.I(o, r, s), this.A(t, i, o, n).then(function (t) {
        return m("RestConnection", "Received: ", t), t;
      }, function (e) {
        throw y("RestConnection", "".concat(t, " failed with error: "), e, "url: ", i, "request:", n), e;
      });
    }
  }, {
    key: "R",
    value: function R(t, e, n, r, s, i) {
      // The REST API automatically aggregates all of the streamed results, so we
      // can just use the normal invoke() method.
      return this.v(t, e, n, r, s);
    }
    /**
     * Modifies the headers for a request, adding any authorization token if
     * present and any additional headers for the request.
     */

  }, {
    key: "I",
    value: function I(t, e, n) {
      t["X-Goog-Api-Client"] = "gl-js/ fire/" + f, // Content-Type: text/plain will avoid preflight requests which might
      // mess with CORS and redirects by proxies. If we add custom headers
      // we will need to change this code to potentially use the $httpOverwrite
      // parameter supported by ESF to avoid triggering preflight requests.
      t["Content-Type"] = "text/plain", this.databaseInfo.appId && (t["X-Firebase-GMPID"] = this.databaseInfo.appId), e && e.headers.forEach(function (e, n) {
        return t[n] = e;
      }), n && n.headers.forEach(function (e, n) {
        return t[n] = e;
      });
    }
  }, {
    key: "T",
    value: function T(t, e) {
      var n = ht[t];
      return "".concat(this.p, "/v1/").concat(e, ":").concat(n);
    }
  }]);

  return _class;
}());
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/** Initializes the HTTP connection for the REST API. */

/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Generates `nBytes` of random bytes.
 *
 * If `nBytes < 0` , an error will be thrown.
 */


function mt(t) {
  // Polyfills for IE and WebWorker by using `self` and `msCrypto` when `crypto` is not available.
  var e = // eslint-disable-next-line @typescript-eslint/no-explicit-any
  "undefined" != typeof self && (self.crypto || self.msCrypto),
      n = new Uint8Array(t);
  if (e && "function" == typeof e.getRandomValues) e.getRandomValues(n);else // Falls back to Math.random
    for (var _e4 = 0; _e4 < t; _e4++) {
      n[_e4] = Math.floor(256 * Math.random());
    }
  return n;
}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var pt = /*#__PURE__*/function () {
  function pt() {
    _classCallCheck(this, pt);
  }

  _createClass(pt, null, [{
    key: "N",
    value: function N() {
      // Alphanumeric characters
      var t = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",
          e = Math.floor(256 / t.length) * t.length; // The largest byte value that is a multiple of `char.length`.

      var n = "";

      for (; n.length < 20;) {
        var r = mt(40);

        for (var s = 0; s < r.length; ++s) {
          // Only accept values that are [0, maxMultiple), this ensures they can
          // be evenly mapped to indices of `chars` via a modulo operation.
          n.length < 20 && r[s] < e && (n += t.charAt(r[s] % t.length));
        }
      }

      return n;
    }
  }]);

  return pt;
}();

function yt(t, e) {
  return t < e ? -1 : t > e ? 1 : 0;
}
/** Helper to compare arrays using isEqual(). */


function _t(t, e, n) {
  return t.length === e.length && t.every(function (t, r) {
    return n(t, e[r]);
  });
}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
// The earliest date supported by Firestore timestamps (0001-01-01T00:00:00Z).

/**
 * A `Timestamp` represents a point in time independent of any time zone or
 * calendar, represented as seconds and fractions of seconds at nanosecond
 * resolution in UTC Epoch time.
 *
 * It is encoded using the Proleptic Gregorian Calendar which extends the
 * Gregorian calendar backwards to year one. It is encoded assuming all minutes
 * are 60 seconds long, i.e. leap seconds are "smeared" so that no leap second
 * table is needed for interpretation. Range is from 0001-01-01T00:00:00Z to
 * 9999-12-31T23:59:59.999999999Z.
 *
 * For examples and further specifications, refer to the
 * {@link https://github.com/google/protobuf/blob/master/src/google/protobuf/timestamp.proto | Timestamp definition}.
 */


var gt = /*#__PURE__*/function () {
  /**
   * Creates a new timestamp.
   *
   * @param seconds - The number of seconds of UTC time since Unix epoch
   *     1970-01-01T00:00:00Z. Must be from 0001-01-01T00:00:00Z to
   *     9999-12-31T23:59:59Z inclusive.
   * @param nanoseconds - The non-negative fractions of a second at nanosecond
   *     resolution. Negative second values with fractions must still have
   *     non-negative nanoseconds values that count forward in time. Must be
   *     from 0 to 999,999,999 inclusive.
   */
  function gt(
  /**
   * The number of seconds of UTC time since Unix epoch 1970-01-01T00:00:00Z.
   */
  t,
  /**
   * The fractions of a second at nanosecond resolution.*
   */
  e) {
    _classCallCheck(this, gt);

    if (this.seconds = t, this.nanoseconds = e, e < 0) throw new L(A, "Timestamp nanoseconds out of range: " + e);
    if (e >= 1e9) throw new L(A, "Timestamp nanoseconds out of range: " + e);
    if (t < -62135596800) throw new L(A, "Timestamp seconds out of range: " + t); // This will break in the year 10,000.

    if (t >= 253402300800) throw new L(A, "Timestamp seconds out of range: " + t);
  }
  /**
   * Creates a new timestamp with the current date, with millisecond precision.
   *
   * @returns a new timestamp representing the current date.
   */


  _createClass(gt, [{
    key: "toDate",
    value:
    /**
     * Converts a `Timestamp` to a JavaScript `Date` object. This conversion
     * causes a loss of precision since `Date` objects only support millisecond
     * precision.
     *
     * @returns JavaScript `Date` object representing the same point in time as
     *     this `Timestamp`, with millisecond precision.
     */
    function toDate() {
      return new Date(this.toMillis());
    }
    /**
     * Converts a `Timestamp` to a numeric timestamp (in milliseconds since
     * epoch). This operation causes a loss of precision.
     *
     * @returns The point in time corresponding to this timestamp, represented as
     *     the number of milliseconds since Unix epoch 1970-01-01T00:00:00Z.
     */

  }, {
    key: "toMillis",
    value: function toMillis() {
      return 1e3 * this.seconds + this.nanoseconds / 1e6;
    }
  }, {
    key: "_compareTo",
    value: function _compareTo(t) {
      return this.seconds === t.seconds ? yt(this.nanoseconds, t.nanoseconds) : yt(this.seconds, t.seconds);
    }
    /**
     * Returns true if this `Timestamp` is equal to the provided one.
     *
     * @param other - The `Timestamp` to compare against.
     * @returns true if this `Timestamp` is equal to the provided one.
     */

  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return t.seconds === this.seconds && t.nanoseconds === this.nanoseconds;
    }
    /** Returns a textual representation of this `Timestamp`. */

  }, {
    key: "toString",
    value: function toString() {
      return "Timestamp(seconds=" + this.seconds + ", nanoseconds=" + this.nanoseconds + ")";
    }
    /** Returns a JSON-serializable representation of this `Timestamp`. */

  }, {
    key: "toJSON",
    value: function toJSON() {
      return {
        seconds: this.seconds,
        nanoseconds: this.nanoseconds
      };
    }
    /**
     * Converts this object to a primitive string, which allows `Timestamp` objects
     * to be compared using the `>`, `<=`, `>=` and `>` operators.
     */

  }, {
    key: "valueOf",
    value: function valueOf() {
      // This method returns a string of the form <seconds>.<nanoseconds> where
      // <seconds> is translated to have a non-negative value and both <seconds>
      // and <nanoseconds> are left-padded with zeroes to be a consistent length.
      // Strings with this format then have a lexiographical ordering that matches
      // the expected ordering. The <seconds> translation is done to avoid having
      // a leading negative sign (i.e. a leading '-' character) in its string
      // representation, which would affect its lexiographical ordering.
      var t = this.seconds - -62135596800; // Note: Up to 12 decimal digits are required to represent all valid
      // 'seconds' values.

      return String(t).padStart(12, "0") + "." + String(this.nanoseconds).padStart(9, "0");
    }
  }], [{
    key: "now",
    value: function now() {
      return gt.fromMillis(Date.now());
    }
    /**
     * Creates a new timestamp from the given date.
     *
     * @param date - The date to initialize the `Timestamp` from.
     * @returns A new `Timestamp` representing the same point in time as the given
     *     date.
     */

  }, {
    key: "fromDate",
    value: function fromDate(t) {
      return gt.fromMillis(t.getTime());
    }
    /**
     * Creates a new timestamp from the given number of milliseconds.
     *
     * @param milliseconds - Number of milliseconds since Unix epoch
     *     1970-01-01T00:00:00Z.
     * @returns A new `Timestamp` representing the same point in time as the given
     *     number of milliseconds.
     */

  }, {
    key: "fromMillis",
    value: function fromMillis(t) {
      var e = Math.floor(t / 1e3),
          n = Math.floor(1e6 * (t - 1e3 * e));
      return new gt(e, n);
    }
  }]);

  return gt;
}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * A version of a document in Firestore. This corresponds to the version
 * timestamp, such as update_time or read_time.
 */


var vt = /*#__PURE__*/function () {
  function vt(t) {
    _classCallCheck(this, vt);

    this.timestamp = t;
  }

  _createClass(vt, [{
    key: "compareTo",
    value: function compareTo(t) {
      return this.timestamp._compareTo(t.timestamp);
    }
  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return this.timestamp.isEqual(t.timestamp);
    }
    /** Returns a number representation of the version for use in spec tests. */

  }, {
    key: "toMicroseconds",
    value: function toMicroseconds() {
      // Convert to microseconds.
      return 1e6 * this.timestamp.seconds + this.timestamp.nanoseconds / 1e3;
    }
  }, {
    key: "toString",
    value: function toString() {
      return "SnapshotVersion(" + this.timestamp.toString() + ")";
    }
  }, {
    key: "toTimestamp",
    value: function toTimestamp() {
      return this.timestamp;
    }
  }], [{
    key: "fromTimestamp",
    value: function fromTimestamp(t) {
      return new vt(t);
    }
  }, {
    key: "min",
    value: function min() {
      return new vt(new gt(0, 0));
    }
  }, {
    key: "max",
    value: function max() {
      return new vt(new gt(253402300799, 999999999));
    }
  }]);

  return vt;
}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


function bt(t) {
  var e = 0;

  for (var n in t) {
    Object.prototype.hasOwnProperty.call(t, n) && e++;
  }

  return e;
}

function Et(t, e) {
  for (var n in t) {
    Object.prototype.hasOwnProperty.call(t, n) && e(n, t[n]);
  }
}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
// An immutable sorted map implementation, based on a Left-leaning Red-Black
// tree.


var Tt = /*#__PURE__*/function () {
  function Tt(t, e) {
    _classCallCheck(this, Tt);

    this.comparator = t, this.root = e || At.EMPTY;
  } // Returns a copy of the map, with the specified key/value added or replaced.


  _createClass(Tt, [{
    key: "insert",
    value: function insert(t, e) {
      return new Tt(this.comparator, this.root.insert(t, e, this.comparator).copy(null, null, At.BLACK, null, null));
    } // Returns a copy of the map, with the specified key removed.

  }, {
    key: "remove",
    value: function remove(t) {
      return new Tt(this.comparator, this.root.remove(t, this.comparator).copy(null, null, At.BLACK, null, null));
    } // Returns the value of the node with the given key, or null.

  }, {
    key: "get",
    value: function get(t) {
      var e = this.root;

      for (; !e.isEmpty();) {
        var n = this.comparator(t, e.key);
        if (0 === n) return e.value;
        n < 0 ? e = e.left : n > 0 && (e = e.right);
      }

      return null;
    } // Returns the index of the element in this sorted map, or -1 if it doesn't
    // exist.

  }, {
    key: "indexOf",
    value: function indexOf(t) {
      // Number of nodes that were pruned when descending right
      var e = 0,
          n = this.root;

      for (; !n.isEmpty();) {
        var r = this.comparator(t, n.key);
        if (0 === r) return e + n.left.size;
        r < 0 ? n = n.left : ( // Count all nodes left of the node plus the node itself
        e += n.left.size + 1, n = n.right);
      } // Node not found


      return -1;
    }
  }, {
    key: "isEmpty",
    value: function isEmpty() {
      return this.root.isEmpty();
    } // Returns the total number of nodes in the map.

  }, {
    key: "size",
    get: function get() {
      return this.root.size;
    } // Returns the minimum key in the map.

  }, {
    key: "minKey",
    value: function minKey() {
      return this.root.minKey();
    } // Returns the maximum key in the map.

  }, {
    key: "maxKey",
    value: function maxKey() {
      return this.root.maxKey();
    } // Traverses the map in key order and calls the specified action function
    // for each key/value pair. If action returns true, traversal is aborted.
    // Returns the first truthy value returned by action, or the last falsey
    // value returned by action.

  }, {
    key: "inorderTraversal",
    value: function inorderTraversal(t) {
      return this.root.inorderTraversal(t);
    }
  }, {
    key: "forEach",
    value: function forEach(t) {
      this.inorderTraversal(function (e, n) {
        return t(e, n), !1;
      });
    }
  }, {
    key: "toString",
    value: function toString() {
      var t = [];
      return this.inorderTraversal(function (e, n) {
        return t.push("".concat(e, ":").concat(n)), !1;
      }), "{".concat(t.join(", "), "}");
    } // Traverses the map in reverse key order and calls the specified action
    // function for each key/value pair. If action returns true, traversal is
    // aborted.
    // Returns the first truthy value returned by action, or the last falsey
    // value returned by action.

  }, {
    key: "reverseTraversal",
    value: function reverseTraversal(t) {
      return this.root.reverseTraversal(t);
    } // Returns an iterator over the SortedMap.

  }, {
    key: "getIterator",
    value: function getIterator() {
      return new It(this.root, null, this.comparator, !1);
    }
  }, {
    key: "getIteratorFrom",
    value: function getIteratorFrom(t) {
      return new It(this.root, t, this.comparator, !1);
    }
  }, {
    key: "getReverseIterator",
    value: function getReverseIterator() {
      return new It(this.root, null, this.comparator, !0);
    }
  }, {
    key: "getReverseIteratorFrom",
    value: function getReverseIteratorFrom(t) {
      return new It(this.root, t, this.comparator, !0);
    }
  }]);

  return Tt;
}(); // end SortedMap
// An iterator over an LLRBNode.


var It = /*#__PURE__*/function () {
  function It(t, e, n, r) {
    _classCallCheck(this, It);

    this.isReverse = r, this.nodeStack = [];
    var s = 1;

    for (; !t.isEmpty();) {
      if (s = e ? n(t.key, e) : 1, // flip the comparison if we're going in reverse
      e && r && (s *= -1), s < 0) // This node is less than our start key. ignore it
        t = this.isReverse ? t.left : t.right;else {
        if (0 === s) {
          // This node is exactly equal to our start key. Push it on the stack,
          // but stop iterating;
          this.nodeStack.push(t);
          break;
        } // This node is greater than our start key, add it to the stack and move
        // to the next one


        this.nodeStack.push(t), t = this.isReverse ? t.right : t.left;
      }
    }
  }

  _createClass(It, [{
    key: "getNext",
    value: function getNext() {
      var t = this.nodeStack.pop();
      var e = {
        key: t.key,
        value: t.value
      };
      if (this.isReverse) for (t = t.left; !t.isEmpty();) {
        this.nodeStack.push(t), t = t.right;
      } else for (t = t.right; !t.isEmpty();) {
        this.nodeStack.push(t), t = t.left;
      }
      return e;
    }
  }, {
    key: "hasNext",
    value: function hasNext() {
      return this.nodeStack.length > 0;
    }
  }, {
    key: "peek",
    value: function peek() {
      if (0 === this.nodeStack.length) return null;
      var t = this.nodeStack[this.nodeStack.length - 1];
      return {
        key: t.key,
        value: t.value
      };
    }
  }]);

  return It;
}(); // end SortedMapIterator
// Represents a node in a Left-leaning Red-Black tree.


var At = /*#__PURE__*/function () {
  function At(t, e, n, r, s) {
    _classCallCheck(this, At);

    this.key = t, this.value = e, this.color = null != n ? n : At.RED, this.left = null != r ? r : At.EMPTY, this.right = null != s ? s : At.EMPTY, this.size = this.left.size + 1 + this.right.size;
  } // Returns a copy of the current node, optionally replacing pieces of it.


  _createClass(At, [{
    key: "copy",
    value: function copy(t, e, n, r, s) {
      return new At(null != t ? t : this.key, null != e ? e : this.value, null != n ? n : this.color, null != r ? r : this.left, null != s ? s : this.right);
    }
  }, {
    key: "isEmpty",
    value: function isEmpty() {
      return !1;
    } // Traverses the tree in key order and calls the specified action function
    // for each node. If action returns true, traversal is aborted.
    // Returns the first truthy value returned by action, or the last falsey
    // value returned by action.

  }, {
    key: "inorderTraversal",
    value: function inorderTraversal(t) {
      return this.left.inorderTraversal(t) || t(this.key, this.value) || this.right.inorderTraversal(t);
    } // Traverses the tree in reverse key order and calls the specified action
    // function for each node. If action returns true, traversal is aborted.
    // Returns the first truthy value returned by action, or the last falsey
    // value returned by action.

  }, {
    key: "reverseTraversal",
    value: function reverseTraversal(t) {
      return this.right.reverseTraversal(t) || t(this.key, this.value) || this.left.reverseTraversal(t);
    } // Returns the minimum node in the tree.

  }, {
    key: "min",
    value: function min() {
      return this.left.isEmpty() ? this : this.left.min();
    } // Returns the maximum key in the tree.

  }, {
    key: "minKey",
    value: function minKey() {
      return this.min().key;
    } // Returns the maximum key in the tree.

  }, {
    key: "maxKey",
    value: function maxKey() {
      return this.right.isEmpty() ? this.key : this.right.maxKey();
    } // Returns new tree, with the key/value added.

  }, {
    key: "insert",
    value: function insert(t, e, n) {
      var r = this;
      var s = n(t, r.key);
      return r = s < 0 ? r.copy(null, null, null, r.left.insert(t, e, n), null) : 0 === s ? r.copy(null, e, null, null, null) : r.copy(null, null, null, null, r.right.insert(t, e, n)), r.fixUp();
    }
  }, {
    key: "removeMin",
    value: function removeMin() {
      if (this.left.isEmpty()) return At.EMPTY;
      var t = this;
      return t.left.isRed() || t.left.left.isRed() || (t = t.moveRedLeft()), t = t.copy(null, null, null, t.left.removeMin(), null), t.fixUp();
    } // Returns new tree, with the specified item removed.

  }, {
    key: "remove",
    value: function remove(t, e) {
      var n,
          r = this;
      if (e(t, r.key) < 0) r.left.isEmpty() || r.left.isRed() || r.left.left.isRed() || (r = r.moveRedLeft()), r = r.copy(null, null, null, r.left.remove(t, e), null);else {
        if (r.left.isRed() && (r = r.rotateRight()), r.right.isEmpty() || r.right.isRed() || r.right.left.isRed() || (r = r.moveRedRight()), 0 === e(t, r.key)) {
          if (r.right.isEmpty()) return At.EMPTY;
          n = r.right.min(), r = r.copy(n.key, n.value, null, null, r.right.removeMin());
        }

        r = r.copy(null, null, null, null, r.right.remove(t, e));
      }
      return r.fixUp();
    }
  }, {
    key: "isRed",
    value: function isRed() {
      return this.color;
    } // Returns new tree after performing any needed rotations.

  }, {
    key: "fixUp",
    value: function fixUp() {
      var t = this;
      return t.right.isRed() && !t.left.isRed() && (t = t.rotateLeft()), t.left.isRed() && t.left.left.isRed() && (t = t.rotateRight()), t.left.isRed() && t.right.isRed() && (t = t.colorFlip()), t;
    }
  }, {
    key: "moveRedLeft",
    value: function moveRedLeft() {
      var t = this.colorFlip();
      return t.right.left.isRed() && (t = t.copy(null, null, null, null, t.right.rotateRight()), t = t.rotateLeft(), t = t.colorFlip()), t;
    }
  }, {
    key: "moveRedRight",
    value: function moveRedRight() {
      var t = this.colorFlip();
      return t.left.left.isRed() && (t = t.rotateRight(), t = t.colorFlip()), t;
    }
  }, {
    key: "rotateLeft",
    value: function rotateLeft() {
      var t = this.copy(null, null, At.RED, null, this.right.left);
      return this.right.copy(null, null, this.color, t, null);
    }
  }, {
    key: "rotateRight",
    value: function rotateRight() {
      var t = this.copy(null, null, At.RED, this.left.right, null);
      return this.left.copy(null, null, this.color, null, t);
    }
  }, {
    key: "colorFlip",
    value: function colorFlip() {
      var t = this.left.copy(null, null, !this.left.color, null, null),
          e = this.right.copy(null, null, !this.right.color, null, null);
      return this.copy(null, null, !this.color, t, e);
    } // For testing.

  }, {
    key: "checkMaxDepth",
    value: function checkMaxDepth() {
      var t = this.check();
      return Math.pow(2, t) <= this.size + 1;
    } // In a balanced RB tree, the black-depth (number of black nodes) from root to
    // leaves is equal on both sides.  This function verifies that or asserts.

  }, {
    key: "check",
    value: function check() {
      if (this.isRed() && this.left.isRed()) throw g();
      if (this.right.isRed()) throw g();
      var t = this.left.check();
      if (t !== this.right.check()) throw g();
      return t + (this.isRed() ? 0 : 1);
    }
  }]);

  return At;
}(); // end LLRBNode
// Empty node is shared between all LLRB trees.
// eslint-disable-next-line @typescript-eslint/no-explicit-any


At.EMPTY = null, At.RED = !0, At.BLACK = !1; // end LLRBEmptyNode

At.EMPTY = new (
/*#__PURE__*/
// Represents an empty node (a leaf node in the Red-Black Tree).
function () {
  function _class2() {
    _classCallCheck(this, _class2);

    this.size = 0;
  }

  _createClass(_class2, [{
    key: "key",
    get: function get() {
      throw g();
    }
  }, {
    key: "value",
    get: function get() {
      throw g();
    }
  }, {
    key: "color",
    get: function get() {
      throw g();
    }
  }, {
    key: "left",
    get: function get() {
      throw g();
    }
  }, {
    key: "right",
    get: function get() {
      throw g();
    } // Returns a copy of the current node.

  }, {
    key: "copy",
    value: function copy(t, e, n, r, s) {
      return this;
    } // Returns a copy of the tree, with the specified key/value added.

  }, {
    key: "insert",
    value: function insert(t, e, n) {
      return new At(t, e);
    } // Returns a copy of the tree, with the specified key removed.

  }, {
    key: "remove",
    value: function remove(t, e) {
      return this;
    }
  }, {
    key: "isEmpty",
    value: function isEmpty() {
      return !0;
    }
  }, {
    key: "inorderTraversal",
    value: function inorderTraversal(t) {
      return !1;
    }
  }, {
    key: "reverseTraversal",
    value: function reverseTraversal(t) {
      return !1;
    }
  }, {
    key: "minKey",
    value: function minKey() {
      return null;
    }
  }, {
    key: "maxKey",
    value: function maxKey() {
      return null;
    }
  }, {
    key: "isRed",
    value: function isRed() {
      return !1;
    } // For testing.

  }, {
    key: "checkMaxDepth",
    value: function checkMaxDepth() {
      return !0;
    }
  }, {
    key: "check",
    value: function check() {
      return 0;
    }
  }]);

  return _class2;
}())();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * SortedSet is an immutable (copy-on-write) collection that holds elements
 * in order specified by the provided comparator.
 *
 * NOTE: if provided comparator returns 0 for two elements, we consider them to
 * be equal!
 */

var Rt = /*#__PURE__*/function () {
  function Rt(t) {
    _classCallCheck(this, Rt);

    this.comparator = t, this.data = new Tt(this.comparator);
  }

  _createClass(Rt, [{
    key: "has",
    value: function has(t) {
      return null !== this.data.get(t);
    }
  }, {
    key: "first",
    value: function first() {
      return this.data.minKey();
    }
  }, {
    key: "last",
    value: function last() {
      return this.data.maxKey();
    }
  }, {
    key: "size",
    get: function get() {
      return this.data.size;
    }
  }, {
    key: "indexOf",
    value: function indexOf(t) {
      return this.data.indexOf(t);
    }
    /** Iterates elements in order defined by "comparator" */

  }, {
    key: "forEach",
    value: function forEach(t) {
      this.data.inorderTraversal(function (e, n) {
        return t(e), !1;
      });
    }
    /** Iterates over `elem`s such that: range[0] &lt;= elem &lt; range[1]. */

  }, {
    key: "forEachInRange",
    value: function forEachInRange(t, e) {
      var n = this.data.getIteratorFrom(t[0]);

      for (; n.hasNext();) {
        var r = n.getNext();
        if (this.comparator(r.key, t[1]) >= 0) return;
        e(r.key);
      }
    }
    /**
     * Iterates over `elem`s such that: start &lt;= elem until false is returned.
     */

  }, {
    key: "forEachWhile",
    value: function forEachWhile(t, e) {
      var n;

      for (n = void 0 !== e ? this.data.getIteratorFrom(e) : this.data.getIterator(); n.hasNext();) {
        if (!t(n.getNext().key)) return;
      }
    }
    /** Finds the least element greater than or equal to `elem`. */

  }, {
    key: "firstAfterOrEqual",
    value: function firstAfterOrEqual(t) {
      var e = this.data.getIteratorFrom(t);
      return e.hasNext() ? e.getNext().key : null;
    }
  }, {
    key: "getIterator",
    value: function getIterator() {
      return new Pt(this.data.getIterator());
    }
  }, {
    key: "getIteratorFrom",
    value: function getIteratorFrom(t) {
      return new Pt(this.data.getIteratorFrom(t));
    }
    /** Inserts or updates an element */

  }, {
    key: "add",
    value: function add(t) {
      return this.copy(this.data.remove(t).insert(t, !0));
    }
    /** Deletes an element */

  }, {
    key: "delete",
    value: function _delete(t) {
      return this.has(t) ? this.copy(this.data.remove(t)) : this;
    }
  }, {
    key: "isEmpty",
    value: function isEmpty() {
      return this.data.isEmpty();
    }
  }, {
    key: "unionWith",
    value: function unionWith(t) {
      var e = this; // Make sure `result` always refers to the larger one of the two sets.

      return e.size < t.size && (e = t, t = this), t.forEach(function (t) {
        e = e.add(t);
      }), e;
    }
  }, {
    key: "isEqual",
    value: function isEqual(t) {
      if (!(t instanceof Rt)) return !1;
      if (this.size !== t.size) return !1;
      var e = this.data.getIterator(),
          n = t.data.getIterator();

      for (; e.hasNext();) {
        var _t3 = e.getNext().key,
            r = n.getNext().key;
        if (0 !== this.comparator(_t3, r)) return !1;
      }

      return !0;
    }
  }, {
    key: "toArray",
    value: function toArray() {
      var t = [];
      return this.forEach(function (e) {
        t.push(e);
      }), t;
    }
  }, {
    key: "toString",
    value: function toString() {
      var t = [];
      return this.forEach(function (e) {
        return t.push(e);
      }), "SortedSet(" + t.toString() + ")";
    }
  }, {
    key: "copy",
    value: function copy(t) {
      var e = new Rt(this.comparator);
      return e.data = t, e;
    }
  }]);

  return Rt;
}();

var Pt = /*#__PURE__*/function () {
  function Pt(t) {
    _classCallCheck(this, Pt);

    this.iter = t;
  }

  _createClass(Pt, [{
    key: "getNext",
    value: function getNext() {
      return this.iter.getNext().key;
    }
  }, {
    key: "hasNext",
    value: function hasNext() {
      return this.iter.hasNext();
    }
  }]);

  return Pt;
}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Provides a set of fields that can be used to partially patch a document.
 * FieldMask is used in conjunction with ObjectValue.
 * Examples:
 *   foo - Overwrites foo entirely with the provided value. If foo is not
 *         present in the companion ObjectValue, the field is deleted.
 *   foo.bar - Overwrites only the field bar of the object foo.
 *             If foo is not an object, foo is replaced with an object
 *             containing foo
 */


var Vt = /*#__PURE__*/function () {
  function Vt(t) {
    _classCallCheck(this, Vt);

    this.fields = t, // TODO(dimond): validation of FieldMask
    // Sort the field mask to support `FieldMask.isEqual()` and assert below.
    t.sort(tt.comparator);
  }

  _createClass(Vt, [{
    key: "unionWith",
    value:
    /**
     * Returns a new FieldMask object that is the result of adding all the given
     * fields paths to this field mask.
     */
    function unionWith(t) {
      var e = new Rt(tt.comparator);

      var _iterator = _createForOfIteratorHelper(this.fields),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var _t4 = _step.value;
          e = e.add(_t4);
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }

      var _iterator2 = _createForOfIteratorHelper(t),
          _step2;

      try {
        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
          var n = _step2.value;
          e = e.add(n);
        }
      } catch (err) {
        _iterator2.e(err);
      } finally {
        _iterator2.f();
      }

      return new Vt(e.toArray());
    }
    /**
     * Verifies that `fieldPath` is included by at least one field in this field
     * mask.
     *
     * This is an O(n) operation, where `n` is the size of the field mask.
     */

  }, {
    key: "covers",
    value: function covers(t) {
      var _iterator3 = _createForOfIteratorHelper(this.fields),
          _step3;

      try {
        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
          var e = _step3.value;
          if (e.isPrefixOf(t)) return !0;
        }
      } catch (err) {
        _iterator3.e(err);
      } finally {
        _iterator3.f();
      }

      return !1;
    }
  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return _t(this.fields, t.fields, function (t, e) {
        return t.isEqual(e);
      });
    }
  }], [{
    key: "empty",
    value: function empty() {
      return new Vt([]);
    }
  }]);

  return Vt;
}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/** Converts a Base64 encoded string to a binary string. */

/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Immutable class that represents a "proto" byte string.
 *
 * Proto byte strings can either be Base64-encoded strings or Uint8Arrays when
 * sent on the wire. This class abstracts away this differentiation by holding
 * the proto byte string in a common class that must be converted into a string
 * before being sent as a proto.
 * @internal
 */


var Nt = /*#__PURE__*/function (_Symbol$iterator) {
  function Nt(t) {
    _classCallCheck(this, Nt);

    this.binaryString = t;
  }

  _createClass(Nt, [{
    key: _Symbol$iterator,
    value: function value() {
      var _this8 = this;

      var t = 0;
      return {
        next: function next() {
          return t < _this8.binaryString.length ? {
            value: _this8.binaryString.charCodeAt(t++),
            done: !1
          } : {
            value: void 0,
            done: !0
          };
        }
      };
    }
  }, {
    key: "toBase64",
    value: function toBase64() {
      return t = this.binaryString, btoa(t);
      /** Converts a binary string to a Base64 encoded string. */

      var t;
    }
  }, {
    key: "toUint8Array",
    value: function toUint8Array() {
      return function (t) {
        var e = new Uint8Array(t.length);

        for (var n = 0; n < t.length; n++) {
          e[n] = t.charCodeAt(n);
        }

        return e;
      }
      /**
      * @license
      * Copyright 2020 Google LLC
      *
      * Licensed under the Apache License, Version 2.0 (the "License");
      * you may not use this file except in compliance with the License.
      * You may obtain a copy of the License at
      *
      *   http://www.apache.org/licenses/LICENSE-2.0
      *
      * Unless required by applicable law or agreed to in writing, software
      * distributed under the License is distributed on an "AS IS" BASIS,
      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      * See the License for the specific language governing permissions and
      * limitations under the License.
      */
      // A RegExp matching ISO 8601 UTC timestamps with optional fraction.
      (this.binaryString);
    }
  }, {
    key: "approximateByteSize",
    value: function approximateByteSize() {
      return 2 * this.binaryString.length;
    }
  }, {
    key: "compareTo",
    value: function compareTo(t) {
      return yt(this.binaryString, t.binaryString);
    }
  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return this.binaryString === t.binaryString;
    }
  }], [{
    key: "fromBase64String",
    value: function fromBase64String(t) {
      var e = atob(t);
      return new Nt(e);
    }
  }, {
    key: "fromUint8Array",
    value: function fromUint8Array(t) {
      // TODO(indexing); Remove the copy of the byte string here as this method
      // is frequently called during indexing.
      var e =
      /**
      * Helper function to convert an Uint8array to a binary string.
      */
      function (t) {
        var e = "";

        for (var n = 0; n < t.length; ++n) {
          e += String.fromCharCode(t[n]);
        }

        return e;
      }
      /**
      * Helper function to convert a binary string to an Uint8Array.
      */
      (t);

      return new Nt(e);
    }
  }]);

  return Nt;
}(Symbol.iterator);

Nt.EMPTY_BYTE_STRING = new Nt("");
var Dt = new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);
/**
 * Converts the possible Proto values for a timestamp value into a "seconds and
 * nanos" representation.
 */

function $t(t) {
  // The json interface (for the browser) will return an iso timestamp string,
  // while the proto js library (for node) will return a
  // google.protobuf.Timestamp instance.
  if (v(!!t), "string" == typeof t) {
    // The date string can have higher precision (nanos) than the Date class
    // (millis), so we do some custom parsing here.
    // Parse the nanos right out of the string.
    var e = 0;
    var n = Dt.exec(t);

    if (v(!!n), n[1]) {
      // Pad the fraction out to 9 digits (nanos).
      var _t5 = n[1];
      _t5 = (_t5 + "000000000").substr(0, 9), e = Number(_t5);
    } // Parse the date to get the seconds.


    var r = new Date(t);
    return {
      seconds: Math.floor(r.getTime() / 1e3),
      nanos: e
    };
  }

  return {
    seconds: xt(t.seconds),
    nanos: xt(t.nanos)
  };
}
/**
 * Converts the possible Proto types for numbers into a JavaScript number.
 * Returns 0 if the value is not numeric.
 */


function xt(t) {
  // TODO(bjornick): Handle int64 greater than 53 bits.
  return "number" == typeof t ? t : "string" == typeof t ? Number(t) : 0;
}
/** Converts the possible Proto types for Blobs into a ByteString. */


function Ft(t) {
  return "string" == typeof t ? Nt.fromBase64String(t) : Nt.fromUint8Array(t);
}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Represents a locally-applied ServerTimestamp.
 *
 * Server Timestamps are backed by MapValues that contain an internal field
 * `__type__` with a value of `server_timestamp`. The previous value and local
 * write time are stored in its `__previous_value__` and `__local_write_time__`
 * fields respectively.
 *
 * Notes:
 * - ServerTimestampValue instances are created as the result of applying a
 *   transform. They can only exist in the local view of a document. Therefore
 *   they do not need to be parsed or serialized.
 * - When evaluated locally (e.g. for snapshot.data()), they by default
 *   evaluate to `null`. This behavior can be configured by passing custom
 *   FieldValueOptions to value().
 * - With respect to other ServerTimestampValues, they sort by their
 *   localWriteTime.
 */


function St(t) {
  var e, n;
  return "server_timestamp" === (null === (n = ((null === (e = null == t ? void 0 : t.mapValue) || void 0 === e ? void 0 : e.fields) || {}).__type__) || void 0 === n ? void 0 : n.stringValue);
}
/**
 * Returns the value of the field before this ServerTimestamp was set.
 *
 * Preserving the previous values allows the user to display the last resoled
 * value until the backend responds with the timestamp.
 */


function qt(t) {
  var e = t.mapValue.fields.__previous_value__;
  return St(e) ? qt(e) : e;
}
/**
 * Returns the local time at which this timestamp was first set.
 */


function Ot(t) {
  var e = $t(t.mapValue.fields.__local_write_time__.timestampValue);
  return new gt(e.seconds, e.nanos);
}
/** Extracts the backend's type order for the provided value. */

function Ct(t) {
  return "nullValue" in t ? 0
  /* NullValue */
  : "booleanValue" in t ? 1
  /* BooleanValue */
  : "integerValue" in t || "doubleValue" in t ? 2
  /* NumberValue */
  : "timestampValue" in t ? 3
  /* TimestampValue */
  : "stringValue" in t ? 5
  /* StringValue */
  : "bytesValue" in t ? 6
  /* BlobValue */
  : "referenceValue" in t ? 7
  /* RefValue */
  : "geoPointValue" in t ? 8
  /* GeoPointValue */
  : "arrayValue" in t ? 9
  /* ArrayValue */
  : "mapValue" in t ? St(t) ? 4
  /* ServerTimestampValue */
  :
  /** Returns true if the Value represents the canonical {@link #MAX_VALUE} . */
  function (t) {
    return "__max__" === (((t.mapValue || {}).fields || {}).__type__ || {}).stringValue;
  }
  /**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */

  /**
  * An ObjectValue represents a MapValue in the Firestore Proto and offers the
  * ability to add and remove fields (via the ObjectValueBuilder).
  */
  (t) ? 9007199254740991
  /* MaxValue */
  : 10
  /* ObjectValue */
  : g();
}
/** Tests `left` and `right` for equality based on the backend semantics. */


function Lt(t, e) {
  if (t === e) return !0;
  var n = Ct(t);
  if (n !== Ct(e)) return !1;

  switch (n) {
    case 0
    /* NullValue */
    :
    case 9007199254740991
    /* MaxValue */
    :
      return !0;

    case 1
    /* BooleanValue */
    :
      return t.booleanValue === e.booleanValue;

    case 4
    /* ServerTimestampValue */
    :
      return Ot(t).isEqual(Ot(e));

    case 3
    /* TimestampValue */
    :
      return function (t, e) {
        if ("string" == typeof t.timestampValue && "string" == typeof e.timestampValue && t.timestampValue.length === e.timestampValue.length) // Use string equality for ISO 8601 timestamps
          return t.timestampValue === e.timestampValue;
        var n = $t(t.timestampValue),
            r = $t(e.timestampValue);
        return n.seconds === r.seconds && n.nanos === r.nanos;
      }(t, e);

    case 5
    /* StringValue */
    :
      return t.stringValue === e.stringValue;

    case 6
    /* BlobValue */
    :
      return function (t, e) {
        return Ft(t.bytesValue).isEqual(Ft(e.bytesValue));
      }(t, e);

    case 7
    /* RefValue */
    :
      return t.referenceValue === e.referenceValue;

    case 8
    /* GeoPointValue */
    :
      return function (t, e) {
        return xt(t.geoPointValue.latitude) === xt(e.geoPointValue.latitude) && xt(t.geoPointValue.longitude) === xt(e.geoPointValue.longitude);
      }(t, e);

    case 2
    /* NumberValue */
    :
      return function (t, e) {
        if ("integerValue" in t && "integerValue" in e) return xt(t.integerValue) === xt(e.integerValue);

        if ("doubleValue" in t && "doubleValue" in e) {
          var _n3 = xt(t.doubleValue),
              r = xt(e.doubleValue);

          return _n3 === r ? at(_n3) === at(r) : isNaN(_n3) && isNaN(r);
        }

        return !1;
      }(t, e);

    case 9
    /* ArrayValue */
    :
      return _t(t.arrayValue.values || [], e.arrayValue.values || [], Lt);

    case 10
    /* ObjectValue */
    :
      return function (t, e) {
        var n = t.mapValue.fields || {},
            r = e.mapValue.fields || {};
        if (bt(n) !== bt(r)) return !1;

        for (var _t6 in n) {
          if (n.hasOwnProperty(_t6) && (void 0 === r[_t6] || !Lt(n[_t6], r[_t6]))) return !1;
        }

        return !0;
      }
      /** Returns true if the ArrayValue contains the specified element. */
      (t, e);

    default:
      return g();
  }
}
/** Returns true if `value` is a MapValue. */


function Kt(t) {
  return !!t && "mapValue" in t;
}
/** Creates a deep copy of `source`. */


function Qt(t) {
  if (t.geoPointValue) return {
    geoPointValue: Object.assign({}, t.geoPointValue)
  };
  if (t.timestampValue && "object" == _typeof$1(t.timestampValue)) return {
    timestampValue: Object.assign({}, t.timestampValue)
  };

  if (t.mapValue) {
    var e = {
      mapValue: {
        fields: {}
      }
    };
    return Et(t.mapValue.fields, function (t, n) {
      return e.mapValue.fields[t] = Qt(n);
    }), e;
  }

  if (t.arrayValue) {
    var _e8 = {
      arrayValue: {
        values: []
      }
    };

    for (var n = 0; n < (t.arrayValue.values || []).length; ++n) {
      _e8.arrayValue.values[n] = Qt(t.arrayValue.values[n]);
    }

    return _e8;
  }

  return Object.assign({}, t);
}

var Yt = /*#__PURE__*/function () {
  function Yt(t) {
    _classCallCheck(this, Yt);

    this.value = t;
  }

  _createClass(Yt, [{
    key: "field",
    value:
    /**
     * Returns the value at the given path or null.
     *
     * @param path - the path to search
     * @returns The value at the path or null if the path is not set.
     */
    function field(t) {
      if (t.isEmpty()) return this.value;
      {
        var e = this.value;

        for (var n = 0; n < t.length - 1; ++n) {
          if (e = (e.mapValue.fields || {})[t.get(n)], !Kt(e)) return null;
        }

        return e = (e.mapValue.fields || {})[t.lastSegment()], e || null;
      }
    }
    /**
     * Sets the field to the provided value.
     *
     * @param path - The field path to set.
     * @param value - The value to set.
     */

  }, {
    key: "set",
    value: function set(t, e) {
      this.getFieldsMap(t.popLast())[t.lastSegment()] = Qt(e);
    }
    /**
     * Sets the provided fields to the provided values.
     *
     * @param data - A map of fields to values (or null for deletes).
     */

  }, {
    key: "setAll",
    value: function setAll(t) {
      var _this9 = this;

      var e = tt.emptyPath(),
          n = {},
          r = [];
      t.forEach(function (t, s) {
        if (!e.isImmediateParentOf(s)) {
          // Insert the accumulated changes at this parent location
          var _t10 = _this9.getFieldsMap(e);

          _this9.applyChanges(_t10, n, r), n = {}, r = [], e = s.popLast();
        }

        t ? n[s.lastSegment()] = Qt(t) : r.push(s.lastSegment());
      });
      var s = this.getFieldsMap(e);
      this.applyChanges(s, n, r);
    }
    /**
     * Removes the field at the specified path. If there is no field at the
     * specified path, nothing is changed.
     *
     * @param path - The field path to remove.
     */

  }, {
    key: "delete",
    value: function _delete(t) {
      var e = this.field(t.popLast());
      Kt(e) && e.mapValue.fields && delete e.mapValue.fields[t.lastSegment()];
    }
  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return Lt(this.value, t.value);
    }
    /**
     * Returns the map that contains the leaf element of `path`. If the parent
     * entry does not yet exist, or if it is not a map, a new map will be created.
     */

  }, {
    key: "getFieldsMap",
    value: function getFieldsMap(t) {
      var e = this.value;
      e.mapValue.fields || (e.mapValue = {
        fields: {}
      });

      for (var n = 0; n < t.length; ++n) {
        var r = e.mapValue.fields[t.get(n)];
        Kt(r) && r.mapValue.fields || (r = {
          mapValue: {
            fields: {}
          }
        }, e.mapValue.fields[t.get(n)] = r), e = r;
      }

      return e.mapValue.fields;
    }
    /**
     * Modifies `fieldsMap` by adding, replacing or deleting the specified
     * entries.
     */

  }, {
    key: "applyChanges",
    value: function applyChanges(t, e, n) {
      Et(e, function (e, n) {
        return t[e] = n;
      });

      var _iterator4 = _createForOfIteratorHelper(n),
          _step4;

      try {
        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
          var _e9 = _step4.value;
          delete t[_e9];
        }
      } catch (err) {
        _iterator4.e(err);
      } finally {
        _iterator4.f();
      }
    }
  }, {
    key: "clone",
    value: function clone() {
      return new Yt(Qt(this.value));
    }
  }], [{
    key: "empty",
    value: function empty() {
      return new Yt({
        mapValue: {}
      });
    }
  }]);

  return Yt;
}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Represents a document in Firestore with a key, version, data and whether it
 * has local mutations applied to it.
 *
 * Documents can transition between states via `convertToFoundDocument()`,
 * `convertToNoDocument()` and `convertToUnknownDocument()`. If a document does
 * not transition to one of these states even after all mutations have been
 * applied, `isValidDocument()` returns false and the document should be removed
 * from all views.
 */


var Ht = /*#__PURE__*/function () {
  function Ht(t, e, n, r, s, i) {
    _classCallCheck(this, Ht);

    this.key = t, this.documentType = e, this.version = n, this.readTime = r, this.data = s, this.documentState = i;
  }
  /**
   * Creates a document with no known version or data, but which can serve as
   * base document for mutations.
   */


  _createClass(Ht, [{
    key: "convertToFoundDocument",
    value:
    /**
     * Changes the document type to indicate that it exists and that its version
     * and data are known.
     */
    function convertToFoundDocument(t, e) {
      return this.version = t, this.documentType = 1
      /* FOUND_DOCUMENT */
      , this.data = e, this.documentState = 0
      /* SYNCED */
      , this;
    }
    /**
     * Changes the document type to indicate that it doesn't exist at the given
     * version.
     */

  }, {
    key: "convertToNoDocument",
    value: function convertToNoDocument(t) {
      return this.version = t, this.documentType = 2
      /* NO_DOCUMENT */
      , this.data = Yt.empty(), this.documentState = 0
      /* SYNCED */
      , this;
    }
    /**
     * Changes the document type to indicate that it exists at a given version but
     * that its data is not known (e.g. a document that was updated without a known
     * base document).
     */

  }, {
    key: "convertToUnknownDocument",
    value: function convertToUnknownDocument(t) {
      return this.version = t, this.documentType = 3
      /* UNKNOWN_DOCUMENT */
      , this.data = Yt.empty(), this.documentState = 2
      /* HAS_COMMITTED_MUTATIONS */
      , this;
    }
  }, {
    key: "setHasCommittedMutations",
    value: function setHasCommittedMutations() {
      return this.documentState = 2
      /* HAS_COMMITTED_MUTATIONS */
      , this;
    }
  }, {
    key: "setHasLocalMutations",
    value: function setHasLocalMutations() {
      return this.documentState = 1
      /* HAS_LOCAL_MUTATIONS */
      , this.version = vt.min(), this;
    }
  }, {
    key: "setReadTime",
    value: function setReadTime(t) {
      return this.readTime = t, this;
    }
  }, {
    key: "hasLocalMutations",
    get: function get() {
      return 1
      /* HAS_LOCAL_MUTATIONS */
      === this.documentState;
    }
  }, {
    key: "hasCommittedMutations",
    get: function get() {
      return 2
      /* HAS_COMMITTED_MUTATIONS */
      === this.documentState;
    }
  }, {
    key: "hasPendingWrites",
    get: function get() {
      return this.hasLocalMutations || this.hasCommittedMutations;
    }
  }, {
    key: "isValidDocument",
    value: function isValidDocument() {
      return 0
      /* INVALID */
      !== this.documentType;
    }
  }, {
    key: "isFoundDocument",
    value: function isFoundDocument() {
      return 1
      /* FOUND_DOCUMENT */
      === this.documentType;
    }
  }, {
    key: "isNoDocument",
    value: function isNoDocument() {
      return 2
      /* NO_DOCUMENT */
      === this.documentType;
    }
  }, {
    key: "isUnknownDocument",
    value: function isUnknownDocument() {
      return 3
      /* UNKNOWN_DOCUMENT */
      === this.documentType;
    }
  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return t instanceof Ht && this.key.isEqual(t.key) && this.version.isEqual(t.version) && this.documentType === t.documentType && this.documentState === t.documentState && this.data.isEqual(t.data);
    }
  }, {
    key: "mutableCopy",
    value: function mutableCopy() {
      return new Ht(this.key, this.documentType, this.version, this.readTime, this.data.clone(), this.documentState);
    }
  }, {
    key: "toString",
    value: function toString() {
      return "Document(".concat(this.key, ", ").concat(this.version, ", ").concat(JSON.stringify(this.data.value), ", {documentType: ").concat(this.documentType, "}), {documentState: ").concat(this.documentState, "})");
    }
  }], [{
    key: "newInvalidDocument",
    value: function newInvalidDocument(t) {
      return new Ht(t, 0
      /* INVALID */
      , vt.min(), vt.min(), Yt.empty(), 0
      /* SYNCED */
      );
    }
    /**
     * Creates a new document that is known to exist with the given data at the
     * given version.
     */

  }, {
    key: "newFoundDocument",
    value: function newFoundDocument(t, e, n) {
      return new Ht(t, 1
      /* FOUND_DOCUMENT */
      , e, vt.min(), n, 0
      /* SYNCED */
      );
    }
    /** Creates a new document that is known to not exist at the given version. */

  }, {
    key: "newNoDocument",
    value: function newNoDocument(t, e) {
      return new Ht(t, 2
      /* NO_DOCUMENT */
      , e, vt.min(), Yt.empty(), 0
      /* SYNCED */
      );
    }
    /**
     * Creates a new document that is known to exist at the given version but
     * whose data is not known (e.g. a document that was updated without a known
     * base document).
     */

  }, {
    key: "newUnknownDocument",
    value: function newUnknownDocument(t, e) {
      return new Ht(t, 3
      /* UNKNOWN_DOCUMENT */
      , e, vt.min(), Yt.empty(), 2
      /* HAS_COMMITTED_MUTATIONS */
      );
    }
  }]);

  return Ht;
}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Query encapsulates all the query attributes we support in the SDK. It can
 * be run against the LocalStore, as well as be converted to a `Target` to
 * query the RemoteStore results.
 *
 * Visible for testing.
 */


var fe = /*#__PURE__*/_createClass(
/**
 * Initializes a Query with a path and optional additional query constraints.
 * Path must currently be empty if this is a collection group query.
 */
function fe(t) {
  var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
  var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
  var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];
  var s = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;
  var i = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : "F";
  var o = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null;
  var u = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;

  _classCallCheck(this, fe);

  this.path = t, this.collectionGroup = e, this.explicitOrderBy = n, this.filters = r, this.limit = s, this.limitType = i, this.startAt = o, this.endAt = u, this.q = null, // The corresponding `Target` of this `Query` instance.
  this.O = null, this.startAt, this.endAt;
});
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Returns an DoubleValue for `value` that is encoded based the serializer's
 * `useProto3Json` setting.
 */

/**
 * Returns a value for a number that's appropriate to put into a proto.
 * The return value is an IntegerValue if it can safely represent the value,
 * otherwise a DoubleValue is returned.
 */


function ge(t, e) {
  return function (t) {
    return "number" == typeof t && Number.isInteger(t) && !at(t) && t <= Number.MAX_SAFE_INTEGER && t >= Number.MIN_SAFE_INTEGER;
  }(e) ?
  /**
  * Returns an IntegerValue for `value`.
  */
  function (t) {
    return {
      integerValue: "" + t
    };
  }(e) : function (t, e) {
    if (t.k) {
      if (isNaN(e)) return {
        doubleValue: "NaN"
      };
      if (e === 1 / 0) return {
        doubleValue: "Infinity"
      };
      if (e === -1 / 0) return {
        doubleValue: "-Infinity"
      };
    }

    return {
      doubleValue: at(e) ? "-0" : e
    };
  }(t, e);
}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/** Used to represent a field transform on a mutation. */


var ve = /*#__PURE__*/_createClass(function ve() {
  _classCallCheck(this, ve);

  // Make sure that the structural type of `TransformOperation` is unique.
  // See https://github.com/microsoft/TypeScript/issues/5451
  this._ = void 0;
});
/** Transforms a value into a server-generated timestamp. */


var be = /*#__PURE__*/function (_ve) {
  _inherits(be, _ve);

  var _super13 = _createSuper(be);

  function be() {
    _classCallCheck(this, be);

    return _super13.apply(this, arguments);
  }

  return _createClass(be);
}(ve);
/** Transforms an array value via a union operation. */


var Ee = /*#__PURE__*/function (_ve2) {
  _inherits(Ee, _ve2);

  var _super14 = _createSuper(Ee);

  function Ee(t) {
    var _this15;

    _classCallCheck(this, Ee);

    _this15 = _super14.call(this), _this15.elements = t;
    return _this15;
  }

  return _createClass(Ee);
}(ve);
/** Transforms an array value via a remove operation. */


var Te = /*#__PURE__*/function (_ve3) {
  _inherits(Te, _ve3);

  var _super15 = _createSuper(Te);

  function Te(t) {
    var _this16;

    _classCallCheck(this, Te);

    _this16 = _super15.call(this), _this16.elements = t;
    return _this16;
  }

  return _createClass(Te);
}(ve);
/**
 * Implements the backend semantics for locally computed NUMERIC_ADD (increment)
 * transforms. Converts all field values to integers or doubles, but unlike the
 * backend does not cap integer values at 2^63. Instead, JavaScript number
 * arithmetic is used and precision loss can occur for values greater than 2^53.
 */


var Ie = /*#__PURE__*/function (_ve4) {
  _inherits(Ie, _ve4);

  var _super16 = _createSuper(Ie);

  function Ie(t, e) {
    var _this17;

    _classCallCheck(this, Ie);

    _this17 = _super16.call(this), _this17.C = t, _this17.L = e;
    return _this17;
  }

  return _createClass(Ie);
}(ve);
/**
 * Encodes a precondition for a mutation. This follows the model that the
 * backend accepts with the special case of an explicit "empty" precondition
 * (meaning no precondition).
 */


var Re = /*#__PURE__*/function () {
  function Re(t, e) {
    _classCallCheck(this, Re);

    this.updateTime = t, this.exists = e;
  }
  /** Creates a new empty Precondition. */


  _createClass(Re, [{
    key: "isNone",
    get:
    /** Returns whether this Precondition is empty. */
    function get() {
      return void 0 === this.updateTime && void 0 === this.exists;
    }
  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return this.exists === t.exists && (this.updateTime ? !!t.updateTime && this.updateTime.isEqual(t.updateTime) : !t.updateTime);
    }
  }], [{
    key: "none",
    value: function none() {
      return new Re();
    }
    /** Creates a new Precondition with an exists flag. */

  }, {
    key: "exists",
    value: function exists(t) {
      return new Re(void 0, t);
    }
    /** Creates a new Precondition based on a version a document exists at. */

  }, {
    key: "updateTime",
    value: function updateTime(t) {
      return new Re(t);
    }
  }]);

  return Re;
}();
/**
 * A mutation describes a self-contained change to a document. Mutations can
 * create, replace, delete, and update subsets of documents.
 *
 * Mutations not only act on the value of the document but also its version.
 *
 * For local mutations (mutations that haven't been committed yet), we preserve
 * the existing version for Set and Patch mutations. For Delete mutations, we
 * reset the version to 0.
 *
 * Here's the expected transition table.
 *
 * MUTATION           APPLIED TO            RESULTS IN
 *
 * SetMutation        Document(v3)          Document(v3)
 * SetMutation        NoDocument(v3)        Document(v0)
 * SetMutation        InvalidDocument(v0)   Document(v0)
 * PatchMutation      Document(v3)          Document(v3)
 * PatchMutation      NoDocument(v3)        NoDocument(v3)
 * PatchMutation      InvalidDocument(v0)   UnknownDocument(v3)
 * DeleteMutation     Document(v3)          NoDocument(v0)
 * DeleteMutation     NoDocument(v3)        NoDocument(v0)
 * DeleteMutation     InvalidDocument(v0)   NoDocument(v0)
 *
 * For acknowledged mutations, we use the updateTime of the WriteResponse as
 * the resulting version for Set and Patch mutations. As deletes have no
 * explicit update time, we use the commitTime of the WriteResponse for
 * Delete mutations.
 *
 * If a mutation is acknowledged by the backend but fails the precondition check
 * locally, we transition to an `UnknownDocument` and rely on Watch to send us
 * the updated version.
 *
 * Field transforms are used only with Patch and Set Mutations. We use the
 * `updateTransforms` message to store transforms, rather than the `transforms`s
 * messages.
 *
 * ## Subclassing Notes
 *
 * Every type of mutation needs to implement its own applyToRemoteDocument() and
 * applyToLocalView() to implement the actual behavior of applying the mutation
 * to some source document (see `setMutationApplyToRemoteDocument()` for an
 * example).
 */


var Pe = /*#__PURE__*/_createClass(function Pe() {
  _classCallCheck(this, Pe);
});
/**
 * A mutation that creates or replaces the document at the given key with the
 * object value contents.
 */


var Ve = /*#__PURE__*/function (_Pe) {
  _inherits(Ve, _Pe);

  var _super17 = _createSuper(Ve);

  function Ve(t, e, n) {
    var _this18;

    var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];

    _classCallCheck(this, Ve);

    _this18 = _super17.call(this), _this18.key = t, _this18.value = e, _this18.precondition = n, _this18.fieldTransforms = r, _this18.type = 0
    /* Set */
    ;
    return _this18;
  }

  _createClass(Ve, [{
    key: "getFieldMask",
    value: function getFieldMask() {
      return null;
    }
  }]);

  return Ve;
}(Pe);
/**
 * A mutation that modifies fields of the document at the given key with the
 * given values. The values are applied through a field mask:
 *
 *  * When a field is in both the mask and the values, the corresponding field
 *    is updated.
 *  * When a field is in neither the mask nor the values, the corresponding
 *    field is unmodified.
 *  * When a field is in the mask but not in the values, the corresponding field
 *    is deleted.
 *  * When a field is not in the mask but is in the values, the values map is
 *    ignored.
 */


var Ne = /*#__PURE__*/function (_Pe2) {
  _inherits(Ne, _Pe2);

  var _super18 = _createSuper(Ne);

  function Ne(t, e, n, r) {
    var _this19;

    var s = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [];

    _classCallCheck(this, Ne);

    _this19 = _super18.call(this), _this19.key = t, _this19.data = e, _this19.fieldMask = n, _this19.precondition = r, _this19.fieldTransforms = s, _this19.type = 1
    /* Patch */
    ;
    return _this19;
  }

  _createClass(Ne, [{
    key: "getFieldMask",
    value: function getFieldMask() {
      return this.fieldMask;
    }
  }]);

  return Ne;
}(Pe);
/** A mutation that deletes the document at the given key. */


var De = /*#__PURE__*/function (_Pe3) {
  _inherits(De, _Pe3);

  var _super19 = _createSuper(De);

  function De(t, e) {
    var _this20;

    _classCallCheck(this, De);

    _this20 = _super19.call(this), _this20.key = t, _this20.precondition = e, _this20.type = 2
    /* Delete */
    , _this20.fieldTransforms = [];
    return _this20;
  }

  _createClass(De, [{
    key: "getFieldMask",
    value: function getFieldMask() {
      return null;
    }
  }]);

  return De;
}(Pe);
/**
 * A mutation that verifies the existence of the document at the given key with
 * the provided precondition.
 *
 * The `verify` operation is only used in Transactions, and this class serves
 * primarily to facilitate serialization into protos.
 */


var $e = /*#__PURE__*/function (_Pe4) {
  _inherits($e, _Pe4);

  var _super20 = _createSuper($e);

  function $e(t, e) {
    var _this21;

    _classCallCheck(this, $e);

    _this21 = _super20.call(this), _this21.key = t, _this21.precondition = e, _this21.type = 3
    /* Verify */
    , _this21.fieldTransforms = [];
    return _this21;
  }

  _createClass($e, [{
    key: "getFieldMask",
    value: function getFieldMask() {
      return null;
    }
  }]);

  return $e;
}(Pe);
/**
 * This class generates JsonObject values for the Datastore API suitable for
 * sending to either GRPC stub methods or via the JSON/HTTP REST API.
 *
 * The serializer supports both Protobuf.js and Proto3 JSON formats. By
 * setting `useProto3Json` to true, the serializer will use the Proto3 JSON
 * format.
 *
 * For a description of the Proto3 JSON format check
 * https://developers.google.com/protocol-buffers/docs/proto3#json
 *
 * TODO(klimt): We can remove the databaseId argument if we keep the full
 * resource name in documents.
 */


var Se = /*#__PURE__*/_createClass(function Se(t, e) {
  _classCallCheck(this, Se);

  this.databaseId = t, this.k = e;
});
/**
 * Returns a value for a number (or null) that's appropriate to put into
 * a google.protobuf.Int32Value proto.
 * DO NOT USE THIS FOR ANYTHING ELSE.
 * This method cheats. It's typed as returning "number" because that's what
 * our generated proto interfaces say Int32Value must be. But GRPC actually
 * expects a { value: <number> } struct.
 */

/**
 * Returns a value for a Date that's appropriate to put into a proto.
 */


function qe(t, e) {
  if (t.k) {
    return "".concat(new Date(1e3 * e.seconds).toISOString().replace(/\.\d*/, "").replace("Z", ""), ".").concat(("000000000" + e.nanoseconds).slice(-9), "Z");
  }

  return {
    seconds: "" + e.seconds,
    nanos: e.nanoseconds
  };
}
/**
 * Returns a value for bytes that's appropriate to put in a proto.
 *
 * Visible for testing.
 */


function Oe(t, e) {
  return t.k ? e.toBase64() : e.toUint8Array();
}

function ke(t, e) {
  return qe(t, e.toTimestamp());
}

function Ce(t) {
  return v(!!t), vt.fromTimestamp(function (t) {
    var e = $t(t);
    return new gt(e.seconds, e.nanos);
  }(t));
}

function Le(t, e) {
  return function (t) {
    return new X(["projects", t.projectId, "databases", t.database]);
  }(t).child("documents").child(e).canonicalString();
}

function Me(t, e) {
  return Le(t.databaseId, e.path);
}

function Ue(t, e) {
  var n = function (t) {
    var e = X.fromString(t);
    return v(Xe(e)), e;
  }(e);

  if (n.get(1) !== t.databaseId.projectId) throw new L(A, "Tried to deserialize key from different project: " + n.get(1) + " vs " + t.databaseId.projectId);
  if (n.get(3) !== t.databaseId.database) throw new L(A, "Tried to deserialize key from different database: " + n.get(3) + " vs " + t.databaseId.database);
  return new et((v((r = n).length > 4 && "documents" === r.get(4)), r.popFirst(5)));
  var r;
  /** Creates a Document proto from key and fields (but no create/update time) */
}

function Be(t) {
  return new X(["projects", t.databaseId.projectId, "databases", t.databaseId.database]).canonicalString();
}

function ze(t, e, n) {
  return {
    name: Me(t, e),
    fields: n.value.mapValue.fields
  };
}

function Ge(t, e) {
  return "found" in e ? function (t, e) {
    v(!!e.found), e.found.name, e.found.updateTime;
    var n = Ue(t, e.found.name),
        r = Ce(e.found.updateTime),
        s = new Yt({
      mapValue: {
        fields: e.found.fields
      }
    });
    return Ht.newFoundDocument(n, r, s);
  }(t, e) : "missing" in e ? function (t, e) {
    v(!!e.missing), v(!!e.readTime);
    var n = Ue(t, e.missing),
        r = Ce(e.readTime);
    return Ht.newNoDocument(n, r);
  }(t, e) : g();
}

function We(t, e) {
  var n;
  if (e instanceof Ve) n = {
    update: ze(t, e.key, e.value)
  };else if (e instanceof De) n = {
    delete: Me(t, e.key)
  };else if (e instanceof Ne) n = {
    update: ze(t, e.key, e.data),
    updateMask: Je(e.fieldMask)
  };else {
    if (!(e instanceof $e)) return g();
    n = {
      verify: Me(t, e.key)
    };
  }
  return e.fieldTransforms.length > 0 && (n.updateTransforms = e.fieldTransforms.map(function (t) {
    return function (t, e) {
      var n = e.transform;
      if (n instanceof be) return {
        fieldPath: e.field.canonicalString(),
        setToServerValue: "REQUEST_TIME"
      };
      if (n instanceof Ee) return {
        fieldPath: e.field.canonicalString(),
        appendMissingElements: {
          values: n.elements
        }
      };
      if (n instanceof Te) return {
        fieldPath: e.field.canonicalString(),
        removeAllFromArray: {
          values: n.elements
        }
      };
      if (n instanceof Ie) return {
        fieldPath: e.field.canonicalString(),
        increment: n.L
      };
      throw g();
    }(0, t);
  })), e.precondition.isNone || (n.currentDocument = function (t, e) {
    return void 0 !== e.updateTime ? {
      updateTime: ke(t, e.updateTime)
    } : void 0 !== e.exists ? {
      exists: e.exists
    } : g();
  }(t, e.precondition)), n;
}

function Je(t) {
  var e = [];
  return t.fields.forEach(function (t) {
    return e.push(t.canonicalString());
  }), {
    fieldPaths: e
  };
}

function Xe(t) {
  // Resource names have at least 4 components (project ID, database ID)
  return t.length >= 4 && "projects" === t.get(0) && "databases" === t.get(2);
}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


function Ze(t) {
  return new Se(t,
  /* useProto3Json= */
  !0);
}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Datastore and its related methods are a wrapper around the external Google
 * Cloud Datastore grpc API, which provides an interface that is more convenient
 * for the rest of the client SDK architecture to consume.
 */

/**
 * An implementation of Datastore that exposes additional state for internal
 * consumption.
 */


var en = /*#__PURE__*/function (_ref3) {
  _inherits(en, _ref3);

  var _super21 = _createSuper(en);

  function en(t, e, n, r) {
    var _this23;

    _classCallCheck(this, en);

    _this23 = _super21.call(this), _this23.authCredentials = t, _this23.appCheckCredentials = e, _this23.Z = n, _this23.C = r, _this23.tt = !1;
    return _this23;
  }

  _createClass(en, [{
    key: "et",
    value: function et() {
      if (this.tt) throw new L(x, "The client has already been terminated.");
    }
    /** Invokes the provided RPC with auth and AppCheck tokens. */

  }, {
    key: "v",
    value: function v(t, e, n) {
      var _this24 = this;

      return this.et(), Promise.all([this.authCredentials.getToken(), this.appCheckCredentials.getToken()]).then(function (_ref4) {
        var _ref5 = _slicedToArray(_ref4, 2),
            r = _ref5[0],
            s = _ref5[1];

        return _this24.Z.v(t, e, n, r, s);
      }).catch(function (t) {
        throw "FirebaseError" === t.name ? (t.code === D && (_this24.authCredentials.invalidateToken(), _this24.appCheckCredentials.invalidateToken()), t) : new L(I, t.toString());
      });
    }
    /** Invokes the provided RPC with streamed results with auth and AppCheck tokens. */

  }, {
    key: "R",
    value: function R(t, e, n, r) {
      var _this25 = this;

      return this.et(), Promise.all([this.authCredentials.getToken(), this.appCheckCredentials.getToken()]).then(function (_ref6) {
        var _ref7 = _slicedToArray(_ref6, 2),
            s = _ref7[0],
            i = _ref7[1];

        return _this25.Z.R(t, e, n, s, i, r);
      }).catch(function (t) {
        throw "FirebaseError" === t.name ? (t.code === D && (_this25.authCredentials.invalidateToken(), _this25.appCheckCredentials.invalidateToken()), t) : new L(I, t.toString());
      });
    }
  }, {
    key: "terminate",
    value: function terminate() {
      this.tt = !0;
    }
  }]);

  return en;
}( /*#__PURE__*/function () {
  function _class4() {
    _classCallCheck(this, _class4);
  }

  return _createClass(_class4);
}()); // TODO(firestorexp): Make sure there is only one Datastore instance per
// firestore-exp client.


function nn(_x5, _x6) {
  return _nn.apply(this, arguments);
}

function _nn() {
  _nn = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee7(t, e) {
    var n, r, s;
    return regenerator.wrap(function _callee7$(_context7) {
      while (1) {
        switch (_context7.prev = _context7.next) {
          case 0:
            n = b(t), r = Be(n.C) + "/documents", s = {
              writes: e.map(function (t) {
                return We(n.C, t);
              })
            };
            _context7.next = 3;
            return n.v("Commit", r, s);

          case 3:
          case "end":
            return _context7.stop();
        }
      }
    }, _callee7);
  }));
  return _nn.apply(this, arguments);
}

function rn(_x7, _x8) {
  return _rn.apply(this, arguments);
}

function _rn() {
  _rn = _asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee8(t, e) {
    var n, r, s, i, o, u;
    return regenerator.wrap(function _callee8$(_context8) {
      while (1) {
        switch (_context8.prev = _context8.next) {
          case 0:
            n = b(t);
            r = Be(n.C) + "/documents";
            s = {
              documents: e.map(function (t) {
                return Me(n.C, t);
              })
            };
            _context8.next = 5;
            return n.R("BatchGetDocuments", r, s, e.length);

          case 5:
            i = _context8.sent;
            o = new Map();
            i.forEach(function (t) {
              var e = Ge(n.C, t);
              o.set(e.key.toString(), e);
            });
            u = [];
            return _context8.abrupt("return", (e.forEach(function (t) {
              var e = o.get(t.toString());
              v(!!e), u.push(e);
            }), u));

          case 10:
          case "end":
            return _context8.stop();
        }
      }
    }, _callee8);
  }));
  return _rn.apply(this, arguments);
}

var on = new Map();
/**
 * An instance map that ensures only one Datastore exists per Firestore
 * instance.
 */

/**
 * Returns an initialized and started Datastore for the given Firestore
 * instance. Callers must invoke removeComponents() when the Firestore
 * instance is terminated.
 */

function un(t) {
  if (t._terminated) throw new L(x, "The client has already been terminated.");

  if (!on.has(t)) {
    m("ComponentProvider", "Initializing Datastore");

    var i = function (t) {
      return new wt(t, fetch.bind(null));
    }((e = t._databaseId, n = t.app.options.appId || "", r = t._persistenceKey, s = t._freezeSettings(), new Y(e, n, r, s.host, s.ssl, s.experimentalForceLongPolling, s.experimentalAutoDetectLongPolling, s.useFetchStreams))),
        o = Ze(t._databaseId),
        u = function (t, e, n, r) {
      return new en(t, e, n, r);
    }(t._authCredentials, t._appCheckCredentials, i, o);

    on.set(t, u);
  }

  var e, n, r, s;
  /**
  * @license
  * Copyright 2018 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */

  return on.get(t);
}
/**
 * Removes all components associated with the provided instance. Must be called
 * when the `Firestore` instance is terminated.
 */

/**
 * A concrete type describing all the values that can be applied via a
 * user-supplied `FirestoreSettings` object. This is a separate type so that
 * defaults can be supplied and the value can be checked for equality.
 */


var cn = /*#__PURE__*/function () {
  function cn(t) {
    _classCallCheck(this, cn);

    var e;

    if (void 0 === t.host) {
      if (void 0 !== t.ssl) throw new L(A, "Can't provide ssl option if host option is not set");
      this.host = "firestore.googleapis.com", this.ssl = true;
    } else this.host = t.host, this.ssl = null === (e = t.ssl) || void 0 === e || e;

    if (this.credentials = t.credentials, this.ignoreUndefinedProperties = !!t.ignoreUndefinedProperties, void 0 === t.cacheSizeBytes) this.cacheSizeBytes = 41943040;else {
      if (-1 !== t.cacheSizeBytes && t.cacheSizeBytes < 1048576) throw new L(A, "cacheSizeBytes must be at least 1048576");
      this.cacheSizeBytes = t.cacheSizeBytes;
    }
    this.experimentalForceLongPolling = !!t.experimentalForceLongPolling, this.experimentalAutoDetectLongPolling = !!t.experimentalAutoDetectLongPolling, this.useFetchStreams = !!t.useFetchStreams, function (t, e, n, r) {
      if (!0 === e && !0 === r) throw new L(A, "".concat(t, " and ").concat(n, " cannot be used together."));
    }("experimentalForceLongPolling", t.experimentalForceLongPolling, "experimentalAutoDetectLongPolling", t.experimentalAutoDetectLongPolling);
  }

  _createClass(cn, [{
    key: "isEqual",
    value: function isEqual(t) {
      return this.host === t.host && this.ssl === t.ssl && this.credentials === t.credentials && this.cacheSizeBytes === t.cacheSizeBytes && this.experimentalForceLongPolling === t.experimentalForceLongPolling && this.experimentalAutoDetectLongPolling === t.experimentalAutoDetectLongPolling && this.ignoreUndefinedProperties === t.ignoreUndefinedProperties && this.useFetchStreams === t.useFetchStreams;
    }
  }]);

  return cn;
}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * The Cloud Firestore service interface.
 *
 * Do not call this constructor directly. Instead, use {@link getFirestore}.
 */


var an = /*#__PURE__*/function () {
  /** @hideconstructor */
  function an(t, e, n, r) {
    _classCallCheck(this, an);

    this._authCredentials = t, this._appCheckCredentials = e, this._databaseId = n, this._app = r,
    /**
     * Whether it's a Firestore or Firestore Lite instance.
     */
    this.type = "firestore-lite", this._persistenceKey = "(lite)", this._settings = new cn({}), this._settingsFrozen = !1;
  }
  /**
   * The {@link @firebase/app#FirebaseApp} associated with this `Firestore` service
   * instance.
   */


  _createClass(an, [{
    key: "app",
    get: function get() {
      if (!this._app) throw new L(x, "Firestore was not initialized using the Firebase SDK. 'app' is not available");
      return this._app;
    }
  }, {
    key: "_initialized",
    get: function get() {
      return this._settingsFrozen;
    }
  }, {
    key: "_terminated",
    get: function get() {
      return void 0 !== this._terminateTask;
    }
  }, {
    key: "_setSettings",
    value: function _setSettings(t) {
      if (this._settingsFrozen) throw new L(x, "Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");
      this._settings = new cn(t), void 0 !== t.credentials && (this._authCredentials = function (t) {
        if (!t) return new j();

        switch (t.type) {
          case "gapi":
            var e = t.client;
            return new W(e, t.sessionIndex || "0", t.iamToken || null, t.authTokenFactory || null);

          case "provider":
            return t.client;

          default:
            throw new L(A, "makeAuthCredentialsProvider failed due to invalid credential type");
        }
      }(t.credentials));
    }
  }, {
    key: "_getSettings",
    value: function _getSettings() {
      return this._settings;
    }
  }, {
    key: "_freezeSettings",
    value: function _freezeSettings() {
      return this._settingsFrozen = !0, this._settings;
    }
  }, {
    key: "_delete",
    value: function _delete() {
      return this._terminateTask || (this._terminateTask = this._terminate()), this._terminateTask;
    }
    /** Returns a JSON-serializable representation of this `Firestore` instance. */

  }, {
    key: "toJSON",
    value: function toJSON() {
      return {
        app: this._app,
        databaseId: this._databaseId,
        settings: this._settings
      };
    }
    /**
     * Terminates all components used by this client. Subclasses can override
     * this method to clean up their own dependencies, but must also call this
     * method.
     *
     * Only ever called once.
     */

  }, {
    key: "_terminate",
    value: function _terminate() {
      return function (t) {
        var e = on.get(t);
        e && (m("ComponentProvider", "Removing Datastore"), on.delete(t), e.terminate());
      }(this), Promise.resolve();
    }
  }]);

  return an;
}();

function ln(e, n) {
  var r = "object" == _typeof$1(e) ? e : getApp(),
      s = "string" == typeof e ? e : n || "(default)";
  return _getProvider(r, "firestore/lite").getImmediate({
    identifier: s
  });
}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * A `DocumentReference` refers to a document location in a Firestore database
 * and can be used to write, read, or listen to the location. The document at
 * the referenced location may or may not exist.
 */


var wn = /*#__PURE__*/function () {
  /** @hideconstructor */
  function wn(t,
  /**
   * If provided, the `FirestoreDataConverter` associated with this instance.
   */
  e, n) {
    _classCallCheck(this, wn);

    this.converter = e, this._key = n,
    /** The type of this Firestore reference. */
    this.type = "document", this.firestore = t;
  }

  _createClass(wn, [{
    key: "_path",
    get: function get() {
      return this._key.path;
    }
    /**
     * The document's identifier within its collection.
     */

  }, {
    key: "id",
    get: function get() {
      return this._key.path.lastSegment();
    }
    /**
     * A string representing the path of the referenced document (relative
     * to the root of the database).
     */

  }, {
    key: "path",
    get: function get() {
      return this._key.path.canonicalString();
    }
    /**
     * The collection this `DocumentReference` belongs to.
     */

  }, {
    key: "parent",
    get: function get() {
      return new pn(this.firestore, this.converter, this._key.path.popLast());
    }
  }, {
    key: "withConverter",
    value: function withConverter(t) {
      return new wn(this.firestore, t, this._key);
    }
  }]);

  return wn;
}();
/**
 * A `Query` refers to a query which you can read or listen to. You can also
 * construct refined `Query` objects by adding filters and ordering.
 */


var mn = /*#__PURE__*/function () {
  // This is the lite version of the Query class in the main SDK.

  /** @hideconstructor protected */
  function mn(t,
  /**
   * If provided, the `FirestoreDataConverter` associated with this instance.
   */
  e, n) {
    _classCallCheck(this, mn);

    this.converter = e, this._query = n,
    /** The type of this Firestore reference. */
    this.type = "query", this.firestore = t;
  }

  _createClass(mn, [{
    key: "withConverter",
    value: function withConverter(t) {
      return new mn(this.firestore, t, this._query);
    }
  }]);

  return mn;
}();
/**
 * A `CollectionReference` object can be used for adding documents, getting
 * document references, and querying for documents (using {@link query}).
 */


var pn = /*#__PURE__*/function (_mn) {
  _inherits(pn, _mn);

  var _super22 = _createSuper(pn);

  /** @hideconstructor */
  function pn(t, e, n) {
    var _this26;

    _classCallCheck(this, pn);

    _this26 = _super22.call(this, t, e, new fe(n)), _this26._path = n,
    /** The type of this Firestore reference. */
    _this26.type = "collection";
    return _this26;
  }
  /** The collection's identifier. */


  _createClass(pn, [{
    key: "id",
    get: function get() {
      return this._query.path.lastSegment();
    }
    /**
     * A string representing the path of the referenced collection (relative
     * to the root of the database).
     */

  }, {
    key: "path",
    get: function get() {
      return this._query.path.canonicalString();
    }
    /**
     * A reference to the containing `DocumentReference` if this is a
     * subcollection. If this isn't a subcollection, the reference is null.
     */

  }, {
    key: "parent",
    get: function get() {
      var t = this._path.popLast();

      return t.isEmpty() ? null : new wn(this.firestore,
      /* converter= */
      null, new et(t));
    }
  }, {
    key: "withConverter",
    value: function withConverter(t) {
      return new pn(this.firestore, t, this._path);
    }
  }]);

  return pn;
}(mn);

function gn(t, e) {
  for (var _len6 = arguments.length, n = new Array(_len6 > 2 ? _len6 - 2 : 0), _key6 = 2; _key6 < _len6; _key6++) {
    n[_key6 - 2] = arguments[_key6];
  }

  if (t = getModularInstance(t), // We allow omission of 'pathString' but explicitly prohibit passing in both
  // 'undefined' and 'null'.
  1 === arguments.length && (e = pt.N()), nt("doc", "path", e), t instanceof an) {
    var r = X.fromString.apply(X, [e].concat(n));
    return rt(r), new wn(t,
    /* converter= */
    null, new et(r));
  }

  {
    if (!(t instanceof wn || t instanceof pn)) throw new L(A, "Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");

    var _r3 = t._path.child(X.fromString.apply(X, [e].concat(n)));

    return rt(_r3), new wn(t.firestore, t instanceof pn ? t.converter : null, new et(_r3));
  }
}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * A `FieldPath` refers to a field in a document. The path may consist of a
 * single field name (referring to a top-level field in the document), or a
 * list of field names (referring to a nested field in the document).
 *
 * Create a `FieldPath` by providing field names. If more than one field
 * name is provided, the path will point to a nested field in a document.
 */


var En = /*#__PURE__*/function () {
  /**
   * Creates a `FieldPath` from the provided field names. If more than one field
   * name is provided, the path will point to a nested field in a document.
   *
   * @param fieldNames - A list of field names.
   */
  function En() {
    _classCallCheck(this, En);

    for (var _len7 = arguments.length, t = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {
      t[_key7] = arguments[_key7];
    }

    for (var e = 0; e < t.length; ++e) {
      if (0 === t[e].length) throw new L(A, "Invalid field name at argument $(i + 1). Field names must not be empty.");
    }

    this._internalPath = new tt(t);
  }
  /**
   * Returns true if this `FieldPath` is equal to the provided one.
   *
   * @param other - The `FieldPath` to compare against.
   * @returns true if this `FieldPath` is equal to the provided one.
   */


  _createClass(En, [{
    key: "isEqual",
    value: function isEqual(t) {
      return this._internalPath.isEqual(t._internalPath);
    }
  }]);

  return En;
}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * An immutable object representing an array of bytes.
 */


var In = /*#__PURE__*/function () {
  /** @hideconstructor */
  function In(t) {
    _classCallCheck(this, In);

    this._byteString = t;
  }
  /**
   * Creates a new `Bytes` object from the given Base64 string, converting it to
   * bytes.
   *
   * @param base64 - The Base64 string used to create the `Bytes` object.
   */


  _createClass(In, [{
    key: "toBase64",
    value:
    /**
     * Returns the underlying bytes as a Base64-encoded string.
     *
     * @returns The Base64-encoded string created from the `Bytes` object.
     */
    function toBase64() {
      return this._byteString.toBase64();
    }
    /**
     * Returns the underlying bytes in a new `Uint8Array`.
     *
     * @returns The Uint8Array created from the `Bytes` object.
     */

  }, {
    key: "toUint8Array",
    value: function toUint8Array() {
      return this._byteString.toUint8Array();
    }
    /**
     * Returns a string representation of the `Bytes` object.
     *
     * @returns A string representation of the `Bytes` object.
     */

  }, {
    key: "toString",
    value: function toString() {
      return "Bytes(base64: " + this.toBase64() + ")";
    }
    /**
     * Returns true if this `Bytes` object is equal to the provided one.
     *
     * @param other - The `Bytes` object to compare against.
     * @returns true if this `Bytes` object is equal to the provided one.
     */

  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return this._byteString.isEqual(t._byteString);
    }
  }], [{
    key: "fromBase64String",
    value: function fromBase64String(t) {
      try {
        return new In(Nt.fromBase64String(t));
      } catch (t) {
        throw new L(A, "Failed to construct data from Base64 string: " + t);
      }
    }
    /**
     * Creates a new `Bytes` object from the given Uint8Array.
     *
     * @param array - The Uint8Array used to create the `Bytes` object.
     */

  }, {
    key: "fromUint8Array",
    value: function fromUint8Array(t) {
      return new In(Nt.fromUint8Array(t));
    }
  }]);

  return In;
}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Sentinel values that can be used when writing document fields with `set()`
 * or `update()`.
 */


var An = /*#__PURE__*/_createClass(
/**
 * @param _methodName - The public API endpoint that returns this class.
 * @hideconstructor
 */
function An(t) {
  _classCallCheck(this, An);

  this._methodName = t;
});
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * An immutable object representing a geographic location in Firestore. The
 * location is represented as latitude/longitude pair.
 *
 * Latitude values are in the range of [-90, 90].
 * Longitude values are in the range of [-180, 180].
 */


var Rn = /*#__PURE__*/function () {
  /**
   * Creates a new immutable `GeoPoint` object with the provided latitude and
   * longitude values.
   * @param latitude - The latitude as number between -90 and 90.
   * @param longitude - The longitude as number between -180 and 180.
   */
  function Rn(t, e) {
    _classCallCheck(this, Rn);

    if (!isFinite(t) || t < -90 || t > 90) throw new L(A, "Latitude must be a number between -90 and 90, but was: " + t);
    if (!isFinite(e) || e < -180 || e > 180) throw new L(A, "Longitude must be a number between -180 and 180, but was: " + e);
    this._lat = t, this._long = e;
  }
  /**
   * The latitude of this `GeoPoint` instance.
   */


  _createClass(Rn, [{
    key: "latitude",
    get: function get() {
      return this._lat;
    }
    /**
     * The longitude of this `GeoPoint` instance.
     */

  }, {
    key: "longitude",
    get: function get() {
      return this._long;
    }
    /**
     * Returns true if this `GeoPoint` is equal to the provided one.
     *
     * @param other - The `GeoPoint` to compare against.
     * @returns true if this `GeoPoint` is equal to the provided one.
     */

  }, {
    key: "isEqual",
    value: function isEqual(t) {
      return this._lat === t._lat && this._long === t._long;
    }
    /** Returns a JSON-serializable representation of this GeoPoint. */

  }, {
    key: "toJSON",
    value: function toJSON() {
      return {
        latitude: this._lat,
        longitude: this._long
      };
    }
    /**
     * Actually private to JS consumers of our API, so this function is prefixed
     * with an underscore.
     */

  }, {
    key: "_compareTo",
    value: function _compareTo(t) {
      return yt(this._lat, t._lat) || yt(this._long, t._long);
    }
  }]);

  return Rn;
}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


var Pn = /^__.*__$/;
/** The result of parsing document data (e.g. for a setData call). */

var Vn = /*#__PURE__*/function () {
  function Vn(t, e, n) {
    _classCallCheck(this, Vn);

    this.data = t, this.fieldMask = e, this.fieldTransforms = n;
  }

  _createClass(Vn, [{
    key: "toMutation",
    value: function toMutation(t, e) {
      return null !== this.fieldMask ? new Ne(t, this.data, this.fieldMask, e, this.fieldTransforms) : new Ve(t, this.data, e, this.fieldTransforms);
    }
  }]);

  return Vn;
}();

function Dn(t) {
  switch (t) {
    case 0
    /* Set */
    : // fall through

    case 2
    /* MergeSet */
    : // fall through

    case 1
    /* Update */
    :
      return !0;

    case 3
    /* Argument */
    :
    case 4
    /* ArrayArgument */
    :
      return !1;

    default:
      throw g();
  }
}
/** A "context" object passed around while parsing user data. */


var $n = /*#__PURE__*/function () {
  /**
   * Initializes a ParseContext with the given source and path.
   *
   * @param settings - The settings for the parser.
   * @param databaseId - The database ID of the Firestore instance.
   * @param serializer - The serializer to use to generate the Value proto.
   * @param ignoreUndefinedProperties - Whether to ignore undefined properties
   * rather than throw.
   * @param fieldTransforms - A mutable list of field transforms encountered
   * while parsing the data.
   * @param fieldMask - A mutable list of field paths encountered while parsing
   * the data.
   *
   * TODO(b/34871131): We don't support array paths right now, so path can be
   * null to indicate the context represents any location within an array (in
   * which case certain features will not work and errors will be somewhat
   * compromised).
   */
  function $n(t, e, n, r, s, i) {
    _classCallCheck(this, $n);

    this.settings = t, this.databaseId = e, this.C = n, this.ignoreUndefinedProperties = r, // Minor hack: If fieldTransforms is undefined, we assume this is an
    // external call and we need to validate the entire path.
    void 0 === s && this.nt(), this.fieldTransforms = s || [], this.fieldMask = i || [];
  }

  _createClass($n, [{
    key: "path",
    get: function get() {
      return this.settings.path;
    }
  }, {
    key: "rt",
    get: function get() {
      return this.settings.rt;
    }
    /** Returns a new context with the specified settings overwritten. */

  }, {
    key: "st",
    value: function st(t) {
      return new $n(Object.assign(Object.assign({}, this.settings), t), this.databaseId, this.C, this.ignoreUndefinedProperties, this.fieldTransforms, this.fieldMask);
    }
  }, {
    key: "it",
    value: function it(t) {
      var e;
      var n = null === (e = this.path) || void 0 === e ? void 0 : e.child(t),
          r = this.st({
        path: n,
        ot: !1
      });
      return r.ut(t), r;
    }
  }, {
    key: "ct",
    value: function ct(t) {
      var e;
      var n = null === (e = this.path) || void 0 === e ? void 0 : e.child(t),
          r = this.st({
        path: n,
        ot: !1
      });
      return r.nt(), r;
    }
  }, {
    key: "at",
    value: function at(t) {
      // TODO(b/34871131): We don't support array paths right now; so make path
      // undefined.
      return this.st({
        path: void 0,
        ot: !0
      });
    }
  }, {
    key: "ht",
    value: function ht(t) {
      return Jn(t, this.settings.methodName, this.settings.lt || !1, this.path, this.settings.ft);
    }
    /** Returns 'true' if 'fieldPath' was traversed when creating this context. */

  }, {
    key: "contains",
    value: function contains(t) {
      return void 0 !== this.fieldMask.find(function (e) {
        return t.isPrefixOf(e);
      }) || void 0 !== this.fieldTransforms.find(function (e) {
        return t.isPrefixOf(e.field);
      });
    }
  }, {
    key: "nt",
    value: function nt() {
      // TODO(b/34871131): Remove null check once we have proper paths for fields
      // within arrays.
      if (this.path) for (var t = 0; t < this.path.length; t++) {
        this.ut(this.path.get(t));
      }
    }
  }, {
    key: "ut",
    value: function ut(t) {
      if (0 === t.length) throw this.ht("Document fields must not be empty");
      if (Dn(this.rt) && Pn.test(t)) throw this.ht('Document fields cannot begin and end with "__"');
    }
  }]);

  return $n;
}();
/**
 * Helper for parsing raw user input (provided via the API) into internal model
 * classes.
 */


var xn = /*#__PURE__*/function () {
  function xn(t, e, n) {
    _classCallCheck(this, xn);

    this.databaseId = t, this.ignoreUndefinedProperties = e, this.C = n || Ze(t);
  }
  /** Creates a new top-level parse context. */


  _createClass(xn, [{
    key: "dt",
    value: function dt(t, e, n) {
      var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !1;
      return new $n({
        rt: t,
        methodName: e,
        ft: n,
        path: tt.emptyPath(),
        ot: !1,
        lt: r
      }, this.databaseId, this.C, this.ignoreUndefinedProperties);
    }
  }]);

  return xn;
}();

function Fn(t) {
  var e = t._freezeSettings(),
      n = Ze(t._databaseId);

  return new xn(t._databaseId, !!e.ignoreUndefinedProperties, n);
}
/** Parse document data from a set() call. */


function Sn(t, e, n, r, s) {
  var i = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};
  var o = t.dt(i.merge || i.mergeFields ? 2
  /* MergeSet */
  : 0
  /* Set */
  , e, n, s);
  Kn("Data must be an object, but it was:", o, r);
  var u = Gn(r, o);
  var c, a;
  if (i.merge) c = new Vt(o.fieldMask), a = o.fieldTransforms;else if (i.mergeFields) {
    var _t15 = [];

    var _iterator8 = _createForOfIteratorHelper(i.mergeFields),
        _step8;

    try {
      for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {
        var _r4 = _step8.value;

        var _s = Qn(e, _r4, n);

        if (!o.contains(_s)) throw new L(A, "Field '".concat(_s, "' is specified in your field mask but missing from your input data."));
        Xn(_t15, _s) || _t15.push(_s);
      }
    } catch (err) {
      _iterator8.e(err);
    } finally {
      _iterator8.f();
    }

    c = new Vt(_t15), a = o.fieldTransforms.filter(function (t) {
      return c.covers(t.field);
    });
  } else c = null, a = o.fieldTransforms;
  return new Vn(new Yt(u), c, a);
}
/**
 * Parses user data to Protobuf Values.
 *
 * @param input - Data to be parsed.
 * @param context - A context object representing the current path being parsed,
 * the source of the data being parsed, etc.
 * @returns The parsed value, or null if the value was a FieldValue sentinel
 * that should not be included in the resulting parsed data.
 */


function zn(t, e) {
  if (Wn( // Unwrap the API type from the Compat SDK. This will return the API type
  // from firestore-exp.
  t = getModularInstance(t))) return Kn("Unsupported field value:", e, t), Gn(t, e);
  if (t instanceof An) // FieldValues usually parse into transforms (except deleteField())
    // in which case we do not want to include this field in our parsed data
    // (as doing so will overwrite the field directly prior to the transform
    // trying to transform it). So we don't add this location to
    // context.fieldMask and we return null as our parsing result.

    /**
    * "Parses" the provided FieldValueImpl, adding any necessary transforms to
    * context.fieldTransforms.
    */
    return function (t, e) {
      // Sentinels are only supported with writes, and not within arrays.
      if (!Dn(e.rt)) throw e.ht("".concat(t._methodName, "() can only be used with update() and set()"));
      if (!e.path) throw e.ht("".concat(t._methodName, "() is not currently supported inside arrays"));

      var n = t._toFieldTransform(e);

      n && e.fieldTransforms.push(n);
    }
    /**
    * Helper to parse a scalar value (i.e. not an Object, Array, or FieldValue)
    *
    * @returns The parsed value
    */
    (t, e), null;
  if (void 0 === t && e.ignoreUndefinedProperties) // If the input is undefined it can never participate in the fieldMask, so
    // don't handle this below. If `ignoreUndefinedProperties` is false,
    // `parseScalarValue` will reject an undefined value.
    return null;

  if ( // If context.path is null we are inside an array and we don't support
  // field mask paths more granular than the top-level array.
  e.path && e.fieldMask.push(e.path), t instanceof Array) {
    // TODO(b/34871131): Include the path containing the array in the error
    // message.
    // In the case of IN queries, the parsed data is an array (representing
    // the set of values to be included for the IN query) that may directly
    // contain additional arrays (each representing an individual field
    // value), so we disable this validation.
    if (e.settings.ot && 4
    /* ArrayArgument */
    !== e.rt) throw e.ht("Nested arrays are not supported");
    return function (t, e) {
      var n = [];
      var r = 0;

      var _iterator9 = _createForOfIteratorHelper(t),
          _step9;

      try {
        for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {
          var s = _step9.value;

          var _t20 = zn(s, e.at(r));

          null == _t20 && ( // Just include nulls in the array for fields being replaced with a
          // sentinel.
          _t20 = {
            nullValue: "NULL_VALUE"
          }), n.push(_t20), r++;
        }
      } catch (err) {
        _iterator9.e(err);
      } finally {
        _iterator9.f();
      }

      return {
        arrayValue: {
          values: n
        }
      };
    }(t, e);
  }

  return function (t, e) {
    if (null === (t = getModularInstance(t))) return {
      nullValue: "NULL_VALUE"
    };
    if ("number" == typeof t) return ge(e.C, t);
    if ("boolean" == typeof t) return {
      booleanValue: t
    };
    if ("string" == typeof t) return {
      stringValue: t
    };

    if (t instanceof Date) {
      var n = gt.fromDate(t);
      return {
        timestampValue: qe(e.C, n)
      };
    }

    if (t instanceof gt) {
      // Firestore backend truncates precision down to microseconds. To ensure
      // offline mode works the same with regards to truncation, perform the
      // truncation immediately without waiting for the backend to do that.
      var _n9 = new gt(t.seconds, 1e3 * Math.floor(t.nanoseconds / 1e3));

      return {
        timestampValue: qe(e.C, _n9)
      };
    }

    if (t instanceof Rn) return {
      geoPointValue: {
        latitude: t.latitude,
        longitude: t.longitude
      }
    };
    if (t instanceof In) return {
      bytesValue: Oe(e.C, t._byteString)
    };

    if (t instanceof wn) {
      var _n10 = e.databaseId,
          r = t.firestore._databaseId;
      if (!r.isEqual(_n10)) throw e.ht("Document reference is for database ".concat(r.projectId, "/").concat(r.database, " but should be for database ").concat(_n10.projectId, "/").concat(_n10.database));
      return {
        referenceValue: Le(t.firestore._databaseId || e.databaseId, t._key.path)
      };
    }

    throw e.ht("Unsupported field value: ".concat(it(t)));
  }
  /**
  * Checks whether an object looks like a JSON object that should be converted
  * into a struct. Normal class/prototype instances are considered to look like
  * JSON objects since they should be converted to a struct value. Arrays, Dates,
  * GeoPoints, etc. are not considered to look like JSON objects since they map
  * to specific FieldValue types other than ObjectValue.
  */
  (t, e);
}

function Gn(t, e) {
  var n = {};
  return !function (t) {
    for (var _e13 in t) {
      if (Object.prototype.hasOwnProperty.call(t, _e13)) return !1;
    }

    return !0;
  }(t) ? Et(t, function (t, r) {
    var s = zn(r, e.it(t));
    null != s && (n[t] = s);
  }) : // If we encounter an empty object, we explicitly add it to the update
  // mask to ensure that the server creates a map entry.
  e.path && e.path.length > 0 && e.fieldMask.push(e.path), {
    mapValue: {
      fields: n
    }
  };
}

function Wn(t) {
  return !("object" != _typeof$1(t) || null === t || t instanceof Array || t instanceof Date || t instanceof gt || t instanceof Rn || t instanceof In || t instanceof wn || t instanceof An);
}

function Kn(t, e, n) {
  if (!Wn(n) || !function (t) {
    return "object" == _typeof$1(t) && null !== t && (Object.getPrototypeOf(t) === Object.prototype || null === Object.getPrototypeOf(t));
  }(n)) {
    var r = it(n);
    throw "an object" === r ? e.ht(t + " a custom object") : e.ht(t + " " + r);
  }
}
/**
 * Helper that calls fromDotSeparatedString() but wraps any error thrown.
 */


function Qn(t, e, n) {
  if (( // If required, replace the FieldPath Compat class with with the firestore-exp
  // FieldPath.
  e = getModularInstance(e)) instanceof En) return e._internalPath;
  if ("string" == typeof e) return Hn(t, e);
  throw Jn("Field path arguments must be of type string or ", t,
  /* hasConverter= */
  !1,
  /* path= */
  void 0, n);
}
/**
 * Matches any characters in a field path string that are reserved.
 */


var Yn = new RegExp("[~\\*/\\[\\]]");
/**
 * Wraps fromDotSeparatedString with an error message about the method that
 * was thrown.
 * @param methodName - The publicly visible method name
 * @param path - The dot-separated string form of a field path which will be
 * split on dots.
 * @param targetDoc - The document against which the field path will be
 * evaluated.
 */

function Hn(t, e, n) {
  if (e.search(Yn) >= 0) throw Jn("Invalid field path (".concat(e, "). Paths must not contain '~', '*', '/', '[', or ']'"), t,
  /* hasConverter= */
  !1,
  /* path= */
  void 0, n);

  try {
    return _construct(En, _toConsumableArray(e.split(".")))._internalPath;
  } catch (r) {
    throw Jn("Invalid field path (".concat(e, "). Paths must not be empty, begin with '.', end with '.', or contain '..'"), t,
    /* hasConverter= */
    !1,
    /* path= */
    void 0, n);
  }
}

function Jn(t, e, n, r, s) {
  var i = r && !r.isEmpty(),
      o = void 0 !== s;
  var u = "Function ".concat(e, "() called with invalid data");
  n && (u += " (via `toFirestore()`)"), u += ". ";
  var c = "";
  return (i || o) && (c += " (found", i && (c += " in field ".concat(r)), o && (c += " in document ".concat(s)), c += ")"), new L(A, u + t + c);
}
/** Checks `haystack` if FieldPath `needle` is present. Runs in O(n). */


function Xn(t, e) {
  return t.some(function (t) {
    return t.isEqual(e);
  });
}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * A `DocumentSnapshot` contains data read from a document in your Firestore
 * database. The data can be extracted with `.data()` or `.get(<field>)` to
 * get a specific field.
 *
 * For a `DocumentSnapshot` that points to a non-existing document, any data
 * access will return 'undefined'. You can use the `exists()` method to
 * explicitly verify a document's existence.
 */


var Zn = /*#__PURE__*/function () {
  // Note: This class is stripped down version of the DocumentSnapshot in
  // the legacy SDK. The changes are:
  // - No support for SnapshotMetadata.
  // - No support for SnapshotOptions.

  /** @hideconstructor protected */
  function Zn(t, e, n, r, s) {
    _classCallCheck(this, Zn);

    this._firestore = t, this._userDataWriter = e, this._key = n, this._document = r, this._converter = s;
  }
  /** Property of the `DocumentSnapshot` that provides the document's ID. */


  _createClass(Zn, [{
    key: "id",
    get: function get() {
      return this._key.path.lastSegment();
    }
    /**
     * The `DocumentReference` for the document included in the `DocumentSnapshot`.
     */

  }, {
    key: "ref",
    get: function get() {
      return new wn(this._firestore, this._converter, this._key);
    }
    /**
     * Signals whether or not the document at the snapshot's location exists.
     *
     * @returns true if the document exists.
     */

  }, {
    key: "exists",
    value: function exists() {
      return null !== this._document;
    }
    /**
     * Retrieves all fields in the document as an `Object`. Returns `undefined` if
     * the document doesn't exist.
     *
     * @returns An `Object` containing all fields in the document or `undefined`
     * if the document doesn't exist.
     */

  }, {
    key: "data",
    value: function data() {
      if (this._document) {
        if (this._converter) {
          // We only want to use the converter and create a new DocumentSnapshot
          // if a converter has been provided.
          var t = new tr(this._firestore, this._userDataWriter, this._key, this._document,
          /* converter= */
          null);
          return this._converter.fromFirestore(t);
        }

        return this._userDataWriter.convertValue(this._document.data.value);
      }
    }
    /**
     * Retrieves the field specified by `fieldPath`. Returns `undefined` if the
     * document or field doesn't exist.
     *
     * @param fieldPath - The path (for example 'foo' or 'foo.bar') to a specific
     * field.
     * @returns The data at the specified field location or undefined if no such
     * field exists in the document.
     */
    // We are using `any` here to avoid an explicit cast by our users.
    // eslint-disable-next-line @typescript-eslint/no-explicit-any

  }, {
    key: "get",
    value: function get(t) {
      if (this._document) {
        var e = this._document.data.field(rr("DocumentSnapshot.get", t));

        if (null !== e) return this._userDataWriter.convertValue(e);
      }
    }
  }]);

  return Zn;
}();
/**
 * A `QueryDocumentSnapshot` contains data read from a document in your
 * Firestore database as part of a query. The document is guaranteed to exist
 * and its data can be extracted with `.data()` or `.get(<field>)` to get a
 * specific field.
 *
 * A `QueryDocumentSnapshot` offers the same API surface as a
 * `DocumentSnapshot`. Since query results contain only existing documents, the
 * `exists` property will always be true and `data()` will never return
 * 'undefined'.
 */


var tr = /*#__PURE__*/function (_Zn) {
  _inherits(tr, _Zn);

  var _super28 = _createSuper(tr);

  function tr() {
    _classCallCheck(this, tr);

    return _super28.apply(this, arguments);
  }

  _createClass(tr, [{
    key: "data",
    value:
    /**
     * Retrieves all fields in the document as an `Object`.
     *
     * @override
     * @returns An `Object` containing all fields in the document.
     */
    function data() {
      return _get(_getPrototypeOf(tr.prototype), "data", this).call(this);
    }
  }]);

  return tr;
}(Zn);
/**
 * Helper that calls `fromDotSeparatedString()` but wraps any error thrown.
 */


function rr(t, e) {
  return "string" == typeof e ? Hn(t, e) : e instanceof En ? e._internalPath : e._delegate._internalPath;
}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Converts Firestore's internal types to the JavaScript types that we expose
 * to the user.
 *
 * @internal
 */

/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Converts custom model object of type T into `DocumentData` by applying the
 * converter if it exists.
 *
 * This function is used when converting user objects to `DocumentData`
 * because we want to provide the user with a more specific error message if
 * their `set()` or fails due to invalid data originating from a `toFirestore()`
 * call.
 */


function Tr(t, e, n) {
  var r; // Cast to `any` in order to satisfy the union type constraint on
  // toFirestore().
  // eslint-disable-next-line @typescript-eslint/no-explicit-any

  return r = t ? n && (n.merge || n.mergeFields) ? t.toFirestore(e, n) : t.toFirestore(e) : e, r;
}

var Ir = /*#__PURE__*/function (_ref8) {
  _inherits(Ir, _ref8);

  var _super34 = _createSuper(Ir);

  function Ir(t) {
    var _this35;

    _classCallCheck(this, Ir);

    _this35 = _super34.call(this), _this35.firestore = t;
    return _this35;
  }

  _createClass(Ir, [{
    key: "convertBytes",
    value: function convertBytes(t) {
      return new In(t);
    }
  }, {
    key: "convertReference",
    value: function convertReference(t) {
      var e = this.convertDocumentKey(t, this.firestore._databaseId);
      return new wn(this.firestore,
      /* converter= */
      null, e);
    }
  }]);

  return Ir;
}( /*#__PURE__*/function () {
  function _class5() {
    _classCallCheck(this, _class5);
  }

  _createClass(_class5, [{
    key: "convertValue",
    value: function convertValue(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "none";

      switch (Ct(t)) {
        case 0
        /* NullValue */
        :
          return null;

        case 1
        /* BooleanValue */
        :
          return t.booleanValue;

        case 2
        /* NumberValue */
        :
          return xt(t.integerValue || t.doubleValue);

        case 3
        /* TimestampValue */
        :
          return this.convertTimestamp(t.timestampValue);

        case 4
        /* ServerTimestampValue */
        :
          return this.convertServerTimestamp(t, e);

        case 5
        /* StringValue */
        :
          return t.stringValue;

        case 6
        /* BlobValue */
        :
          return this.convertBytes(Ft(t.bytesValue));

        case 7
        /* RefValue */
        :
          return this.convertReference(t.referenceValue);

        case 8
        /* GeoPointValue */
        :
          return this.convertGeoPoint(t.geoPointValue);

        case 9
        /* ArrayValue */
        :
          return this.convertArray(t.arrayValue, e);

        case 10
        /* ObjectValue */
        :
          return this.convertObject(t.mapValue, e);

        default:
          throw g();
      }
    }
  }, {
    key: "convertObject",
    value: function convertObject(t, e) {
      var _this36 = this;

      var n = {};
      return Et(t.fields, function (t, r) {
        n[t] = _this36.convertValue(r, e);
      }), n;
    }
  }, {
    key: "convertGeoPoint",
    value: function convertGeoPoint(t) {
      return new Rn(xt(t.latitude), xt(t.longitude));
    }
  }, {
    key: "convertArray",
    value: function convertArray(t, e) {
      var _this37 = this;

      return (t.values || []).map(function (t) {
        return _this37.convertValue(t, e);
      });
    }
  }, {
    key: "convertServerTimestamp",
    value: function convertServerTimestamp(t, e) {
      switch (e) {
        case "previous":
          var n = qt(t);
          return null == n ? null : this.convertValue(n, e);

        case "estimate":
          return this.convertTimestamp(Ot(t));

        default:
          return null;
      }
    }
  }, {
    key: "convertTimestamp",
    value: function convertTimestamp(t) {
      var e = $t(t);
      return new gt(e.seconds, e.nanos);
    }
  }, {
    key: "convertDocumentKey",
    value: function convertDocumentKey(t, e) {
      var n = X.fromString(t);
      v(Xe(n));
      var r = new H(n.get(1), n.get(3)),
          s = new et(n.popFirst(5));
      return r.isEqual(e) || // TODO(b/64130202): Somehow support foreign references.
      p("Document ".concat(s, " contains a document reference within a different database (").concat(r.projectId, "/").concat(r.database, ") which is not supported. It will be treated as a reference in the current database (").concat(e.projectId, "/").concat(e.database, ") instead.")), s;
    }
  }]);

  return _class5;
}());
/**
 * Reads the document referred to by the specified document reference.
 *
 * All documents are directly fetched from the server, even if the document was
 * previously read or modified. Recent modifications are only reflected in the
 * retrieved `DocumentSnapshot` if they have already been applied by the
 * backend. If the client is offline, the read fails. If you like to use
 * caching or see local modifications, please use the full Firestore SDK.
 *
 * @param reference - The reference of the document to fetch.
 * @returns A Promise resolved with a `DocumentSnapshot` containing the current
 * document contents.
 */


function Ar(t) {
  var e = un((t = ot(t, wn)).firestore),
      n = new Ir(t.firestore);
  return rn(e, [t._key]).then(function (e) {
    v(1 === e.length);
    var r = e[0];
    return new Zn(t.firestore, n, t._key, r.isFoundDocument() ? r : null, t.converter);
  });
}

function Pr(t, e, n) {
  var r = Tr((t = ot(t, wn)).converter, e, n),
      s = Sn(Fn(t.firestore), "setDoc", t._key, r, null !== t.converter, n);
  return nn(un(t.firestore), [s.toMutation(t._key, Re.none())]);
}
/**
 * Firestore Lite
 *
 * @remarks Firestore Lite is a small online-only SDK that allows read
 * and write access to your Firestore database. All operations connect
 * directly to the backend, and `onSnapshot()` APIs are not supported.
 * @packageDocumentation
 */


!function (t) {
  f = t;
}("".concat(SDK_VERSION, "_lite")), _registerComponent(new Component("firestore/lite", function (t, _ref10) {
  var e = _ref10.instanceIdentifier,
      n = _ref10.options;
  var r = t.getProvider("app").getImmediate(),
      s = new an(new z(t.getProvider("auth-internal")), new Q(t.getProvider("app-check-internal")), function (t, e) {
    if (!Object.prototype.hasOwnProperty.apply(t.options, ["projectId"])) throw new L(A, '"projectId" not provided in firebase.initializeApp.');
    return new H(t.options.projectId, e);
  }
  /**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
  (r, e), r);
  return n && s._setSettings(n), s;
}, "PUBLIC").setMultipleInstances(!0)), // RUNTIME_ENV and BUILD_TARGET are replaced by real values during the compilation
registerVersion("firestore-lite", "3.5.0", ""), registerVersion("firestore-lite", "3.5.0", "esm2017");

/**
 * @fileoverview UID generator, from Blockly.
 */
/**
 * Legal characters for the unique ID.
 * Should be all on a US keyboard.  No XML special characters or control codes.
 * Removed $ due to issue 251.
 * @private
 */

var soup_ = '!#%()*+,-./:;=?@[]^_`{|}~' + 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
/**
 * Generate a unique ID, from Blockly.  This should be globally unique.
 * 87 characters ^ 20 length > 128 bits (better than a UUID).
 * @return {string} A globally unique ID string.
 */

var uid$1 = function uid() {
  var length = 20;
  var soupLength = soup_.length;
  var id = [];

  for (var i = 0; i < length; i++) {
    id[i] = soup_.charAt(Math.random() * soupLength);
  }

  return id.join('');
};

var uid_1 = uid$1;

var web = {exports: {}};

var minilog$2 = {exports: {}};

function M() {
  this._events = {};
}

M.prototype = {
  on: function on(ev, cb) {
    this._events || (this._events = {});
    var e = this._events;
    (e[ev] || (e[ev] = [])).push(cb);
    return this;
  },
  removeListener: function removeListener(ev, cb) {
    var e = this._events[ev] || [],
        i;

    for (i = e.length - 1; i >= 0 && e[i]; i--) {
      if (e[i] === cb || e[i].cb === cb) {
        e.splice(i, 1);
      }
    }
  },
  removeAllListeners: function removeAllListeners(ev) {
    if (!ev) {
      this._events = {};
    } else {
      this._events[ev] && (this._events[ev] = []);
    }
  },
  listeners: function listeners(ev) {
    return this._events ? this._events[ev] || [] : [];
  },
  emit: function emit(ev) {
    this._events || (this._events = {});
    var args = Array.prototype.slice.call(arguments, 1),
        i,
        e = this._events[ev] || [];

    for (i = e.length - 1; i >= 0 && e[i]; i--) {
      e[i].apply(this, args);
    }

    return this;
  },
  when: function when(ev, cb) {
    return this.once(ev, cb, true);
  },
  once: function once(ev, cb, when) {
    if (!cb) return this;

    function c() {
      if (!when) this.removeListener(ev, c);
      if (cb.apply(this, arguments) && when) this.removeListener(ev, c);
    }

    c.cb = cb;
    this.on(ev, c);
    return this;
  }
};

M.mixin = function (dest) {
  var o = M.prototype,
      k;

  for (k in o) {
    o.hasOwnProperty(k) && (dest.prototype[k] = o[k]);
  }
};

var microee$1 = M;

var microee = microee$1; // Implements a subset of Node's stream.Transform - in a cross-platform manner.

function Transform$7() {}

microee.mixin(Transform$7); // The write() signature is different from Node's
// --> makes it much easier to work with objects in logs.
// One of the lessons from v1 was that it's better to target
// a good browser rather than the lowest common denominator
// internally.
// If you want to use external streams, pipe() to ./stringify.js first.

Transform$7.prototype.write = function (name, level, args) {
  this.emit('item', name, level, args);
};

Transform$7.prototype.end = function () {
  this.emit('end');
  this.removeAllListeners();
};

Transform$7.prototype.pipe = function (dest) {
  var s = this; // prevent double piping

  s.emit('unpipe', dest); // tell the dest that it's being piped to

  dest.emit('pipe', s);

  function onItem() {
    dest.write.apply(dest, Array.prototype.slice.call(arguments));
  }

  function onEnd() {
    !dest._isStdio && dest.end();
  }

  s.on('item', onItem);
  s.on('end', onEnd);
  s.when('unpipe', function (from) {
    var match = from === dest || typeof from == 'undefined';

    if (match) {
      s.removeListener('item', onItem);
      s.removeListener('end', onEnd);
      dest.emit('unpipe');
    }

    return match;
  });
  return dest;
};

Transform$7.prototype.unpipe = function (from) {
  this.emit('unpipe', from);
  return this;
};

Transform$7.prototype.format = function (dest) {
  throw new Error(['Warning: .format() is deprecated in Minilog v2! Use .pipe() instead. For example:', 'var Minilog = require(\'minilog\');', 'Minilog', '  .pipe(Minilog.backends.console.formatClean)', '  .pipe(Minilog.backends.console);'].join('\n'));
};

Transform$7.mixin = function (dest) {
  var o = Transform$7.prototype,
      k;

  for (k in o) {
    o.hasOwnProperty(k) && (dest.prototype[k] = o[k]);
  }
};

var transform = Transform$7;

var Transform$6 = transform;
var levelMap = {
  debug: 1,
  info: 2,
  warn: 3,
  error: 4
};

function Filter() {
  this.enabled = true;
  this.defaultResult = true;
  this.clear();
}

Transform$6.mixin(Filter); // allow all matching, with level >= given level

Filter.prototype.allow = function (name, level) {
  this._white.push({
    n: name,
    l: levelMap[level]
  });

  return this;
}; // deny all matching, with level <= given level


Filter.prototype.deny = function (name, level) {
  this._black.push({
    n: name,
    l: levelMap[level]
  });

  return this;
};

Filter.prototype.clear = function () {
  this._white = [];
  this._black = [];
  return this;
};

function test(rule, name) {
  // use .test for RegExps
  return rule.n.test ? rule.n.test(name) : rule.n == name;
}

Filter.prototype.test = function (name, level) {
  var i,
      len = Math.max(this._white.length, this._black.length);

  for (i = 0; i < len; i++) {
    if (this._white[i] && test(this._white[i], name) && levelMap[level] >= this._white[i].l) {
      return true;
    }

    if (this._black[i] && test(this._black[i], name) && levelMap[level] <= this._black[i].l) {
      return false;
    }
  }

  return this.defaultResult;
};

Filter.prototype.write = function (name, level, args) {
  if (!this.enabled || this.test(name, level)) {
    return this.emit('item', name, level, args);
  }
};

var filter = Filter;

(function (module, exports) {
  var Transform = transform,
      Filter = filter;
  var log = new Transform(),
      slice = Array.prototype.slice;

  exports = module.exports = function create(name) {
    var o = function o() {
      log.write(name, undefined, slice.call(arguments));
      return o;
    };

    o.debug = function () {
      log.write(name, 'debug', slice.call(arguments));
      return o;
    };

    o.info = function () {
      log.write(name, 'info', slice.call(arguments));
      return o;
    };

    o.warn = function () {
      log.write(name, 'warn', slice.call(arguments));
      return o;
    };

    o.error = function () {
      log.write(name, 'error', slice.call(arguments));
      return o;
    };

    o.log = o.debug; // for interface compliance with Node and browser consoles

    o.suggest = exports.suggest;
    o.format = log.format;
    return o;
  }; // filled in separately


  exports.defaultBackend = exports.defaultFormatter = null;

  exports.pipe = function (dest) {
    return log.pipe(dest);
  };

  exports.end = exports.unpipe = exports.disable = function (from) {
    return log.unpipe(from);
  };

  exports.Transform = Transform;
  exports.Filter = Filter; // this is the default filter that's applied when .enable() is called normally
  // you can bypass it completely and set up your own pipes

  exports.suggest = new Filter();

  exports.enable = function () {
    if (exports.defaultFormatter) {
      return log.pipe(exports.suggest) // filter
      .pipe(exports.defaultFormatter) // formatter
      .pipe(exports.defaultBackend); // backend
    }

    return log.pipe(exports.suggest) // filter
    .pipe(exports.defaultBackend); // formatter
  };
})(minilog$2, minilog$2.exports);

var hex = {
  black: '#000',
  red: '#c23621',
  green: '#25bc26',
  yellow: '#bbbb00',
  blue: '#492ee1',
  magenta: '#d338d3',
  cyan: '#33bbc8',
  gray: '#808080',
  purple: '#708'
};

function color$2(fg, isInverse) {
  if (isInverse) {
    return 'color: #fff; background: ' + hex[fg] + ';';
  } else {
    return 'color: ' + hex[fg] + ';';
  }
}

var util = color$2;

var Transform$5 = transform,
    color$1 = util;
var colors$1 = {
  debug: ['cyan'],
  info: ['purple'],
  warn: ['yellow', true],
  error: ['red', true]
},
    logger$4 = new Transform$5();

logger$4.write = function (name, level, args) {
  var fn = console.log;

  if (console[level] && console[level].apply) {
    fn = console[level];
    fn.apply(console, ['%c' + name + ' %c' + level, color$1('gray'), color$1.apply(color$1, colors$1[level])].concat(args));
  }
}; // NOP, because piping the formatted logs can only cause trouble.


logger$4.pipe = function () {};

var color_1 = logger$4;

var Transform$4 = transform,
    color = util,
    colors = {
  debug: ['gray'],
  info: ['purple'],
  warn: ['yellow', true],
  error: ['red', true]
},
    logger$3 = new Transform$4();

logger$3.write = function (name, level, args) {
  var fn = console.log;

  if (level != 'debug' && console[level]) {
    fn = console[level];
  }

  var i = 0;

  if (level != 'info') {
    for (; i < args.length; i++) {
      if (typeof args[i] != 'string') break;
    }

    fn.apply(console, ['%c' + name + ' ' + args.slice(0, i).join(' '), color.apply(color, colors[level])].concat(args.slice(i)));
  } else {
    fn.apply(console, ['%c' + name, color.apply(color, colors[level])].concat(args));
  }
}; // NOP, because piping the formatted logs can only cause trouble.


logger$3.pipe = function () {};

var minilog$1 = logger$3;

var Transform$3 = transform;
var newlines = /\n+$/,
    logger$2 = new Transform$3();

logger$2.write = function (name, level, args) {
  var i = args.length - 1;

  if (typeof console === 'undefined' || !console.log) {
    return;
  }

  if (console.log.apply) {
    return console.log.apply(console, [name, level].concat(args));
  } else if (JSON && JSON.stringify) {
    // console.log.apply is undefined in IE8 and IE9
    // for IE8/9: make console.log at least a bit less awful
    if (args[i] && typeof args[i] == 'string') {
      args[i] = args[i].replace(newlines, '');
    }

    try {
      for (i = 0; i < args.length; i++) {
        args[i] = JSON.stringify(args[i]);
      }
    } catch (e) {}

    console.log(args.join(' '));
  }
};

logger$2.formatters = ['color', 'minilog'];
logger$2.color = color_1;
logger$2.minilog = minilog$1;
var console_1 = logger$2;

var Transform$2 = transform,
    cache$1 = [];
var logger$1 = new Transform$2();

logger$1.write = function (name, level, args) {
  cache$1.push([name, level, args]);
}; // utility functions


logger$1.get = function () {
  return cache$1;
};

logger$1.empty = function () {
  cache$1 = [];
};

var array = logger$1;

var Transform$1 = transform,
    cache = false;
var logger = new Transform$1();

logger.write = function (name, level, args) {
  if (typeof window == 'undefined' || typeof JSON == 'undefined' || !JSON.stringify || !JSON.parse) return;

  try {
    if (!cache) {
      cache = window.localStorage.minilog ? JSON.parse(window.localStorage.minilog) : [];
    }

    cache.push([new Date().toString(), name, level, args]);
    window.localStorage.minilog = JSON.stringify(cache);
  } catch (e) {}
};

var localstorage = logger;

var Transform = transform;
var cid = new Date().valueOf().toString(36);

function AjaxLogger(options) {
  this.url = options.url || '';
  this.cache = [];
  this.timer = null;
  this.interval = options.interval || 30 * 1000;
  this.enabled = true;
  this.jQuery = window.jQuery;
  this.extras = {};
}

Transform.mixin(AjaxLogger);

AjaxLogger.prototype.write = function (name, level, args) {
  if (!this.timer) {
    this.init();
  }

  this.cache.push([name, level].concat(args));
};

AjaxLogger.prototype.init = function () {
  if (!this.enabled || !this.jQuery) return;
  var self = this;
  this.timer = setTimeout(function () {
    var i,
        logs = [],
        ajaxData,
        url = self.url;
    if (self.cache.length == 0) return self.init(); // Test each log line and only log the ones that are valid (e.g. don't have circular references).
    // Slight performance hit but benefit is we log all valid lines.

    for (i = 0; i < self.cache.length; i++) {
      try {
        JSON.stringify(self.cache[i]);
        logs.push(self.cache[i]);
      } catch (e) {}
    }

    if (self.jQuery.isEmptyObject(self.extras)) {
      ajaxData = JSON.stringify({
        logs: logs
      });
      url = self.url + '?client_id=' + cid;
    } else {
      ajaxData = JSON.stringify(self.jQuery.extend({
        logs: logs
      }, self.extras));
    }

    self.jQuery.ajax(url, {
      type: 'POST',
      cache: false,
      processData: false,
      data: ajaxData,
      contentType: 'application/json',
      timeout: 10000
    }).success(function (data, status, jqxhr) {
      if (data.interval) {
        self.interval = Math.max(1000, data.interval);
      }
    }).error(function () {
      self.interval = 30000;
    }).always(function () {
      self.init();
    });
    self.cache = [];
  }, this.interval);
};

AjaxLogger.prototype.end = function () {}; // wait until jQuery is defined. Useful if you don't control the load order.


AjaxLogger.jQueryWait = function (onDone) {
  if (typeof window !== 'undefined' && (window.jQuery || window.$)) {
    return onDone(window.jQuery || window.$);
  } else if (typeof window !== 'undefined') {
    setTimeout(function () {
      AjaxLogger.jQueryWait(onDone);
    }, 200);
  }
};

var jquery_simple = AjaxLogger;

(function (module, exports) {
  var Minilog = minilog$2.exports;
  var oldEnable = Minilog.enable,
      oldDisable = Minilog.disable,
      isChrome = typeof navigator != 'undefined' && /chrome/i.test(navigator.userAgent),
      console = console_1; // Use a more capable logging backend if on Chrome

  Minilog.defaultBackend = isChrome ? console.minilog : console; // apply enable inputs from localStorage and from the URL

  if (typeof window != 'undefined') {
    try {
      Minilog.enable(JSON.parse(window.localStorage['minilogSettings']));
    } catch (e) {}

    if (window.location && window.location.search) {
      var match = RegExp('[?&]minilog=([^&]*)').exec(window.location.search);
      match && Minilog.enable(decodeURIComponent(match[1]));
    }
  } // Make enable also add to localStorage


  Minilog.enable = function () {
    oldEnable.call(Minilog, true);

    try {
      window.localStorage['minilogSettings'] = JSON.stringify(true);
    } catch (e) {}

    return this;
  };

  Minilog.disable = function () {
    oldDisable.call(Minilog);

    try {
      delete window.localStorage.minilogSettings;
    } catch (e) {}

    return this;
  };

  exports = module.exports = Minilog;
  exports.backends = {
    array: array,
    browser: Minilog.defaultBackend,
    localStorage: localstorage,
    jQuery: jquery_simple
  };
})(web, web.exports);

var minilog = web.exports;
minilog.enable();
var log$1 = minilog('vm');

var log = log$1;
/**
 * Escape a string to be safe to use in XML content.
 * CC-BY-SA: hgoebl
 * https://stackoverflow.com/questions/7918868/
 * how-to-escape-xml-entities-in-javascript
 * @param {!string | !Array.<string>} unsafe Unsafe string.
 * @return {string} XML-escaped string, for use within an XML tag.
 */

var xmlEscape$1 = function xmlEscape(unsafe) {
  if (typeof unsafe !== 'string') {
    if (Array.isArray(unsafe)) {
      // This happens when we have hacked blocks from 2.0
      // See #1030
      unsafe = String(unsafe);
    } else {
      log.error('Unexpected input recieved in replaceUnsafeChars');
      return unsafe;
    }
  }

  return unsafe.replace(/[<>&'"]/g, function (c) {
    switch (c) {
      case '<':
        return '&lt;';

      case '>':
        return '&gt;';

      case '&':
        return '&amp;';

      case '\'':
        return '&apos;';

      case '"':
        return '&quot;';
    }
  });
};

var xmlEscape_1 = xmlEscape$1;

var uid = uid_1;
var xmlEscape = xmlEscape_1;

var Variable = /*#__PURE__*/function () {
  /**
   * @param {string} id Id of the variable.
   * @param {string} name Name of the variable.
   * @param {string} type Type of the variable, one of '' or 'list'
   * @param {boolean} isCloud Whether the variable is stored in the cloud.
   * @constructor
   */
  function Variable(id, name, type, isCloud) {
    _classCallCheck(this, Variable);

    this.id = id || uid();
    this.name = name;
    this.type = type;
    this.isCloud = isCloud;

    switch (this.type) {
      case Variable.SCALAR_TYPE:
        this.value = 0;
        break;

      case Variable.LIST_TYPE:
        this.value = [];
        break;

      case Variable.BROADCAST_MESSAGE_TYPE:
        this.value = this.name;
        break;

      default:
        throw new Error("Invalid variable type: ".concat(this.type));
    }
  }

  _createClass(Variable, [{
    key: "toXML",
    value: function toXML(isLocal) {
      isLocal = isLocal === true;
      return "<variable type=\"".concat(this.type, "\" id=\"").concat(this.id, "\" islocal=\"").concat(isLocal, "\" iscloud=\"").concat(this.isCloud, "\">").concat(xmlEscape(this.name), "</variable>");
    }
    /**
     * Type representation for scalar variables.
     * This is currently represented as ''
     * for compatibility with blockly.
     * @const {string}
     */

  }], [{
    key: "SCALAR_TYPE",
    get: function get() {
      return '';
    }
    /**
     * Type representation for list variables.
     * @const {string}
     */

  }, {
    key: "LIST_TYPE",
    get: function get() {
      return 'list';
    }
    /**
     * Type representation for list variables.
     * @const {string}
     */

  }, {
    key: "BROADCAST_MESSAGE_TYPE",
    get: function get() {
      return 'broadcast_msg';
    }
  }]);

  return Variable;
}();

var variable = Variable;

var encoder = new TextEncoder();
var deoder_utf8 = new TextDecoder('utf-8');
/**
 * Formatter which is used for translation.
 * This will be replaced which is used in the runtime.
 * @param {object} messageData - format-message object
 * @returns {string} - message for the locale
 */

var formatMessage = function formatMessage(messageData) {
  return messageData.defaultMessage;
};
/**
 * Setup format-message for this extension.
 */


var setupTranslations = function setupTranslations() {
  var localeSetup = formatMessage.setup();

  if (localeSetup && localeSetup.translations[localeSetup.locale]) {
    Object.assign(localeSetup.translations[localeSetup.locale], translations[localeSetup.locale]);
  }
};

var EXTENSION_ID = 'numberbank';
/**
 * URL to get this extension as a module.
 * When it was loaded as a module, 'extensionURL' will be replaced a URL which is retrieved from.
 * @type {string}
 */

var extensionURL = 'https://con3office.github.io/dev-numberbank/dist/numberbank.mjs';
/**
 * Scratch 3.0 blocks for example of Xcratch.
 */

var ExtensionBlocks = /*#__PURE__*/function () {
  /**
   * Construct a set of blocks for NumberBank1.0.
   * @param {Runtime} runtime - the Scratch 3.0 runtime.
   */
  function ExtensionBlocks(runtime) {
    _classCallCheck(this, ExtensionBlocks);

    /**
     * The Scratch 3.0 runtime.
     * @type {Runtime}
     */
    this.runtime = runtime;

    if (runtime.formatMessage) {
      // Replace 'formatMessage' to a formatter which is used in the runtime.
      formatMessage = runtime.formatMessage;
    }
  }

  _createClass(ExtensionBlocks, [{
    key: "putNum",
    value: function putNum(args) {
      if (masterSha256 == '') {
        return;
      }

      if (args.BANK == '' || args.CARD == '' || args.NUM == '') {
        return;
      }

      if (inoutFlag) {
        return;
      }

      inoutFlag = true; //console.log("putNum...");

      bankKey = new String(args.BANK);
      bankName = args.BANK;
      cardKey = new String(args.CARD); // console.log("bankKey: " + bankKey);
      // console.log("bankName: " + bankName);

      uniKey = bankKey.trim().concat(cardKey.trim()); //console.log("uniKey: " + uniKey);    

      if (args.NUM != '' && args.NUM != undefined) {
        settingNum = args.NUM; //console.log("settingNum: " + settingNum);    
      }

      if (!crypto || !crypto.subtle) {
        throw Error("crypto.subtle is not supported.");
      }

      if (bankKey != '' && bankKey != undefined) {
        //bankKey
        crypto.subtle.digest('SHA-256', encoder.encode(bankKey)).then(function (bankStr) {
          bankSha256 = hexString(bankStr); // console.log("bankSha256: " + bankSha256);
          //cardKey

          return crypto.subtle.digest('SHA-256', encoder.encode(cardKey));
        }).then(function (cardStr) {
          cardSha256 = hexString(cardStr); //console.log("cardSha256: " + cardSha256);
          //uniKey

          return crypto.subtle.digest('SHA-256', encoder.encode(uniKey));
        }).then(function (uniStr) {
          uniSha256 = hexString(uniStr); // console.log("uniSha256: " + uniSha256);

          return sleep(1);
        }).then(function () {
          //console.log("masterSha256: " + masterSha256);
          if (masterSha256 != '' && masterSha256 != undefined) {
            // console.log("NumberBank put 00");
            var now = Date.now();
            Pr(gn(db, 'card', uniSha256), {
              number: settingNum,
              bank_key: bankSha256,
              card_key: cardSha256,
              master_key: masterSha256,
              time_stamp: now
            }).then(function () {
              // console.log("NumberBank put 01:" + bankName);
              return Pr(gn(db, 'bank', bankSha256), {
                bank_name: bankName,
                time_stamp: now
              });
            }).then(function () {
              // console.log("NumberBank put 02");
              inoutFlag = false;
            }).catch(function (error) {
              console.error("Error writing document: ", error);
              inoutFlag = false;
            });
          } else {
            // console.log("No MasterKey!");
            inoutFlag = false;
          } // console.log("NumberBank put 03");

        });
      } // console.log("NumberBank put ioWaiter");


      return ioWaiter(interval.MsPut);
    }
  }, {
    key: "setNum",
    value: function setNum(args, util) {
      if (masterSha256 == '') {
        return;
      }

      if (args.BANK == '' || args.CARD == '') {
        return;
      }

      if (inoutFlag) {
        return;
      }

      inoutFlag = true;
      var variable = util.target.lookupOrCreateVariable(null, args.VAL);
      bankKey = bankName = new String(args.BANK);
      cardKey = new String(args.CARD);
      uniKey = bankKey.trim().concat(cardKey.trim());

      if (!crypto || !crypto.subtle) {
        throw Error("crypto.subtle is not supported.");
      }

      if (bankKey != '' && bankKey != undefined) {
        //bankKey
        crypto.subtle.digest('SHA-256', encoder.encode(bankKey)).then(function (bankStr) {
          bankSha256 = hexString(bankStr); //console.log("bankSha256: " + bankSha256);    
          //cardKey

          return crypto.subtle.digest('SHA-256', encoder.encode(cardKey));
        }).then(function (cardStr) {
          cardSha256 = hexString(cardStr); //console.log("cardSha256: " + cardSha256);
          //uniKey

          return crypto.subtle.digest('SHA-256', encoder.encode(uniKey));
        }).then(function (uniStr) {
          uniSha256 = hexString(uniStr); //console.log("uniSha256: " + uniSha256);

          return sleep(1);
        }).then(function () {
          //console.log("masterSha256: " + masterSha256);
          if (masterSha256 != '' && masterSha256 != undefined) {
            Ar(gn(db, 'card', uniSha256)).then(function (ckey) {
              // console.log("NumberBank set 00");
              if (ckey.exists()) {
                // console.log("NumberBank set 01");
                // cardDb.doc(uniSha256).get()
                Ar(gn(db, 'card', uniSha256)).then(function (doc) {
                  // console.log("NumberBank set 02");
                  var data = doc.data();
                  variable.value = data.number;
                }).then(function () {
                  inoutFlag = false;
                }).catch(function (error) {
                  console.error("Error getting document: ", error);
                });
              } else {
                // console.log("No Card!");
                variable.value = '';
                inoutFlag = false;
              }
            }).catch(function (error) {
              console.log("Error cheking document:", error);
              inoutFlag = false;
            });
          } else {
            // doc.data() will be undefined in this case
            console.log("No MasterKey!");
            inoutFlag = false;
          } // console.log("NumberBank set 03");

        });
      } // console.log("NumberBank set ioWaiter");


      return ioWaiter(interval.MsSet);
    }
  }, {
    key: "inoutDone",
    value: function inoutDone() {
      return !inoutFlag;
    }
  }, {
    key: "getNum",
    value: function getNum(args) {
      cloudNum = '';

      if (masterSha256 == '') {
        return;
      }

      if (args.BANK == '' || args.CARD == '') {
        return;
      } // console.log('args.BANK:', args.BANK);
      // console.log('args.CARD:', args.CARD);


      if (inoutFlag) {
        return;
      }

      inoutFlag = true;
      bankKey = new String(args.BANK);
      bankName = args.BANK;
      cardKey = new String(args.CARD);
      uniKey = bankKey.trim().concat(cardKey.trim());

      if (!crypto || !crypto.subtle) {
        throw Error("crypto.subtle is not supported.");
      }

      if (bankKey != '' && bankKey != undefined) {
        //bankKey
        crypto.subtle.digest('SHA-256', encoder.encode(bankKey)).then(function (bankStr) {
          bankSha256 = hexString(bankStr); //console.log("bankSha256: " + bankSha256);
          //cardKey

          return crypto.subtle.digest('SHA-256', encoder.encode(cardKey));
        }).then(function (cardStr) {
          cardSha256 = hexString(cardStr); //console.log("cardSha256: " + cardSha256);
          //uniKey

          return crypto.subtle.digest('SHA-256', encoder.encode(uniKey));
        }).then(function (uniStr) {
          uniSha256 = hexString(uniStr); //console.log("uniSha256: " + uniSha256);

          return sleep(1);
        }).then(function () {
          // console.log("masterSha256: " + masterSha256);
          if (masterSha256 != '' && masterSha256 != undefined) {
            Ar(gn(db, 'card', uniSha256)).then(function (ckey) {
              // console.log("NumberBank get 00");
              if (ckey.exists()) {
                // console.log("NumberBank get 01");
                Ar(gn(db, 'card', uniSha256)).then(function (doc) {
                  // console.log("NumberBank get 02");
                  var data = doc.data();
                  cloudNum = data.number; // console.log('cloudNum:', cloudNum);
                }).then(function () {
                  // console.log("NumberBank get 03");
                  inoutFlag = false;
                }).catch(function (error) {
                  console.error("Error getting document: ", error);
                });
              } else {
                // console.log("NumberBank get 04");
                // console.log("No Card!");
                cloudNum = '';
                inoutFlag = false;
              }
            }).catch(function (error) {
              console.log("Error cheking document:", error);
              inoutFlag = false;
            });
          } else {
            // doc.data() will be undefined in this case
            console.log("No MasterKey!");
            inoutFlag = false;
          } // console.log("NumberBank get 05");

        });
      } // console.log("NumberBank get ioWaiter");


      return ioWaiter(interval.MsGet);
    }
  }, {
    key: "repNum",
    value: function repNum(args, util) {
      return cloudNum;
    }
  }, {
    key: "repCloudNum",
    value: function repCloudNum(args) {
      if (masterSha256 == '') {
        return;
      }

      if (args.BANK == '' || args.CARD == '') {
        return;
      }

      if (inoutFlag) {
        return;
      }

      inoutFlag = true;
      var rep_cloudNum = '';
      bankKey = new String(args.BANK);
      bankName = args.BANK;
      cardKey = new String(args.CARD);
      uniKey = bankKey.trim().concat(cardKey.trim());

      if (!crypto || !crypto.subtle) {
        throw Error("crypto.subtle is not supported.");
      }

      if (bankKey != '' && bankKey != undefined) {
        //bankKey
        crypto.subtle.digest('SHA-256', encoder.encode(bankKey)).then(function (bankStr) {
          bankSha256 = hexString(bankStr); //console.log("bankSha256: " + bankSha256);
          //cardKey

          return crypto.subtle.digest('SHA-256', encoder.encode(cardKey));
        }).then(function (cardStr) {
          cardSha256 = hexString(cardStr); //console.log("cardSha256: " + cardSha256);
          //uniKey

          return crypto.subtle.digest('SHA-256', encoder.encode(uniKey));
        }).then(function (uniStr) {
          uniSha256 = hexString(uniStr); //console.log("uniSha256: " + uniSha256);

          return sleep(1);
        }).then(function () {
          //console.log("masterSha256: " + masterSha256);
          if (masterSha256 != '' && masterSha256 != undefined) {
            Ar(gn(db, 'card', uniSha256)).then(function (ckey) {
              // console.log("NumberBank rep 00");
              if (ckey.exists()) {
                // console.log("NumberBank rep 01");
                Ar(gn(db, 'card', uniSha256)).then(function (doc) {
                  // console.log("NumberBank rep 02");
                  var data = doc.data();
                  rep_cloudNum = data.number;
                }).then(function () {
                  inoutFlag = false;
                }).catch(function (error) {
                  console.error("Error getting document: ", error);
                });
              } else {
                // console.log("No Card!");
                rep_cloudNum = '';
                inoutFlag = false;
              }
            }).catch(function (error) {
              console.log("Error cheking document:", error);
              inoutFlag = false;
            });
          } else {
            // doc.data() will be undefined in this case
            console.log("No MasterKey!");
            inoutFlag = false;
          } // console.log("NumberBank rep 03");

        });
      } // console.log("NumberBank rep ioWaiter");


      return reportNumWaiter(interval.MsRep).then(function () {
        return rep_cloudNum;
      });
    }
  }, {
    key: "boolAvl",
    value: function boolAvl(args, util) {
      if (masterSha256 == '') {
        return;
      }

      if (args.BANK == '' || args.CARD == '') {
        return;
      }

      if (inoutFlag) {
        return;
      }

      inoutFlag = true;
      bankKey = new String(args.BANK);
      bankName = args.BANK;
      cardKey = new String(args.CARD);
      uniKey = bankKey.trim().concat(cardKey.trim());

      if (!crypto || !crypto.subtle) {
        throw Error("crypto.subtle is not supported.");
      }

      if (bankKey != '' && bankKey != undefined) {
        //
        crypto.subtle.digest('SHA-256', encoder.encode(uniKey)).then(function (uniStr) {
          uniSha256 = hexString(uniStr); // console.log("uniSha256: " + uniSha256);

          return sleep(1);
        }).then(function () {
          // console.log("masterSha256: " + masterSha256);
          if (masterSha256 != '' && masterSha256 != undefined) {
            Ar(gn(db, 'card', uniSha256)).then(function (ckey) {
              // console.log("NumberBank avl 00");
              if (ckey.exists()) {
                // console.log("NumberBank avl YES");
                inoutFlag = false;
                availableFlag = true;
              } else {
                // console.log("NumberBank avl NO");
                inoutFlag = false;
                availableFlag = false;
              }
            }).catch(function (error) {
              console.log("Error checking document:", error);
              inoutFlag = false;
              availableFlag = false;
            });
          } else {
            // doc.data() will be undefined in this case
            console.log("No MasterKey!");
            inoutFlag = false;
            availableFlag = false;
          } // console.log("NumberBank avl 03");

        });
      } // console.log("NumberBank avl ioWaiter");


      return availableWaiter(interval.MsAvl);
    }
  }, {
    key: "setMaster",
    value: function setMaster(args) {
      masterSetted = '';

      if (args.KEY == '') {
        return masterSetted;
      }

      if (inoutFlag_setting) {
        return masterSetted;
      }

      inoutFlag_setting = true;
      inoutFlag = true;
      masterSha256 = '';
      masterSetted = args.KEY;
      mkbUrl = FBaseUrl + 'mkeybank/?mkey=' + masterSetted;
      mkbRequest = new Request(mkbUrl, {
        mode: 'cors'
      });

      if (!crypto || !crypto.subtle) {
        throw Error("crypto.subtle is not supported.");
      }

      crypto.subtle.digest('SHA-256', encoder.encode(masterSetted)).then(function (masterStr) {
        masterSha256 = hexString(masterStr);
        return fetch(mkbRequest);
      }).then(function (response) {
        if (response.ok) {
          return response.json();
        } else {
          throw new Error('Unexpected responce status ${response.status} or content type');
        }
      }).then(function (resBody) {
        cloudConfig_mkey.masterKey = resBody.masterKey;
        cloudConfig_mkey.cloudType = resBody.cloudType;
        cloudConfig_mkey.apiKey = resBody.apiKey;
        cloudConfig_mkey.authDomain = resBody.authDomain;
        cloudConfig_mkey.databaseURL = resBody.databaseURL;
        cloudConfig_mkey.projectId = resBody.projectId;
        cloudConfig_mkey.storageBucket = resBody.storageBucket;
        cloudConfig_mkey.messagingSenderId = resBody.messagingSenderId;
        cloudConfig_mkey.appId = resBody.appId;
        cloudConfig_mkey.measurementId = resBody.measurementId;
        cloudConfig_mkey.cccCheck = resBody.cccCheck;
        interval.MsPut = resBody.intervalMsPut;
        interval.MsSet = resBody.intervalMsSet;
        interval.MsGet = resBody.intervalMsGet;
        interval.MsRep = resBody.intervalMsRep;
        interval.MsAvl = resBody.intervalMsAvl;
        inoutFlag = false;
        crypt_decode(cloudConfig_mkey, firebaseConfig);
        return ioWaiter(1);
      }).then(function () {
        inoutFlag = true; // Initialize Firebase

        if (cloudFlag) {
          deleteApp(fbApp).then(function () {
            cloudFlag = false;
            fbApp = initializeApp(firebaseConfig);
            db = ln(fbApp);
            inoutFlag = false;
          }).catch(function (err) {
            console.log('Err deleting app:', err);
            inoutFlag = false;
          });
        } else {
          fbApp = initializeApp(firebaseConfig);
          db = ln(fbApp);
          inoutFlag = false;
        }

        return ioWaiter(1);
      }).then(function () {
        masterKey = masterSetted;
        cloudFlag = true;
        inoutFlag_setting = false;
        inoutFlag = false;
        console.log("= MasterKey:", masterSetted);
        console.log('= Interval:', interval);
        console.log("= MasterKey Accepted! =");
      }).catch(function (error) {
        inoutFlag_setting = false;
        inoutFlag = false;
        console.log("Error setting MasterKey:", error);
      });
      return cloudWaiter(1).then(function () {
        return masterKey;
      });
    }
    /**
     * @returns {object} metadata for this extension and its blocks.
     */

  }, {
    key: "getInfo",
    value: function getInfo() {
      setupTranslations();
      return {
        id: ExtensionBlocks.EXTENSION_ID,
        name: ExtensionBlocks.EXTENSION_NAME,
        extensionURL: ExtensionBlocks.extensionURL,
        blockIconURI: img,
        showStatusButton: false,
        blocks: [{
          opcode: 'putNum',
          blockType: blockType.COMMAND,
          text: formatMessage({
            id: 'numberbank.putNum',
            default: 'put[NUM]to[CARD]of[BANK]',
            description: 'put number to Firebase'
          }),
          arguments: {
            BANK: {
              type: argumentType.STRING,
              defaultValue: formatMessage({
                id: 'numberbank.argments.bank',
                default: 'bank'
              })
            },
            CARD: {
              type: argumentType.STRING,
              defaultValue: formatMessage({
                id: 'numberbank.argments.card',
                default: 'card'
              })
            },
            NUM: {
              type: argumentType.NUMBER,
              defaultValue: '10'
            }
          }
        }, '---', {
          opcode: 'setNum',
          blockType: blockType.COMMAND,
          text: formatMessage({
            id: 'numberbank.setNum',
            default: 'set [VAL] to number of[CARD]of[BANK]',
            description: 'set number by Firebase'
          }),
          arguments: {
            BANK: {
              type: argumentType.STRING,
              defaultValue: formatMessage({
                id: 'numberbank.argments.bank',
                default: 'bank'
              })
            },
            CARD: {
              type: argumentType.STRING,
              defaultValue: formatMessage({
                id: 'numberbank.argments.card',
                default: 'card'
              })
            },
            VAL: {
              type: argumentType.STRING,
              fieldName: 'VARIABLE',
              variableType: variable.SCALAR_TYPE,
              menu: 'valMenu'
            }
          }
        }, '---', {
          opcode: 'getNum',
          blockType: blockType.COMMAND,
          text: formatMessage({
            id: 'numberbank.getNum',
            default: 'get number of[CARD]of[BANK]',
            description: 'get number from Firebase'
          }),
          arguments: {
            BANK: {
              type: argumentType.STRING,
              defaultValue: formatMessage({
                id: 'numberbank.argments.bank',
                default: 'bank'
              })
            },
            CARD: {
              type: argumentType.STRING,
              defaultValue: formatMessage({
                id: 'numberbank.argments.card',
                default: 'card'
              })
            }
          }
        }, {
          opcode: 'repNum',
          text: formatMessage({
            id: 'numberbank.repNum',
            default: 'cloud number',
            description: 'report Number'
          }),
          blockType: blockType.REPORTER
        }, '---', {
          opcode: 'repCloudNum',
          blockType: blockType.REPORTER,
          text: formatMessage({
            id: 'numberbank.repCloudNum',
            default: 'number of[CARD]of[BANK]',
            description: 'report Cloud number'
          }),
          arguments: {
            BANK: {
              type: argumentType.STRING,
              defaultValue: formatMessage({
                id: 'numberbank.argments.bank',
                default: 'bank'
              })
            },
            CARD: {
              type: argumentType.STRING,
              defaultValue: formatMessage({
                id: 'numberbank.argments.card',
                default: 'card'
              })
            }
          }
        }, '---', {
          opcode: 'boolAvl',
          blockType: blockType.BOOLEAN,
          text: formatMessage({
            id: 'numberbank.boolAvl',
            default: '[CARD]of[BANK] available?',
            description: 'report Number'
          }),
          arguments: {
            BANK: {
              type: argumentType.STRING,
              defaultValue: formatMessage({
                id: 'numberbank.argments.bank',
                default: 'bank'
              })
            },
            CARD: {
              type: argumentType.STRING,
              defaultValue: formatMessage({
                id: 'numberbank.argments.card',
                default: 'card'
              })
            }
          }
        }, '---', {
          opcode: 'setMaster',
          blockType: blockType.COMMAND,
          text: formatMessage({
            id: 'numberbank.setMaster',
            default: 'set Master[KEY]',
            description: 'readFirebase'
          }),
          arguments: {
            KEY: {
              type: argumentType.STRING,
              defaultValue: formatMessage({
                id: 'numberbank.argments.key',
                default: 'key'
              })
            }
          }
        }],
        menus: {
          valMenu: {
            acceptReporters: true,
            items: 'getDynamicMenuItems'
          }
        }
      };
    }
  }, {
    key: "getDynamicMenuItems",
    value: function getDynamicMenuItems() {
      return this.runtime.getEditingTarget().getAllVariableNamesInScopeByType(variable.SCALAR_TYPE);
    }
  }], [{
    key: "EXTENSION_NAME",
    get:
    /**
     * @return {string} - the name of this extension.
     */
    function get() {
      return formatMessage({
        id: 'numberbank.name',
        default: 'NumberBank',
        description: 'name of the extension'
      });
    }
    /**
     * @return {string} - the ID of this extension.
     */

  }, {
    key: "EXTENSION_ID",
    get: function get() {
      return EXTENSION_ID;
    }
    /**
     * URL to get this extension.
     * @type {string}
     */

  }, {
    key: "extensionURL",
    get: function get() {
      return extensionURL;
    }
    /**
     * Set URL to get this extension.
     * The extensionURL will be changed to the URL of the loading server.
     * @param {string} url - URL
     */
    ,
    set: function set(url) {
      extensionURL = url;
    }
  }]);

  return ExtensionBlocks;
}();

function sleep(msec) {
  return new Promise(function (resolve) {
    return setTimeout(function () {
      resolve();
    }, msec);
  });
}

function ioWaiter(msec) {
  return new Promise(function (resolve, reject) {
    return setTimeout(function () {
      if (inoutFlag) {
        reject();
      } else {
        resolve();
      }
    }, msec);
  }).catch(function () {
    return ioWaiter(msec);
  });
}

function reportNumWaiter(msec) {
  return new Promise(function (resolve, reject) {
    return setTimeout(function () {
      if (inoutFlag) {
        reject();
      } else {
        resolve();
      }
    }, msec);
  }).catch(function () {
    return reportNumWaiter(msec);
  });
}

function availableWaiter(msec) {
  return new Promise(function (resolve, reject) {
    return setTimeout(function () {
      if (inoutFlag) {
        reject();
      } else {
        resolve(availableFlag);
      }
    }, msec);
  }).catch(function () {
    return availableWaiter(msec);
  });
}

function cloudWaiter(msec) {
  return new Promise(function (resolve, reject) {
    return setTimeout(function () {
      if (inoutFlag_setting) {
        reject();
      } else {
        resolve(cloudFlag);
      }
    }, msec);
  }).catch(function () {
    return cloudWaiter(msec);
  });
} //


function hexString(textStr) {
  var byteArray = new Uint8Array(textStr);

  var hexCodes = _toConsumableArray(byteArray).map(function (value) {
    var hexCode = value.toString(16);
    var paddedHexCode = hexCode.padStart(2, '0');
    return paddedHexCode;
  });

  return hexCodes.join('');
}
/*

function fb_comm(){


    // put
    const now = Date.now();
    setDoc(doc(db, 'card', uniSha256), {
        number: settingNum,
        bank_key: bankSha256,
        card_key: cardSha256,
        master_key: masterSha256,
        time_stamp: now
    })
    .then(() => {
        // console.log("NumberBank put 01:" + bankName);

        return setDoc(doc(db, 'bank', bankSha256), {
            bank_name: bankName,
            time_stamp: now
        });
    })
    .then(() => {
        // console.log("NumberBank put 02");
        inoutFlag = false;
    })
    .catch(function (error) {
        console.error("Error writing document: ", error);
        inoutFlag = false;
    });






    // set
    getDoc(doc(db, 'card', uniSha256)).then(function (ckey) {
        // console.log("NumberBank set 00");

        if (ckey.exists()) {
            // console.log("NumberBank set 01");

            // cardDb.doc(uniSha256).get()
            getDoc(doc(db, 'card', uniSha256))
                .then((doc) => {

                    // console.log("NumberBank set 02");
                    let data = doc.data();
                    variable.value = data.number;
                    
                })
                .then(() => {
                    inoutFlag = false;
                })
                .catch(function (error) {
                    console.error("Error getting document: ", error);
                });

        } else {
            // console.log("No Card!");
            variable.value = '';
            inoutFlag = false;
        }

    }).catch(function (error) {
        console.log("Error cheking document:", error);
        inoutFlag = false;
    });





    // get
    getDoc(doc(db, 'card', uniSha256)).then(function (ckey) {
        // console.log("NumberBank get 00");

        if (ckey.exists()) {
            // console.log("NumberBank get 01");

            getDoc(doc(db, 'card', uniSha256))
                .then((doc) => {

                    // console.log("NumberBank get 02");
                    let data = doc.data();
                    cloudNum = data.number;
                    // console.log('cloudNum:', cloudNum);

                })
                .then(() => {
                    // console.log("NumberBank get 03");
                    inoutFlag = false;
                })
                .catch(function (error) {
                    console.error("Error getting document: ", error);
                });

        } else {
            // console.log("NumberBank get 04");
            // console.log("No Card!");
            cloudNum = '';
            inoutFlag = false;
        }

    }).catch(function (error) {
        console.log("Error cheking document:", error);
        inoutFlag = false;
    });





    //rep
    getDoc(doc(db, 'card', uniSha256)).then(function (ckey) {
        // console.log("NumberBank rep 00");

        if (ckey.exists()) {
            // console.log("NumberBank rep 01");

            getDoc(doc(db, 'card', uniSha256))
                .then((doc) => {

                    // console.log("NumberBank rep 02");
                    let data = doc.data();
                    rep_cloudNum = data.number;

                })
                .then(() => {
                    inoutFlag = false;
                })
                .catch(function (error) {
                    console.error("Error getting document: ", error);
                });

        } else {
            // console.log("No Card!");
            rep_cloudNum = '';
            inoutFlag = false;
        }

    }).catch(function (error) {
        console.log("Error cheking document:", error);
        inoutFlag = false;
    });



    //bool
    getDoc(doc(db, 'card', uniSha256)).then(function (ckey) {
        // console.log("NumberBank avl 00");

        if (ckey.exists()) {
            // console.log("NumberBank avl YES");
            inoutFlag = false;
            availableFlag = true;
        } else {
            // console.log("NumberBank avl NO");
            inoutFlag = false;
            availableFlag = false;
        }

    }).catch(function (error) {
        console.log("Error checking document:", error);
        inoutFlag = false;
        availableFlag = false;
    });



    //




}




*/
// Firebase関連


var fbApp;
var db; // Variables

var masterKey = '';
var masterSetted = '';
var bankName = '';
var bankKey = '';
var cardKey = '';
var uniKey = '';
var cloudNum = '';
var settingNum = '';
var masterSha256 = '';
var bankSha256 = '';
var cardSha256 = '';
var uniSha256 = '';
var inoutFlag = false;
var inoutFlag_setting = false;
var availableFlag = false;
var cloudFlag = false;
var mkbRequest;
var mkbUrl;
var FBaseUrl = 'https://us-central1-masterkey-bank.cloudfunctions.net/';
var interval = {
  MsPut: 1500,
  MsSet: 1000,
  MsGet: 1000,
  MsRep: 1000,
  MsAvl: 100
};
var firebaseConfig = {
  masterKey: '',
  cloudType: '',
  apiKey: "",
  authDomain: "",
  databaseURL: "",
  projectId: "",
  storageBucket: "",
  messagingSenderId: "",
  appId: "",
  measurementId: ""
}; // 格納用予備

var cloudConfig_mkey = {
  masterKey: '',
  cloudType: '',
  apiKey: '',
  authDomain: '',
  databaseURL: "",
  projectId: '',
  storageBucket: '',
  messagingSenderId: '',
  appId: '',
  measurementId: '',
  Version: '',
  AccessKeyId: '',
  SecretAccessKey: '',
  SessionToken: '',
  Expiration: '',
  cccCheck: ''
}; // データ暗号化の下処理

function de_get(data) {
  return Ya.fromBase64String(data).toUint8Array();
}

function de_disp(data) {
  return deoder_utf8.decode(data);
}

function de_crt(data) {
  return Ya.fromBase64String(data).toUint8Array();
} ////////////////////////////////
///////////////////////////////


function crypt_decode(cryptedConfigData, decodedConfigData) {
  if (inoutFlag) {
    return;
  }

  inoutFlag = true;
  decodedConfigData.cccCheck = cryptedConfigData.cccCheck;
  var cccCheck = de_crt(cryptedConfigData.cccCheck);
  var ckey;

  switch (cryptedConfigData.cloudType) {
    case 'firestore':
      // console.log('switch to Firebase!');
      crypto.subtle.digest('SHA-256', encoder.encode(masterSetted)).then(function (masterStr) {
        return crypto.subtle.importKey('raw', masterStr, 'AES-CTR', false, ['encrypt', 'decrypt']);
      }).then(function (encodedKey) {
        ckey = encodedKey; // 復号化開始
        // apiKey

        return crypto.subtle.decrypt({
          name: 'AES-CTR',
          counter: cccCheck,
          length: 64
        }, ckey, de_get(cryptedConfigData.apiKey));
      }).then(function (decodedData) {
        // console.log('decodedConfigData.apiKey:', de_disp(decodedData));
        decodedConfigData.apiKey = de_disp(decodedData); // authDomain

        return crypto.subtle.decrypt({
          name: 'AES-CTR',
          counter: cccCheck,
          length: 64
        }, ckey, de_get(cryptedConfigData.authDomain));
      }).then(function (decodedData) {
        // console.log('decodedConfigData.authDomain:', de_disp(decodedData));
        decodedConfigData.authDomain = de_disp(decodedData); // databaseURL

        return crypto.subtle.decrypt({
          name: 'AES-CTR',
          counter: cccCheck,
          length: 64
        }, ckey, de_get(cryptedConfigData.databaseURL));
      }).then(function (decodedData) {
        // console.log('decodedConfigData.databaseURL:', de_disp(decodedData));
        decodedConfigData.databaseURL = de_disp(decodedData); // projectId

        return crypto.subtle.decrypt({
          name: 'AES-CTR',
          counter: cccCheck,
          length: 64
        }, ckey, de_get(cryptedConfigData.projectId));
      }).then(function (decodedData) {
        // console.log('decodedConfigData.projectId:', de_disp(decodedData));
        decodedConfigData.projectId = de_disp(decodedData); // storageBucket

        return crypto.subtle.decrypt({
          name: 'AES-CTR',
          counter: cccCheck,
          length: 64
        }, ckey, de_get(cryptedConfigData.storageBucket));
      }).then(function (decodedData) {
        // console.log('decodedConfigData.storageBucket:', de_disp(decodedData));
        decodedConfigData.storageBucket = de_disp(decodedData); // messagingSenderId

        return crypto.subtle.decrypt({
          name: 'AES-CTR',
          counter: cccCheck,
          length: 64
        }, ckey, de_get(cryptedConfigData.messagingSenderId));
      }).then(function (decodedData) {
        // console.log('decodedConfigData.messagingSenderId:', de_disp(decodedData));
        decodedConfigData.messagingSenderId = de_disp(decodedData); // appId

        return crypto.subtle.decrypt({
          name: 'AES-CTR',
          counter: cccCheck,
          length: 64
        }, ckey, de_get(cryptedConfigData.appId));
      }).then(function (decodedData) {
        // console.log('decodedConfigData.appId:', de_disp(decodedData));
        decodedConfigData.appId = de_disp(decodedData); // measurementId

        return crypto.subtle.decrypt({
          name: 'AES-CTR',
          counter: cccCheck,
          length: 64
        }, ckey, de_get(cryptedConfigData.measurementId));
      }).then(function (decodedData) {
        // console.log('decodedConfigData.measurementId:', de_disp(decodedData));
        decodedConfigData.measurementId = de_disp(decodedData);
        inoutFlag = false; // console.log('inoutFlag(decode end):', inoutFlag);

        return decodedConfigData;
      }).catch(function (err) {
        console.log('decoding error:', err);
      });
      break;

    case 'dynamo':
      // console.log('switch to Dynamo!');
      inoutFlag = false;
      break;

    default:
      // console.log('switch doesnt work!');
      inoutFlag = false;
      break;
  }
}

export { ExtensionBlocks as blockClass, entry };
